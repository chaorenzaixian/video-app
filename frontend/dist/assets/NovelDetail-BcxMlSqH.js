import{r as a,c as e,w as l,j as s,R as t,y as n,C as c,I as i,H as o,L as u,V as r,K as v,M as d,aa as p,u as m,U as k,G as g,af as b,az as _,aC as y,n as h,z as f}from"./vue-vendor-Ba_vealp.js";import{_ as C}from"./ic_back-BPdSG6fy.js";import{_ as w}from"./super_vip_blue-CukdgMfT.js";import{_ as x,a as $}from"./index-C3P4JTuA.js";import{l as T,a as S,c as j,p as I,s as M,r as D}from"./comment-DVVGXtEs.js";import{V as P}from"./vip-C8N2TCfr.js";import{E as H}from"./element-plus-DlIn_qXi.js";import"./utils-DflAyOWx.js";const L={class:"novel-detail-page"},z={class:"top-header"},E={class:"header-right"},R={key:0,class:"loading-state"},V={key:1,class:"content-area"},U={class:"header-content"},F=["src","alt"],G={class:"novel-info"},N={class:"novel-title"},J={class:"novel-meta"},O={class:"desc-section"},B={class:"chapters-section"},K={class:"section-header"},Y={class:"chapter-count"},q={class:"chapters-preview"},A=["onClick"],Q={class:"chapter-title"},W={key:0,class:"new-tag"},X={key:1,class:"lock-icon"},Z={key:2,class:"arrow-right"},aa={class:"tabs-section"},ea={class:"tabs-header"},la={key:0,class:"recommend-list"},sa=["onClick"],ta={class:"recommend-cover-wrap"},na=["src","alt"],ca={class:"recommend-title"},ia={key:0,class:"no-data"},oa={key:1,class:"comments-preview"},ua={key:0,class:"no-data"},ra=["src"],va={class:"comment-body"},da={class:"comment-user"},pa={class:"comment-text"},ma={key:2,class:"error-state"},ka={key:3,class:"action-bar"},ga=["src"],ba={class:"action-text"},_a=["src"],ya={class:"action-text"},ha={class:"catalog-panel"},fa={class:"catalog-header"},Ca={class:"catalog-title"},wa={class:"sort-tabs"},xa={class:"catalog-list"},$a=["onClick"],Ta={class:"catalog-chapter-title"},Sa={key:0,class:"lock-icon"},ja={key:0,class:"no-more-data"},Ia={key:5,class:"reader-modal"},Ma={class:"reader-header"},Da={class:"chapter-name"},Pa={key:0,class:"settings-panel"},Ha={class:"setting-item"},La={class:"font-sizes"},za=["onClick"],Ea={key:0,class:"loading-state"},Ra=["innerHTML"],Va={class:"reader-footer"},Ua=["disabled"],Fa={class:"progress"},Ga=["disabled"],Na={key:6,class:"audio-player-modal"},Ja={class:"player-header"},Oa={class:"chapter-name"},Ba={class:"player-content"},Ka={class:"cover-area"},Ya=["src","alt"],qa={key:0,class:"playing-animation"},Aa={class:"audio-info"},Qa={class:"audio-title"},Wa={class:"audio-chapter"},Xa={class:"progress-bar"},Za={class:"time current"},ae=["value","max"],ee={class:"time total"},le={class:"player-controls"},se=["disabled"],te=["disabled"],ne={class:"player-options"},ce={class:"player-chapters"},ie={class:"chapters-scroll"},oe=["onClick"],ue={key:0},re={class:"timer-content"},ve={class:"timer-options"},de=["onClick"],pe={class:"comments-panel"},me={class:"comments-header"},ke={class:"comment-count"},ge={class:"sort-tabs"},be={class:"comments-list"},_e={key:0,class:"comment-item official-announcement"},ye=["src"],he={class:"comment-body"},fe={class:"comment-user"},Ce={class:"official-name"},we={class:"comment-text official-text"},xe={class:"comment-footer"},$e={class:"comment-time"},Te={key:1,class:"no-comments"},Se=["src","onClick"],je={class:"comment-body"},Ie={class:"comment-user"},Me=["onClick"],De=["src"],Pe={class:"comment-text"},He=["onClick"],Le=["src"],ze={class:"comment-footer"},Ee={class:"comment-time"},Re={class:"comment-actions"},Ve=["onClick"],Ue=["onClick"],Fe=["src"],Ge={key:2,class:"no-more"},Ne={class:"comment-toolbar"},Je={class:"toolbar-left"},Oe=["src"],Be=["src"],Ke={class:"input-panel"},Ye={class:"input-panel-header"},qe=["disabled"],Ae={class:"input-panel-body"},Qe={class:"char-counter"},We={key:0,class:"image-preview"},Xe=["src"],Ze={class:"input-panel-footer"},al={class:"footer-left"},el=["src"],ll={key:0,class:"emoji-panel"},sl=["onClick"],tl={class:"comment-image-preview-content"},nl=["src"],cl=x({__name:"NovelDetail",setup(x){const cl=_(),il=y(),ol=a(!0),ul=a(null),rl=a([]),vl=a(!1),dl=a("recommend"),pl=a(!1),ml=a("asc"),kl=a([]),gl=a([]),bl=a(0),_l=a(!1),yl=a("hot"),hl=a(null),fl=a(!1),Cl=a(!1),wl=a(""),xl=a(null),$l=a(""),Tl=a(null),Sl=a(null),jl=a(""),Il=a(!1),Ml=a(null),Dl=["ðŸ˜€","ðŸ˜‚","ðŸ¤£","ðŸ˜","ðŸ¥°","ðŸ˜˜","ðŸ˜‹","ðŸ¤¤","ðŸ˜Ž","ðŸ¤©","ðŸ˜","ðŸ˜’","ðŸ˜ž","ðŸ˜¢","ðŸ˜­","ðŸ˜¤","ðŸ˜¡","ðŸ¤¬","ðŸ˜±","ðŸ˜¨","ðŸ¥º","ðŸ˜‡","ðŸ¤—","ðŸ¤”","ðŸ¤«","ðŸ¤­","ðŸ™„","ðŸ˜´","ðŸ¤®","ðŸ¤§","ðŸ˜·","ðŸ¤’","ðŸ‘","ðŸ‘Ž","ðŸ‘","ðŸ™Œ","ðŸ’ª","ðŸ¤","â¤ï¸","ðŸ’”","ðŸ’¯","ðŸ”¥","â­","ðŸŽ‰","ðŸŽŠ","ðŸ’","ðŸŒ¹","ðŸ€"],Pl=a(!1),Hl=a(!1),Ll=a(null),zl=a(0),El=a(!1),Rl=a(16),Vl=a(!1),Ul=a(null),Fl=a(0);let Gl=null;const Nl=a(null),Jl=a(!1),Ol=a(0),Bl=a(0),Kl=a(1),Yl=a(!0),ql=a(0),Al=a(!1);let Ql=null;const Wl=e(()=>rl.value.slice(0,4)),Xl=e(()=>"desc"===ml.value?[...rl.value].reverse():rl.value),Zl=a=>{if(!a.created_at)return!1;const e=new Date(a.created_at);return new Date-e<6048e5},as=async()=>{ol.value=!0;try{const a=cl.params.id,e=await $.get(`/gallery-novel/novel/${a}`);ul.value=e.data,rl.value=e.data.chapters||[],es(),ls()}catch(a){H.error("èŽ·å–å°è¯´è¯¦æƒ…å¤±è´¥")}finally{ol.value=!1}},es=async()=>{try{const a=await $.get("/gallery-novel/novel/list",{params:{page_size:6}});kl.value=(a.data||[]).filter(a=>{var e;return a.id!==(null==(e=ul.value)?void 0:e.id)}).slice(0,5)}catch(a){kl.value=[]}},ls=async()=>{try{const a=await $.get(`/gallery-novel/novel/${ul.value.id}/comments`);gl.value=a.data||[],bl.value=gl.value.length}catch(a){gl.value=[],bl.value=0}},ss=async()=>{_l.value=!0,await Promise.all([ls(),ns()])},ts=()=>{_l.value=!1},ns=async()=>{try{const a=await $.get("/settings/comment-announcement");hl.value=a.data||a}catch(a){}},cs=async()=>{var a,e;if(wl.value.trim()||xl.value)try{let a;if(xl.value){const e=new FormData;e.append("content",wl.value||""),e.append("image",xl.value),a=await $.post(`/gallery-novel/novel/${ul.value.id}/comment`,e,{headers:{"Content-Type":"multipart/form-data"}})}else a=await $.post(`/gallery-novel/novel/${ul.value.id}/comment`,{content:wl.value});wl.value="",xl.value=null,$l.value="",fl.value=!1,Cl.value=!1,await ls(),H.success("è¯„è®ºæˆåŠŸ")}catch(l){H.error((null==(e=null==(a=l.response)?void 0:a.data)?void 0:e.detail)||"è¯„è®ºå¤±è´¥")}},is=()=>{fl.value=!0,Cl.value=!1,setTimeout(()=>{var a;return null==(a=Sl.value)?void 0:a.focus()},100)},os=()=>{fl.value=!1,Cl.value=!1},us=()=>{fl.value?Cl.value=!Cl.value:(fl.value=!0,setTimeout(()=>{Cl.value=!0},100))},rs=()=>{var a;null==(a=Tl.value)||a.click()},vs=a=>{var e;const l=null==(e=a.target.files)?void 0:e[0];if(l){if(l.size>5242880)return void H.warning("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡5MB");xl.value=l,$l.value=URL.createObjectURL(l),fl.value||is()}a.target.value=""},ds=()=>{xl.value=null,$l.value=""},ps=()=>{Il.value=!1,jl.value=""},ms=a=>{a&&il.push(`/user/profile/${a}`)},ks=a=>{if(!a)return"";const e=new Date(a),l=(new Date-e)/1e3;return l<60?"åˆšåˆš":l<3600?Math.floor(l/60)+"åˆ†é’Ÿå‰":l<86400?Math.floor(l/3600)+"å°æ—¶å‰":e.toLocaleDateString()},gs=a=>{if(!a)return"";const e=new Date(a);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},bs=()=>{il.push("/user/community?tab=novel")},_s=()=>{if(ul.value.read_progress){const a=rl.value.find(a=>a.id===ul.value.read_progress.chapter_id);if(a)return void ys(a)}rl.value.length>0&&ys(rl.value[0])},ys=async a=>{var e;if(a.is_free||ul.value.is_vip){if(pl.value=!1,zl.value=rl.value.findIndex(e=>e.id===a.id),"audio"===ul.value.novel_type?Hl.value=!0:Pl.value=!0,await hs(a.id),(null==(e=ul.value.read_progress)?void 0:e.chapter_id)===a.id)if(await h(),"audio"===ul.value.novel_type)Nl.value&&ul.value.read_progress.audio_position>0&&(Nl.value.currentTime=ul.value.read_progress.audio_position);else if(Ul.value&&ul.value.read_progress.scroll_position>0){const a=Ul.value.scrollHeight-Ul.value.clientHeight;Ul.value.scrollTop=a*(ul.value.read_progress.scroll_position/100)}}else H.warning("æ­¤ç« èŠ‚éœ€è¦VIPæ‰èƒ½é˜…è¯»")},hs=async a=>{var e;El.value=!0;try{const e=await $.get(`/gallery-novel/novel/${ul.value.id}/chapter/${a}`);Ll.value=e.data,"audio"===ul.value.novel_type&&e.data.audio_url&&(await h(),Nl.value&&(Nl.value.src=e.data.audio_url,Nl.value.playbackRate=Kl.value,Nl.value.load()))}catch(l){403===(null==(e=l.response)?void 0:e.status)?(H.warning("æ­¤ç« èŠ‚éœ€è¦VIPæ‰èƒ½é˜…è¯»"),Pl.value=!1,Hl.value=!1):H.error("åŠ è½½ç« èŠ‚å¤±è´¥")}finally{El.value=!1}},fs=()=>{var a;if(null==(a=Ll.value)?void 0:a.prev_chapter){const a=rl.value.find(a=>a.id===Ll.value.prev_chapter.id);a&&ys(a)}},Cs=()=>{var a;if(null==(a=Ll.value)?void 0:a.next_chapter){const a=rl.value.find(a=>a.id===Ll.value.next_chapter.id);if(a){if(!a.is_free&&!ul.value.is_vip)return void H.warning("ä¸‹ä¸€ç« éœ€è¦VIPæ‰èƒ½é˜…è¯»");ys(a)}}},ws=()=>{$s(),Pl.value=!1,Ll.value=null},xs=()=>{$s(),Nl.value&&Nl.value.pause(),Hl.value=!1,Ll.value=null},$s=async()=>{if(Ll.value)try{await $.post(`/gallery-novel/novel/${ul.value.id}/progress`,{chapter_id:Ll.value.id,chapter_num:Ll.value.chapter_num,scroll_position:Fl.value,audio_position:Ol.value})}catch(a){}},Ts=()=>{if(!Ul.value)return;const a=Ul.value.scrollHeight-Ul.value.clientHeight;Fl.value=a>0?Ul.value.scrollTop/a*100:0,clearTimeout(Gl),Gl=setTimeout($s,2e3)},Ss=()=>{Nl.value&&(Jl.value?Nl.value.pause():Nl.value.play())},js=()=>{Nl.value&&(Ol.value=Nl.value.currentTime)},Is=()=>{Nl.value&&(Bl.value=Nl.value.duration)},Ms=()=>{var a;$s(),Yl.value&&(null==(a=Ll.value)?void 0:a.next_chapter)&&(Cs(),setTimeout(()=>{Nl.value&&Nl.value.play()},500))},Ds=a=>{Nl.value&&(Nl.value.currentTime=Math.max(0,Math.min(Bl.value,Ol.value+a)))},Ps=()=>{const a=[.75,1,1.25,1.5,2],e=a.indexOf(Kl.value);Kl.value=a[(e+1)%a.length],Nl.value&&(Nl.value.playbackRate=Kl.value)},Hs=a=>{if(!a||isNaN(a))return"00:00";const e=Math.floor(a/60),l=Math.floor(a%60);return`${e.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},Ls=a=>{Al.value=!1,ql.value=a,Ql&&(clearInterval(Ql),Ql=null),a>0&&(Ql=setInterval(()=>{ql.value--,ql.value<=0&&(clearInterval(Ql),Nl.value&&Nl.value.pause(),H.info("å®šæ—¶å…³é—­å·²ç”Ÿæ•ˆ"))},6e4))},zs=async()=>{try{const a=await $.post(`/gallery-novel/novel/${ul.value.id}/like`);ul.value.is_liked=a.data.liked,ul.value.like_count=a.data.like_count}catch(a){H.error("æ“ä½œå¤±è´¥")}},Es=async()=>{try{const a=await $.post(`/gallery-novel/novel/${ul.value.id}/collect`);ul.value.is_collected=a.data.collected,H.success(a.data.collected?"æ”¶è—æˆåŠŸ":"å·²å–æ¶ˆæ”¶è—")}catch(a){H.error("æ“ä½œå¤±è´¥")}},Rs=(a,e)=>{if(a)return a;return(a=>{const e=a%52;if(e<17)return`/images/avatars/icon_avatar_${e+1}.webp`;if(e<32)return`/images/avatars/DM_20251217202131_${String(e-17+1).padStart(3,"0")}.JPEG`;return`/images/avatars/DM_20251217202341_${String(e-32+1).padStart(3,"0")}.JPEG`})(parseInt(e)||1)};return l(()=>cl.params.id,(a,e)=>{a&&a!==e&&as()}),s(()=>{as()}),t(()=>{Gl&&clearTimeout(Gl),Ql&&clearInterval(Ql),Nl.value&&Nl.value.pause()}),(a,e)=>{var l,s,t,_,y,h,x,cl,Fl,Gl,Ql,as;return f(),n("div",L,[c("header",z,[c("button",{class:"back-btn",onClick:bs},[...e[22]||(e[22]=[c("img",{src:C,alt:"è¿”å›ž",class:"back-icon"},null,-1)])]),c("div",E,[c("button",{class:o(["collect-btn",{active:null==(l=ul.value)?void 0:l.is_collected}]),onClick:Es},[c("span",null,u((null==(s=ul.value)?void 0:s.is_collected)?"å·²æ”¶è—":"+ æ”¶è—"),1)],2)])]),ol.value?(f(),n("div",R,[...e[23]||(e[23]=[c("div",{class:"loading-spinner"},null,-1),c("p",null,"åŠ è½½ä¸­...",-1)])])):ul.value?(f(),n("div",V,[c("div",{class:"novel-header",style:r({backgroundImage:`url(${ul.value.cover})`})},[e[24]||(e[24]=c("div",{class:"header-overlay"},null,-1)),c("div",U,[c("img",{src:ul.value.cover,alt:ul.value.title,class:"novel-cover"},null,8,F),c("div",G,[c("h2",N,u(ul.value.title),1),c("p",J,"å…±"+u(ul.value.chapter_count)+"è¯ / "+u("ongoing"===ul.value.status?"è¿žè½½ä¸­":"å·²å®Œç»“"),1)])])],4),c("div",O,[c("p",{class:o(["novel-desc",{expanded:vl.value}])},u(ul.value.description||"æš‚æ— ç®€ä»‹"),3),c("div",{class:"expand-btn",onClick:e[0]||(e[0]=a=>vl.value=!vl.value)},[v(u(vl.value?"æ”¶èµ·":"æ›´å¤šç®€ä»‹")+" ",1),c("span",{class:o(["arrow-down",{up:vl.value}])},null,2)])]),c("div",B,[c("div",K,[c("span",Y,"å…±"+u(rl.value.length)+"ç« ",1),c("button",{class:"catalog-btn",onClick:e[1]||(e[1]=a=>pl.value=!0)},[...e[25]||(e[25]=[v("ç›®å½• ",-1),c("span",{class:"arrow-right"},null,-1)])])]),c("div",q,[(f(!0),n(d,null,p(Wl.value,a=>{var e;return f(),n("div",{key:a.id,class:o(["chapter-item",{current:(null==(e=ul.value.read_progress)?void 0:e.chapter_id)===a.id}]),onClick:e=>ys(a)},[c("span",Q,"ç¬¬"+u(a.num)+"ç«  "+u(a.title),1),Zl(a)?(f(),n("span",W,"new")):i("",!0),a.is_free||ul.value.is_vip?(f(),n("span",Z)):(f(),n("span",X,"ðŸ”’"))],10,A)}),128))])]),c("div",aa,[c("div",ea,[c("span",{class:o(["tab-item",{active:"recommend"===dl.value}]),onClick:e[2]||(e[2]=a=>dl.value="recommend")},"ç›¸å…³æŽ¨è",2),c("span",{class:o(["tab-item",{active:"comments"===dl.value}]),onClick:e[3]||(e[3]=a=>dl.value="comments")},"äº’åŠ¨ç‚¹è¯„("+u(bl.value)+")",3)]),"recommend"===dl.value?(f(),n("div",la,[(f(!0),n(d,null,p(kl.value,a=>(f(),n("div",{key:a.id,class:"recommend-item",onClick:e=>(a=>{var e;a!==(null==(e=ul.value)?void 0:e.id)&&il.replace(`/user/novel/${a}`)})(a.id)},[c("div",ta,[c("img",{src:a.cover,alt:a.title,class:"recommend-cover"},null,8,na)]),c("p",ca,u(a.title),1)],8,sa))),128)),0===kl.value.length?(f(),n("div",ia,"æš‚æ— æŽ¨è")):i("",!0)])):i("",!0),"comments"===dl.value?(f(),n("div",oa,[0===gl.value.length?(f(),n("div",ua,"æš‚æ— è¯„è®º")):i("",!0),(f(!0),n(d,null,p(gl.value.slice(0,3),a=>(f(),n("div",{key:a.id,class:"comment-item"},[c("img",{src:Rs(a.user_avatar,a.user_id),class:"comment-avatar",onError:e[4]||(e[4]=a=>a.target.src="/images/avatars/icon_avatar_1.webp")},null,40,ra),c("div",va,[c("span",da,u(a.user_nickname),1),c("p",pa,u(a.content),1)])]))),128))])):i("",!0)])])):(f(),n("div",ma,[e[26]||(e[26]=c("p",null,"å°è¯´ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤",-1)),c("button",{class:"back-btn-large",onClick:bs},"è¿”å›ž")])),ul.value?(f(),n("div",ka,[c("button",{class:o(["action-btn",{active:ul.value.is_liked}]),onClick:zs},[c("img",{src:ul.value.is_liked?m(T):m(S),class:"action-icon"},null,8,ga),c("span",ba,u(ul.value.like_count||0),1)],2),c("button",{class:"action-btn",onClick:ss},[c("img",{src:m(j),class:"action-icon"},null,8,_a),c("span",ya,u(bl.value),1)]),c("button",{class:"read-btn",onClick:_s},u(ul.value.read_progress?"ç»§ç»­é˜…è¯»":"å¼€å§‹é˜…è¯»"),1)])):i("",!0),pl.value?(f(),n("div",{key:4,class:"catalog-modal",onClick:e[7]||(e[7]=k(a=>pl.value=!1,["self"]))},[c("div",ha,[e[28]||(e[28]=c("div",{class:"drag-handle"},null,-1)),c("div",fa,[c("span",Ca,u(null==(t=ul.value)?void 0:t.title),1),c("div",wa,[c("span",{class:o(["sort-tab",{active:"asc"===ml.value}]),onClick:e[5]||(e[5]=a=>ml.value="asc")},"æ­£åº",2),e[27]||(e[27]=c("span",{class:"sort-divider"},"/",-1)),c("span",{class:o(["sort-tab",{active:"desc"===ml.value}]),onClick:e[6]||(e[6]=a=>ml.value="desc")},"å€’åº",2)])]),c("div",xa,[(f(!0),n(d,null,p(Xl.value,a=>{var e,l;return f(),n("div",{key:a.id,class:o(["catalog-item",{current:(null==(e=ul.value.read_progress)?void 0:e.chapter_id)===a.id,locked:!a.is_free&&!ul.value.is_vip}]),onClick:e=>ys(a)},[c("span",Ta,"ç¬¬"+u(a.num)+"ç«  "+u(a.title),1),a.is_free||ul.value.is_vip?(f(),n("span",{key:1,class:o(["arrow-right",{active:(null==(l=ul.value.read_progress)?void 0:l.chapter_id)===a.id}])},null,2)):(f(),n("span",Sa,"ðŸ”’"))],10,$a)}),128)),rl.value.length>0?(f(),n("div",ja,"æ²¡æœ‰æ›´å¤šæ•°æ®äº†")):i("",!0)])])])):i("",!0),Pl.value?(f(),n("div",Ia,[c("div",Ma,[c("button",{class:"back-btn",onClick:ws},[...e[29]||(e[29]=[c("img",{src:C,alt:"è¿”å›ž",class:"back-icon"},null,-1)])]),c("span",Da,u(null==(_=Ll.value)?void 0:_.title),1),c("button",{class:"setting-btn",onClick:e[8]||(e[8]=a=>Vl.value=!Vl.value)},"âš™ï¸")]),Vl.value?(f(),n("div",Pa,[c("div",Ha,[e[30]||(e[30]=c("span",null,"å­—ä½“å¤§å°",-1)),c("div",La,[(f(),n(d,null,p([14,16,18,20,22],a=>c("button",{key:a,class:o({active:Rl.value===a}),onClick:e=>Rl.value=a},u(a),11,za)),64))])])])):i("",!0),c("div",{class:"reader-content",ref_key:"readerContent",ref:Ul,style:r({fontSize:Rl.value+"px"}),onScroll:Ts},[El.value?(f(),n("div",Ea,[...e[31]||(e[31]=[c("div",{class:"loading-spinner"},null,-1)])])):(f(),n("div",{key:1,class:"chapter-content",innerHTML:(as=null==(y=Ll.value)?void 0:y.content,as?as.replace(/\n/g,"<br/>"):"")},null,8,Ra))],36),c("div",Va,[c("button",{class:"nav-btn",disabled:!(null==(h=Ll.value)?void 0:h.prev_chapter),onClick:fs},"ä¸Šä¸€ç« ",8,Ua),c("span",Fa,u(zl.value+1)+" / "+u(rl.value.length),1),c("button",{class:"nav-btn",disabled:!(null==(x=Ll.value)?void 0:x.next_chapter),onClick:Cs},"ä¸‹ä¸€ç« ",8,Ga)])])):i("",!0),Hl.value?(f(),n("div",Na,[c("div",Ja,[c("button",{class:"back-btn",onClick:xs},[...e[32]||(e[32]=[c("img",{src:C,alt:"è¿”å›ž",class:"back-icon"},null,-1)])]),c("span",Oa,u(null==(cl=Ll.value)?void 0:cl.title),1),e[33]||(e[33]=c("div",{class:"header-right"},null,-1))]),c("div",Ba,[c("div",Ka,[c("img",{src:ul.value.cover,alt:ul.value.title,class:"player-cover"},null,8,Ya),Jl.value?(f(),n("div",qa,[...e[34]||(e[34]=[c("span",null,null,-1),c("span",null,null,-1),c("span",null,null,-1),c("span",null,null,-1)])])):i("",!0)]),c("div",Aa,[c("h3",Qa,u(ul.value.title),1),c("p",Wa,u(null==(Fl=Ll.value)?void 0:Fl.title),1)]),c("div",Xa,[c("span",Za,u(Hs(Ol.value)),1),c("input",{type:"range",class:"progress-slider",value:Ol.value,max:Bl.value,onInput:e[9]||(e[9]=a=>{return e=a.target.value,void(Nl.value&&(Nl.value.currentTime=parseFloat(e)));var e})},null,40,ae),c("span",ee,u(Hs(Bl.value)),1)]),c("div",le,[c("button",{class:"control-btn",onClick:fs,disabled:!(null==(Gl=Ll.value)?void 0:Gl.prev_chapter)},"â®ï¸",8,se),c("button",{class:"control-btn rewind",onClick:e[10]||(e[10]=a=>Ds(-15))},"-15s"),c("button",{class:"control-btn play-btn",onClick:Ss},u(Jl.value?"â¸ï¸":"â–¶ï¸"),1),c("button",{class:"control-btn forward",onClick:e[11]||(e[11]=a=>Ds(15))},"+15s"),c("button",{class:"control-btn",onClick:Cs,disabled:!(null==(Ql=Ll.value)?void 0:Ql.next_chapter)},"â­ï¸",8,te)]),c("div",ne,[c("button",{class:"option-btn",onClick:Ps},u(Kl.value)+"x",1),c("button",{class:"option-btn",onClick:e[12]||(e[12]=a=>Al.value=!0)},u(ql.value?`${ql.value}åˆ†é’ŸåŽå…³é—­`:"å®šæ—¶å…³é—­"),1),c("button",{class:o(["option-btn",{active:Yl.value}]),onClick:e[13]||(e[13]=a=>Yl.value=!Yl.value)},u(Yl.value?"è¿žæ’­ä¸­":"å•ç« "),3)])]),c("div",ce,[e[35]||(e[35]=c("div",{class:"chapters-header"},[c("span",null,"ç« èŠ‚åˆ—è¡¨")],-1)),c("div",ie,[(f(!0),n(d,null,p(rl.value,a=>{var e;return f(),n("div",{key:a.id,class:o(["chapter-item",{active:(null==(e=Ll.value)?void 0:e.id)===a.id,locked:!a.is_free&&!ul.value.is_vip}]),onClick:e=>ys(a)},[c("span",null,u(a.title),1),a.is_free||ul.value.is_vip?i("",!0):(f(),n("span",ue,"ðŸ”’"))],10,oe)}),128))])]),c("audio",{ref_key:"audioPlayer",ref:Nl,onTimeupdate:js,onLoadedmetadata:Is,onEnded:Ms,onPlay:e[14]||(e[14]=a=>Jl.value=!0),onPause:e[15]||(e[15]=a=>Jl.value=!1)},null,544)])):i("",!0),Al.value?(f(),n("div",{key:7,class:"timer-modal",onClick:e[17]||(e[17]=k(a=>Al.value=!1,["self"]))},[c("div",re,[e[36]||(e[36]=c("h3",null,"å®šæ—¶å…³é—­",-1)),c("div",ve,[(f(),n(d,null,p([15,30,45,60,90],a=>c("button",{key:a,onClick:e=>Ls(a)},u(a)+"åˆ†é’Ÿ",9,de)),64)),c("button",{onClick:e[16]||(e[16]=a=>Ls(0))},"å–æ¶ˆå®šæ—¶")])])])):i("",!0),_l.value?(f(),n("div",{key:8,class:"comments-modal",onClick:k(ts,["self"])},[c("div",pe,[e[41]||(e[41]=c("div",{class:"drag-handle"},null,-1)),c("div",me,[c("span",ke,u(gl.value.length)+"æ¡è¯„è®º",1),c("div",ge,[c("span",{class:o(["sort-tab",{active:"hot"===yl.value}]),onClick:e[18]||(e[18]=a=>yl.value="hot")},"æŽ¨è",2),e[37]||(e[37]=c("span",{class:"sort-divider"},"|",-1)),c("span",{class:o(["sort-tab",{active:"new"===yl.value}]),onClick:e[19]||(e[19]=a=>yl.value="new")},"æœ€æ–°",2)])]),c("div",be,[hl.value&&hl.value.enabled?(f(),n("div",_e,[c("img",{src:hl.value.avatar||"/images/avatars/icon_avatar_1.webp",class:"comment-avatar"},null,8,ye),c("div",he,[c("div",fe,[c("span",Ce,u(hl.value.name),1),e[38]||(e[38]=c("img",{src:w,class:"supreme-vip-icon"},null,-1))]),c("div",we,u(hl.value.content),1),c("div",xe,[c("span",$e,u(gs(hl.value.updated_at)),1)])])])):i("",!0),0!==gl.value.length||hl.value&&hl.value.enabled?i("",!0):(f(),n("div",Te,"æš‚æ— è¯„è®º")),(f(!0),n(d,null,p(gl.value,a=>{return f(),n("div",{key:a.id,class:"comment-item"},[c("img",{src:Rs(a.user_avatar,a.user_id),class:"comment-avatar clickable",onClick:e=>ms(a.user_id),onError:e[20]||(e[20]=a=>a.target.src="/images/avatars/icon_avatar_1.webp")},null,40,Se),c("div",je,[c("div",Ie,[c("span",{class:"username clickable",onClick:e=>ms(a.user_id)},u(a.user_nickname||"ç”¨æˆ·"),9,Me),a.user_vip_level>0?(f(),n("img",{key:0,src:(l=a.user_vip_level,P[l]||""),class:"vip-badge-sm"},null,8,De)):i("",!0)]),c("div",Pe,u(a.content),1),a.image_url?(f(),n("div",{key:0,class:"comment-image",onClick:e=>{return l=a.image_url,jl.value=l,void(Il.value=!0);var l}},[c("img",{src:a.image_url,alt:"è¯„è®ºå›¾ç‰‡"},null,8,Le)],8,He)):i("",!0),c("div",ze,[c("span",Ee,u(ks(a.created_at)),1),c("div",Re,[c("span",{class:o(["comment-like",{liked:a.is_liked}]),onClick:e=>(async a=>{try{const e=await $.post(`/gallery-novel/novel-comment/${a.id}/like`);a.is_liked=e.data.liked,a.like_count=e.data.like_count}catch(e){H.error("æ“ä½œå¤±è´¥")}})(a)},u(a.is_liked?"â¤ï¸":"ðŸ¤")+" "+u(a.like_count||0),11,Ve),c("span",{class:"comment-reply",onClick:e=>(a=>{Ml.value=a,wl.value=`@${a.user_nickname||"ç”¨æˆ·"} `,is()})(a)},[c("img",{src:m(D),class:"reply-icon"},null,8,Fe)],8,Ue)])])])]);var l}),128)),gl.value.length>0?(f(),n("div",Ge,"æ²¡æœ‰æ›´å¤šæ•°æ®äº†")):i("",!0)]),c("div",{class:"comment-input-trigger",onClick:is},[...e[39]||(e[39]=[c("span",{class:"input-placeholder"},"åœ¨è¿™é‡Œå†™ä¸‹ä½ æƒ³è¯´çš„...",-1),c("span",{class:"char-count"},"0/500",-1)])]),c("div",Ne,[c("div",Je,[c("button",{class:"toolbar-btn",onClick:rs},[c("img",{src:m(I),class:"toolbar-icon"},null,8,Oe)]),c("button",{class:"toolbar-btn",onClick:us},[...e[40]||(e[40]=[c("span",{class:"emoji-icon"},"ðŸ˜Š",-1)])])]),c("button",{class:"toolbar-send",onClick:is},[c("img",{src:m(M),class:"send-icon"},null,8,Be)])])])])):i("",!0),fl.value?(f(),n("div",{key:9,class:"input-panel-modal",onClick:k(os,["self"])},[c("div",Ke,[c("div",Ye,[c("button",{class:"cancel-btn",onClick:os},"å–æ¶ˆ"),e[42]||(e[42]=c("span",{class:"panel-title"},"å‘è¡¨è¯„è®º",-1)),c("button",{class:"submit-btn",disabled:!wl.value.trim()&&!xl.value,onClick:cs},"å‘é€",8,qe)]),c("div",Ae,[g(c("textarea",{"onUpdate:modelValue":e[21]||(e[21]=a=>wl.value=a),class:"full-input",placeholder:"åœ¨è¿™é‡Œå†™ä¸‹ä½ æƒ³è¯´çš„...",maxlength:"500",ref_key:"textareaRef",ref:Sl},null,512),[[b,wl.value]]),c("div",Qe,u(wl.value.length)+"/500",1),xl.value?(f(),n("div",We,[c("img",{src:$l.value,alt:"é¢„è§ˆ"},null,8,Xe),c("button",{class:"remove-image",onClick:ds},"Ã—")])):i("",!0)]),c("div",Ze,[c("div",al,[c("button",{class:"footer-btn",onClick:rs},[c("img",{src:m(I),class:"footer-icon"},null,8,el)]),c("button",{class:"footer-btn",onClick:us},[...e[43]||(e[43]=[c("span",{class:"emoji-icon"},"ðŸ˜Š",-1)])])])]),Cl.value?(f(),n("div",ll,[(f(),n(d,null,p(Dl,a=>c("span",{key:a,class:"emoji-item",onClick:e=>(a=>{wl.value+=a})(a)},u(a),9,sl)),64))])):i("",!0)])])):i("",!0),Il.value?(f(),n("div",{key:10,class:"comment-image-preview-modal",onClick:ps},[c("div",tl,[c("img",{src:jl.value,alt:"è¯„è®ºå›¾ç‰‡"},null,8,nl),c("button",{class:"close-preview-btn",onClick:k(ps,["stop"])},"Ã—")])])):i("",!0),c("input",{type:"file",ref_key:"imageInput",ref:Tl,accept:"image/*",style:{display:"none"},onChange:vs},null,544)])}}},[["__scopeId","data-v-ddd93ef5"]]);export{cl as default};
