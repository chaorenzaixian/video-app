/* empty css             *//* empty css                   *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  */import{aM as e,be as a,bk as l,E as t,aQ as s,a6 as o,bh as i,bi as u,bj as d,bo as r,bs as n,aR as p,aS as m,bl as c,bm as _,aT as v,bv as b,a as f}from"./element-plus-DlIn_qXi.js";import{_ as k,a as y}from"./index-C3P4JTuA.js";import{r as V,j as w,y as g,C as h,O as j,F as U,z as x,K as C,u as q,G as z,E as I,L as P}from"./vue-vendor-Ba_vealp.js";import"./utils-DflAyOWx.js";const $={class:"tasks-manage"},A={class:"page-header"},E=k({__name:"TasksManage",setup(k){const E=V(!1),F=V(!1),G=V([]),K=V(!1),M=V(!1),R=V(null),T={task_type:"",task_name:"",task_desc:"",points_reward:5,daily_limit:1,icon:"ðŸŽ",icon_bg:"linear-gradient(360deg, #9e52cf, #4d45bf)",action_type:"claim",action_url:"",sort_order:0,is_active:!0},D=V({...T}),H={task_type:[{required:!0,message:"è¯·é€‰æ‹©ä»»åŠ¡ç±»åž‹",trigger:"change"}],task_name:[{required:!0,message:"è¯·è¾“å…¥ä»»åŠ¡åç§°",trigger:"blur"}],task_desc:[{required:!0,message:"è¯·è¾“å…¥ä»»åŠ¡æè¿°",trigger:"blur"}],points_reward:[{required:!0,message:"è¯·è¾“å…¥ç§¯åˆ†å¥–åŠ±",trigger:"blur"}]},L=async()=>{E.value=!0;try{const e=await y.get("/admin/tasks");G.value=e.data||[]}catch(e){t.error("èŽ·å–ä»»åŠ¡åˆ—è¡¨å¤±è´¥")}finally{E.value=!1}},N=()=>{M.value=!1,D.value={...T},K.value=!0},O=async()=>{R.value&&await R.value.validate(async e=>{var a,l;if(e){F.value=!0;try{M.value?(await y.put(`/admin/tasks/${D.value.id}`,D.value),t.success("æ›´æ–°æˆåŠŸ")):(await y.post("/admin/tasks",D.value),t.success("åˆ›å»ºæˆåŠŸ")),K.value=!1,L()}catch(s){t.error((null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.detail)||"æ“ä½œå¤±è´¥")}finally{F.value=!1}}})};return w(()=>{L()}),(k,V)=>{const w=s,T=e,Q=u,S=d,B=r,J=i,W=a,X=_,Y=c,Z=m,ee=v,ae=b,le=p,te=l,se=n;return x(),g("div",$,[h("div",A,[V[12]||(V[12]=h("h2",null,"ä»»åŠ¡ç®¡ç†",-1)),j(T,{type:"primary",onClick:N},{default:U(()=>[j(w,null,{default:U(()=>[j(q(o))]),_:1}),V[11]||(V[11]=C(" æ–°å¢žä»»åŠ¡ ",-1))]),_:1})]),j(W,null,{default:U(()=>[z((x(),I(J,{data:G.value,stripe:""},{default:U(()=>[j(Q,{prop:"id",label:"ID",width:"60"}),j(Q,{prop:"task_type",label:"ä»»åŠ¡ç±»åž‹",width:"120"}),j(Q,{prop:"task_name",label:"ä»»åŠ¡åç§°",width:"150"}),j(Q,{prop:"task_desc",label:"ä»»åŠ¡æè¿°","min-width":"200"}),j(Q,{prop:"points_reward",label:"ç§¯åˆ†å¥–åŠ±",width:"100"},{default:U(({row:e})=>[j(S,{type:"warning"},{default:U(()=>[C("+"+P(e.points_reward),1)]),_:2},1024)]),_:1}),j(Q,{prop:"daily_limit",label:"æ¯æ—¥é™åˆ¶",width:"100"}),j(Q,{prop:"sort_order",label:"æŽ’åº",width:"80"}),j(Q,{prop:"is_active",label:"çŠ¶æ€",width:"100"},{default:U(({row:e})=>[j(B,{modelValue:e.is_active,"onUpdate:modelValue":a=>e.is_active=a,onChange:a=>(async e=>{try{await y.put(`/admin/tasks/${e.id}`,{is_active:e.is_active}),t.success(e.is_active?"å·²å¯ç”¨":"å·²ç¦ç”¨")}catch(a){e.is_active=!e.is_active,t.error("æ“ä½œå¤±è´¥")}})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),j(Q,{label:"æ“ä½œ",width:"150",fixed:"right"},{default:U(({row:e})=>[j(T,{size:"small",onClick:a=>(e=>{M.value=!0,D.value={...e},K.value=!0})(e)},{default:U(()=>[...V[13]||(V[13]=[C("ç¼–è¾‘",-1)])]),_:1},8,["onClick"]),j(T,{size:"small",type:"danger",onClick:a=>(async e=>{try{await f.confirm("ç¡®å®šè¦åˆ é™¤è¯¥ä»»åŠ¡å—ï¼Ÿ","æç¤º",{type:"warning"}),await y.delete(`/admin/tasks/${e.id}`),t.success("åˆ é™¤æˆåŠŸ"),L()}catch(a){"cancel"!==a&&t.error("åˆ é™¤å¤±è´¥")}})(e)},{default:U(()=>[...V[14]||(V[14]=[C("åˆ é™¤",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[se,E.value]])]),_:1}),j(te,{modelValue:K.value,"onUpdate:modelValue":V[10]||(V[10]=e=>K.value=e),title:M.value?"ç¼–è¾‘ä»»åŠ¡":"æ–°å¢žä»»åŠ¡",width:"500px"},{footer:U(()=>[j(T,{onClick:V[9]||(V[9]=e=>K.value=!1)},{default:U(()=>[...V[16]||(V[16]=[C("å–æ¶ˆ",-1)])]),_:1}),j(T,{type:"primary",onClick:O,loading:F.value},{default:U(()=>[...V[17]||(V[17]=[C("ç¡®å®š",-1)])]),_:1},8,["loading"])]),default:U(()=>[j(le,{model:D.value,rules:H,ref_key:"formRef",ref:R,"label-width":"100px"},{default:U(()=>[j(Z,{label:"ä»»åŠ¡ç±»åž‹",prop:"task_type"},{default:U(()=>[j(Y,{modelValue:D.value.task_type,"onUpdate:modelValue":V[0]||(V[0]=e=>D.value.task_type=e),placeholder:"é€‰æ‹©ä»»åŠ¡ç±»åž‹",disabled:M.value},{default:U(()=>[j(X,{label:"ç­¾åˆ°",value:"checkin"}),j(X,{label:"å‘å¸–",value:"post"}),j(X,{label:"å¸–å­è¯„è®º",value:"comment_post"}),j(X,{label:"è§†é¢‘è¯„è®º",value:"comment_video"}),j(X,{label:"é‚€è¯·",value:"invite"}),j(X,{label:"è´­ä¹°VIP",value:"buy_vip"}),j(X,{label:"ä¸‹è½½APP",value:"download"}),j(X,{label:"è‡ªå®šä¹‰",value:"custom"})]),_:1},8,["modelValue","disabled"])]),_:1}),j(Z,{label:"ä»»åŠ¡åç§°",prop:"task_name"},{default:U(()=>[j(ee,{modelValue:D.value.task_name,"onUpdate:modelValue":V[1]||(V[1]=e=>D.value.task_name=e),placeholder:"è¾“å…¥ä»»åŠ¡åç§°"},null,8,["modelValue"])]),_:1}),j(Z,{label:"ä»»åŠ¡æè¿°",prop:"task_desc"},{default:U(()=>[j(ee,{modelValue:D.value.task_desc,"onUpdate:modelValue":V[2]||(V[2]=e=>D.value.task_desc=e),type:"textarea",rows:2,placeholder:"è¾“å…¥ä»»åŠ¡æè¿°"},null,8,["modelValue"])]),_:1}),j(Z,{label:"ç§¯åˆ†å¥–åŠ±",prop:"points_reward"},{default:U(()=>[j(ae,{modelValue:D.value.points_reward,"onUpdate:modelValue":V[3]||(V[3]=e=>D.value.points_reward=e),min:1,max:1e4},null,8,["modelValue"])]),_:1}),j(Z,{label:"æ¯æ—¥é™åˆ¶",prop:"daily_limit"},{default:U(()=>[j(ae,{modelValue:D.value.daily_limit,"onUpdate:modelValue":V[4]||(V[4]=e=>D.value.daily_limit=e),min:1,max:100},null,8,["modelValue"]),V[15]||(V[15]=h("span",{class:"form-tip"},"æ¯æ—¥å¯å®Œæˆæ¬¡æ•°",-1))]),_:1}),j(Z,{label:"å›¾æ ‡",prop:"icon"},{default:U(()=>[j(ee,{modelValue:D.value.icon,"onUpdate:modelValue":V[5]||(V[5]=e=>D.value.icon=e),placeholder:"è¾“å…¥å›¾æ ‡(emojiæˆ–å›¾ç‰‡è·¯å¾„)"},null,8,["modelValue"])]),_:1}),j(Z,{label:"è·³è½¬é“¾æŽ¥",prop:"action_url"},{default:U(()=>[j(ee,{modelValue:D.value.action_url,"onUpdate:modelValue":V[6]||(V[6]=e=>D.value.action_url=e),placeholder:"ä»»åŠ¡è·³è½¬é“¾æŽ¥(å¯é€‰)"},null,8,["modelValue"])]),_:1}),j(Z,{label:"æŽ’åº",prop:"sort_order"},{default:U(()=>[j(ae,{modelValue:D.value.sort_order,"onUpdate:modelValue":V[7]||(V[7]=e=>D.value.sort_order=e),min:0,max:999},null,8,["modelValue"])]),_:1}),j(Z,{label:"å¯ç”¨çŠ¶æ€"},{default:U(()=>[j(B,{modelValue:D.value.is_active,"onUpdate:modelValue":V[8]||(V[8]=e=>D.value.is_active=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-f68373e2"]]);export{E as default};
