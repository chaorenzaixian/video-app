import{_ as a}from"./ic_back-BPdSG6fy.js";import{_ as s,u as e,a as l}from"./index-C3P4JTuA.js";import{r as t,c,j as n,y as r,C as o,I as u,L as i,z as d}from"./vue-vendor-Ba_vealp.js";import"./element-plus-DlIn_qXi.js";import"./utils-DflAyOWx.js";const v={class:"credential-page"},p={class:"page-header"},b={class:"credential-card"},g={class:"card-content"},k={class:"qr-container"},m={key:0,class:"qr-frame"},h=["src"],f={key:1,class:"qr-loading"},y={class:"account-info"},q={class:"user-id"},_={class:"website"},C={class:"tip"},w={key:0,class:"token-status"},j={class:"action-buttons"},$=["disabled"],I=s({__name:"AccountCredential",setup(s){const I=e(),x=t("Soul成人版"),z=t("https://soul9.fm"),R=t("提示*扫码可直接登录，仅限一台设备使用"),A=t(!1),D=t(""),L=t(!1),Q=c(()=>{var a;return(null==(a=I.user)?void 0:a.id)||"0000000"}),S=c(()=>D.value?`${z.value}/qr-login?token=${D.value}`:`${z.value}?ref=${Q.value}`),U=c(()=>`https://api.qrserver.com/v1/create-qr-code/?size=140x140&data=${encodeURIComponent(S.value)}`),B=async()=>{A.value=!0;try{const a=await l.post("/auth/regenerate-qr-token");D.value=a.data.token,L.value=!1}catch(a){}finally{A.value=!1}},E=async()=>{try{alert("请长按页面截图保存")}catch(a){}};return n(()=>{(async()=>{try{const a=await l.get("/config/credential");a.data&&(x.value=a.data.site_name||x.value,z.value=a.data.site_url||z.value,R.value=a.data.tip||R.value)}catch(a){}})(),(async()=>{A.value=!0;try{const a=await l.get("/auth/qr-token-status");if(a.data.has_token)D.value=a.data.token,L.value=!1;else{const a=await l.post("/auth/generate-qr-token");D.value=a.data.token,L.value=!1}}catch(a){}finally{A.value=!1}})()}),(s,e)=>(d(),r("div",v,[o("div",p,[o("button",{class:"back-btn",onClick:e[0]||(e[0]=a=>s.$router.back())},[...e[1]||(e[1]=[o("img",{src:a,alt:"返回",class:"back-icon"},null,-1)])]),e[2]||(e[2]=o("h1",{class:"page-title"},"账号凭证",-1)),e[3]||(e[3]=o("div",{class:"header-right"},null,-1))]),o("div",b,[e[11]||(e[11]=o("div",{class:"card-background"},[o("img",{src:"/images/backgrounds/girl.webp",alt:"background",class:"bg-image"}),o("div",{class:"bg-overlay"})],-1)),o("div",g,[o("div",k,[A.value?(d(),r("div",f,[...e[8]||(e[8]=[o("span",null,"生成中...",-1)])])):(d(),r("div",m,[o("img",{src:U.value,alt:"QR Code",class:"qr-code"},null,8,h),e[4]||(e[4]=o("div",{class:"corner corner-tl"},null,-1)),e[5]||(e[5]=o("div",{class:"corner corner-tr"},null,-1)),e[6]||(e[6]=o("div",{class:"corner corner-bl"},null,-1)),e[7]||(e[7]=o("div",{class:"corner corner-br"},null,-1))]))]),o("div",y,[e[9]||(e[9]=o("h2",{class:"info-title"},"账号凭证",-1)),o("p",q,"ID "+i(Q.value),1),o("p",_,i(x.value)+" 官网地址 "+i(z.value),1),o("p",C,i(R.value),1)]),L.value?(d(),r("div",w,[e[10]||(e[10]=o("span",{class:"status-warning"},"⚠ 当前二维码已被使用",-1)),o("button",{class:"refresh-btn",onClick:B},"重新生成")])):u("",!0)])]),o("div",j,[o("button",{class:"save-btn",onClick:E},[...e[12]||(e[12]=[o("span",null,"保存图片",-1)])]),o("button",{class:"refresh-btn-bottom",onClick:B,disabled:A.value},[o("span",null,i(A.value?"生成中...":"重新生成二维码"),1)],8,$)])]))}},[["__scopeId","data-v-75b26dd9"]]);export{I as default};
