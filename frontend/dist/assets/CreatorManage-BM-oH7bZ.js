/* empty css             *//* empty css                   *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     *//* empty css                  *//* empty css                             *//* empty css                   *//* empty css                    *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                        *//* empty css                    *//* empty css                  *//* empty css                  */import{_ as e,a}from"./index-C3P4JTuA.js";import{bz as l,bk as t,bA as i,bl as r,bm as s,aT as o,aM as d,bh as n,bi as p,b6 as u,bj as c,bs as m,bt as v,bG as _,bH as f,aR as b,aS as g,bv as y,bo as w,bF as h,a as k,E as V}from"./element-plus-DlIn_qXi.js";import{r as j,l as z,j as C,y as x,C as U,O as S,F as $,z as D,G as I,K as M,E as F,L as G,I as H,M as E}from"./vue-vendor-Ba_vealp.js";import"./utils-DflAyOWx.js";const K={class:"admin-page"},L={class:"tab-header"},P={class:"user-cell"},R={class:"user-info"},q={class:"user-name"},A={class:"user-id"},J={class:"tab-header"},N={class:"user-cell"},O={class:"user-info"},T={class:"user-name"},X={class:"user-id"},Y={class:"coins-text"},B={class:"coins-text"},Q={class:"share-tip"},W=e({__name:"CreatorManage",setup(e){const W=j("applications"),Z=j(!1),ee=j([]),ae=z({status:"pending",keyword:""}),le=z({page:1,pageSize:15,total:0}),te=j([]),ie=z({keyword:"",verified:null}),re=z({page:1,pageSize:15,total:0}),se=z({visible:!1,app:null,reason:""}),oe=z({visible:!1,app:null}),de=z({visible:!1,creator:null}),ne=j({creator_level:1,is_verified:!1,verification_type:"personal",creator_share:70}),pe=e=>({pending:"warning",approved:"success",rejected:"danger"}[e]||"info"),ue=e=>({pending:"待审核",approved:"已通过",rejected:"已拒绝"}[e]||e),ce=e=>{if(!e)return"-";const a=new Date(e);return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")} ${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`},me=async()=>{var e,l;Z.value=!0;try{const t=await a.get("/admin/creator-applications",{params:{status:ae.status,page:le.page}});ee.value=(null==(e=t.data)?void 0:e.items)||[],le.total=(null==(l=t.data)?void 0:l.total)||0}catch(t){ee.value=[]}finally{Z.value=!1}},ve=async()=>{var e,l;try{const t=await a.get("/admin/creators",{params:{keyword:ie.keyword,page:re.page}});te.value=(null==(e=t.data)?void 0:e.items)||[],re.total=(null==(l=t.data)?void 0:l.total)||0}catch(t){te.value=[]}},_e=async()=>{if(se.reason)try{await a.post(`/admin/creator-applications/${se.app.id}/reject`,{reason:se.reason}),V.success("已拒绝"),se.visible=!1,await me()}catch(e){V.error("操作失败")}else V.warning("请输入拒绝原因")},fe=async()=>{try{await a.put(`/admin/creators/${de.creator.id}`,{creator_level:ne.value.creator_level,is_verified:ne.value.is_verified,verification_type:ne.value.verification_type,platform_share_ratio:(100-ne.value.creator_share)/100}),V.success("保存成功"),de.visible=!1,await ve()}catch(e){V.error("保存失败")}};return C(()=>{me()}),(e,j)=>{const z=s,C=r,be=o,ge=d,ye=p,we=u,he=c,ke=n,Ve=v,je=i,ze=l,Ce=t,xe=f,Ue=_,Se=y,$e=g,De=w,Ie=h,Me=b,Fe=m;return D(),x("div",K,[j[34]||(j[34]=U("div",{class:"page-header"},[U("h1",null,"创作者管理"),U("p",{class:"page-desc"},"审核创作者申请、管理创作者账号")],-1)),S(ze,{modelValue:W.value,"onUpdate:modelValue":j[6]||(j[6]=e=>W.value=e),class:"main-tabs"},{default:$(()=>[S(je,{label:"申请审核",name:"applications"},{default:$(()=>[U("div",L,[S(C,{modelValue:ae.status,"onUpdate:modelValue":j[0]||(j[0]=e=>ae.status=e),placeholder:"状态",clearable:"",style:{width:"120px"}},{default:$(()=>[S(z,{label:"待审核",value:"pending"}),S(z,{label:"已通过",value:"approved"}),S(z,{label:"已拒绝",value:"rejected"})]),_:1},8,["modelValue"]),S(be,{modelValue:ae.keyword,"onUpdate:modelValue":j[1]||(j[1]=e=>ae.keyword=e),placeholder:"搜索用户",clearable:"",style:{width:"180px"}},null,8,["modelValue"]),S(ge,{type:"primary",onClick:me},{default:$(()=>[...j[17]||(j[17]=[M("查询",-1)])]),_:1})]),I((D(),F(ke,{data:ee.value,stripe:"",border:""},{default:$(()=>[S(ye,{prop:"id",label:"ID",width:"60"}),S(ye,{label:"申请人",width:"180"},{default:$(({row:e})=>[U("div",P,[S(we,{size:36,src:e.avatar},null,8,["src"]),U("div",R,[U("span",q,G(e.nickname||e.username),1),U("span",A,"ID: "+G(e.user_id),1)])])]),_:1}),S(ye,{prop:"real_name",label:"真实姓名",width:"100"}),S(ye,{prop:"phone",label:"联系电话",width:"130"}),S(ye,{prop:"introduction",label:"个人介绍","min-width":"200","show-overflow-tooltip":""}),S(ye,{prop:"status",label:"状态",width:"100",align:"center"},{default:$(({row:e})=>[S(he,{type:pe(e.status),size:"small"},{default:$(()=>[M(G(ue(e.status)),1)]),_:2},1032,["type"])]),_:1}),S(ye,{prop:"created_at",label:"申请时间",width:"160"},{default:$(({row:e})=>[M(G(ce(e.created_at)),1)]),_:1}),S(ye,{label:"操作",width:"180",fixed:"right",align:"center"},{default:$(({row:e})=>["pending"===e.status?(D(),x(E,{key:0},[S(ge,{type:"success",size:"small",onClick:l=>(async e=>{try{await k.confirm("确定通过此创作者申请?","提示"),await a.post(`/admin/creator-applications/${e.id}/approve`),V.success("已通过"),await me()}catch(l){}})(e)},{default:$(()=>[...j[18]||(j[18]=[M("通过",-1)])]),_:1},8,["onClick"]),S(ge,{type:"danger",size:"small",onClick:a=>{return l=e,se.app=l,se.reason="",void(se.visible=!0);var l}},{default:$(()=>[...j[19]||(j[19]=[M("拒绝",-1)])]),_:1},8,["onClick"])],64)):H("",!0),S(ge,{size:"small",onClick:a=>{return l=e,oe.app=l,void(oe.visible=!0);var l}},{default:$(()=>[...j[20]||(j[20]=[M("详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Fe,Z.value]]),S(Ve,{"current-page":le.page,"onUpdate:currentPage":j[2]||(j[2]=e=>le.page=e),"page-size":le.pageSize,total:le.total,layout:"total, prev, pager, next",onCurrentChange:me,class:"pagination"},null,8,["current-page","page-size","total"])]),_:1}),S(je,{label:"创作者列表",name:"creators"},{default:$(()=>[U("div",J,[S(be,{modelValue:ie.keyword,"onUpdate:modelValue":j[3]||(j[3]=e=>ie.keyword=e),placeholder:"搜索创作者",clearable:"",style:{width:"180px"}},null,8,["modelValue"]),S(C,{modelValue:ie.verified,"onUpdate:modelValue":j[4]||(j[4]=e=>ie.verified=e),placeholder:"认证状态",clearable:"",style:{width:"120px"}},{default:$(()=>[S(z,{label:"已认证",value:!0}),S(z,{label:"未认证",value:!1})]),_:1},8,["modelValue"]),S(ge,{type:"primary",onClick:ve},{default:$(()=>[...j[21]||(j[21]=[M("查询",-1)])]),_:1})]),S(ke,{data:te.value,stripe:"",border:""},{default:$(()=>[S(ye,{prop:"id",label:"ID",width:"60"}),S(ye,{label:"创作者",width:"200"},{default:$(({row:e})=>[U("div",N,[S(we,{size:40,src:e.avatar},null,8,["src"]),U("div",O,[U("span",T,G(e.display_name||e.nickname),1),U("span",X,"Lv."+G(e.creator_level),1)])])]),_:1}),S(ye,{label:"认证",width:"100",align:"center"},{default:$(({row:e})=>[e.is_verified?(D(),F(he,{key:0,type:"success",size:"small"},{default:$(()=>[...j[22]||(j[22]=[M("已认证",-1)])]),_:1})):(D(),F(he,{key:1,type:"info",size:"small"},{default:$(()=>[...j[23]||(j[23]=[M("未认证",-1)])]),_:1}))]),_:1}),S(ye,{prop:"total_videos",label:"视频数",width:"90",align:"center"}),S(ye,{prop:"total_followers",label:"粉丝数",width:"100",align:"center"}),S(ye,{label:"总收益",width:"120",align:"right"},{default:$(({row:e})=>[U("span",Y,G(e.total_coins_earned),1)]),_:1}),S(ye,{label:"可提现",width:"120",align:"right"},{default:$(({row:e})=>[U("span",B,G(e.available_coins),1)]),_:1}),S(ye,{label:"分成比例",width:"100",align:"center"},{default:$(({row:e})=>[M(G((100*(1-e.platform_share_ratio)).toFixed(0))+"% ",1)]),_:1}),S(ye,{label:"状态",width:"80",align:"center"},{default:$(({row:e})=>[e.is_banned?(D(),F(he,{key:0,type:"danger",size:"small"},{default:$(()=>[...j[24]||(j[24]=[M("封禁",-1)])]),_:1})):e.is_active?(D(),F(he,{key:1,type:"success",size:"small"},{default:$(()=>[...j[25]||(j[25]=[M("正常",-1)])]),_:1})):(D(),F(he,{key:2,type:"info",size:"small"},{default:$(()=>[...j[26]||(j[26]=[M("停用",-1)])]),_:1}))]),_:1}),S(ye,{label:"操作",width:"150",fixed:"right",align:"center"},{default:$(({row:e})=>[S(ge,{size:"small",onClick:a=>{return l=e,de.creator=l,ne.value={creator_level:l.creator_level,is_verified:l.is_verified,verification_type:l.verification_type||"personal",creator_share:Math.round(100*(1-l.platform_share_ratio))},void(de.visible=!0);var l}},{default:$(()=>[...j[27]||(j[27]=[M("编辑",-1)])]),_:1},8,["onClick"]),e.is_banned?(D(),F(ge,{key:1,size:"small",type:"success",onClick:l=>(async e=>{try{await k.confirm("确定解除封禁?","提示"),await a.post(`/admin/creators/${e.id}/unban`),V.success("已解封"),await ve()}catch(l){}})(e)},{default:$(()=>[...j[29]||(j[29]=[M("解封",-1)])]),_:1},8,["onClick"])):(D(),F(ge,{key:0,size:"small",type:"danger",onClick:l=>(async e=>{try{await k.prompt("请输入封禁原因","封禁创作者",{type:"warning"}).then(async({value:l})=>{await a.post(`/admin/creators/${e.id}/ban`,{reason:l}),V.success("已封禁"),await ve()})}catch(l){}})(e)},{default:$(()=>[...j[28]||(j[28]=[M("封禁",-1)])]),_:1},8,["onClick"]))]),_:1})]),_:1},8,["data"]),S(Ve,{"current-page":re.page,"onUpdate:currentPage":j[5]||(j[5]=e=>re.page=e),"page-size":re.pageSize,total:re.total,layout:"total, prev, pager, next",onCurrentChange:ve,class:"pagination"},null,8,["current-page","page-size","total"])]),_:1})]),_:1},8,["modelValue"]),S(Ce,{modelValue:se.visible,"onUpdate:modelValue":j[9]||(j[9]=e=>se.visible=e),title:"拒绝申请",width:"400px"},{footer:$(()=>[S(ge,{onClick:j[8]||(j[8]=e=>se.visible=!1)},{default:$(()=>[...j[30]||(j[30]=[M("取消",-1)])]),_:1}),S(ge,{type:"danger",onClick:_e},{default:$(()=>[...j[31]||(j[31]=[M("确认拒绝",-1)])]),_:1})]),default:$(()=>[S(be,{modelValue:se.reason,"onUpdate:modelValue":j[7]||(j[7]=e=>se.reason=e),type:"textarea",rows:"4",placeholder:"请输入拒绝原因"},null,8,["modelValue"])]),_:1},8,["modelValue"]),S(Ce,{modelValue:oe.visible,"onUpdate:modelValue":j[10]||(j[10]=e=>oe.visible=e),title:"申请详情",width:"500px"},{default:$(()=>[oe.app?(D(),F(Ue,{key:0,column:1,border:""},{default:$(()=>[S(xe,{label:"用户ID"},{default:$(()=>[M(G(oe.app.user_id),1)]),_:1}),S(xe,{label:"用户名"},{default:$(()=>[M(G(oe.app.username),1)]),_:1}),S(xe,{label:"真实姓名"},{default:$(()=>[M(G(oe.app.real_name),1)]),_:1}),S(xe,{label:"联系电话"},{default:$(()=>[M(G(oe.app.phone),1)]),_:1}),S(xe,{label:"邮箱"},{default:$(()=>[M(G(oe.app.email||"-"),1)]),_:1}),S(xe,{label:"擅长领域"},{default:$(()=>[M(G(oe.app.expertise||"-"),1)]),_:1}),S(xe,{label:"个人介绍"},{default:$(()=>[M(G(oe.app.introduction),1)]),_:1}),S(xe,{label:"申请时间"},{default:$(()=>[M(G(ce(oe.app.created_at)),1)]),_:1}),S(xe,{label:"状态"},{default:$(()=>[S(he,{type:pe(oe.app.status)},{default:$(()=>[M(G(ue(oe.app.status)),1)]),_:1},8,["type"])]),_:1}),oe.app.reject_reason?(D(),F(xe,{key:0,label:"拒绝原因"},{default:$(()=>[M(G(oe.app.reject_reason),1)]),_:1})):H("",!0)]),_:1})):H("",!0)]),_:1},8,["modelValue"]),S(Ce,{modelValue:de.visible,"onUpdate:modelValue":j[16]||(j[16]=e=>de.visible=e),title:"编辑创作者",width:"450px"},{footer:$(()=>[S(ge,{onClick:j[15]||(j[15]=e=>de.visible=!1)},{default:$(()=>[...j[32]||(j[32]=[M("取消",-1)])]),_:1}),S(ge,{type:"primary",onClick:fe},{default:$(()=>[...j[33]||(j[33]=[M("保存",-1)])]),_:1})]),default:$(()=>[de.visible?(D(),F(Me,{key:0,model:ne.value,"label-width":"100px"},{default:$(()=>[S($e,{label:"创作者等级"},{default:$(()=>[S(Se,{modelValue:ne.value.creator_level,"onUpdate:modelValue":j[11]||(j[11]=e=>ne.value.creator_level=e),min:1,max:10},null,8,["modelValue"])]),_:1}),S($e,{label:"认证状态"},{default:$(()=>[S(De,{modelValue:ne.value.is_verified,"onUpdate:modelValue":j[12]||(j[12]=e=>ne.value.is_verified=e)},null,8,["modelValue"])]),_:1}),ne.value.is_verified?(D(),F($e,{key:0,label:"认证类型"},{default:$(()=>[S(C,{modelValue:ne.value.verification_type,"onUpdate:modelValue":j[13]||(j[13]=e=>ne.value.verification_type=e)},{default:$(()=>[S(z,{label:"个人认证",value:"personal"}),S(z,{label:"企业认证",value:"company"}),S(z,{label:"官方认证",value:"official"})]),_:1},8,["modelValue"])]),_:1})):H("",!0),S($e,{label:"分成比例"},{default:$(()=>[S(Ie,{modelValue:ne.value.creator_share,"onUpdate:modelValue":j[14]||(j[14]=e=>ne.value.creator_share=e),min:50,max:90,"format-tooltip":e=>e+"%"},null,8,["modelValue","format-tooltip"]),U("span",Q,"创作者获得 "+G(ne.value.creator_share)+"%，平台抽成 "+G(100-ne.value.creator_share)+"%",1)]),_:1})]),_:1},8,["model"])):H("",!0)]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-9016f93b"]]);export{W as default};
