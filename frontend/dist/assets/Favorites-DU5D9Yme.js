import{r as e,c as a,w as l,j as s,y as t,C as i,I as o,L as c,M as u,aa as v,H as n,aC as r,z as p,U as d,u as k}from"./vue-vendor-Ba_vealp.js";import{_ as g}from"./ic_back-BPdSG6fy.js";import{_ as m}from"./no_data-CMy5glMK.js";import{_ as y,u as h,a as b}from"./index-C3P4JTuA.js";import{g as _}from"./avatar-DXHBWedi.js";import{E as f}from"./element-plus-DlIn_qXi.js";import"./utils-DflAyOWx.js";const C={class:"favorites-page"},w={class:"page-header"},x={class:"tabs-wrapper"},$={class:"tabs"},j=["onClick"],z={class:"content"},L={key:0,class:"loading-state"},M=["onClick"],B=["onClick"],I={key:0,viewBox:"0 0 24 24",fill:"currentColor"},E={class:"post-header"},F=["src"],H={class:"post-nickname"},O={class:"post-content"},U={key:1,class:"post-images"},q=["src"],A={class:"post-stats"},D={key:0,class:"post-topic-tag"},G=["onClick"],J=["onClick"],K={key:0,viewBox:"0 0 24 24",fill:"currentColor"},N={class:"thumbnail"},P=["src"],Q={key:0,class:"duration"},R={key:1,class:"duration"},S={key:2,class:"duration"},T={key:3,class:"short-tag"},V={key:4,class:"status-tag"},W={class:"title"},X={key:1,class:"author"},Y={key:2,class:"empty-state"},Z={key:0,class:"bottom-bar"},ee={key:0,viewBox:"0 0 24 24",fill:"currentColor"},ae=y({__name:"Favorites",setup(y){const ae=r(),le=h(),se=[{key:"video",label:"å½±è§†"},{key:"short",label:"çŸ­è§†é¢‘"},{key:"gallery",label:"å›¾é›†"},{key:"novel",label:"å°è¯´"},{key:"post",label:"å¸–å­"}],te=e("video"),ie=e(!1),oe=e([]),ce=e([]),ue=e(!1),ve=e(1),ne=e(!0),re=a(()=>ce.value.length>0&&oe.value.length===ce.value.length),pe=async(e=!1)=>{if(!ue.value&&(e||ne.value)){ue.value=!0;try{let a;e&&(ve.value=1,ce.value=[]),a="gallery"===te.value?await b.get("/gallery-novel/user/collected/galleries",{params:{page:ve.value,page_size:20}}):"novel"===te.value?await b.get("/gallery-novel/user/collected/novels",{params:{page:ve.value,page_size:20}}):"post"===te.value?await b.get("/community/user/collected/posts",{params:{page:ve.value,page_size:20}}):await b.get("/videos/user/collected",{params:{page:ve.value,page_size:20,video_type:te.value}});const l=a.data||a;l.items&&l.items.length>0?(ce.value=e?l.items:[...ce.value,...l.items],ne.value=l.has_more,ve.value++):ne.value=!1}catch(a){}finally{ue.value=!1}}},de=()=>{ie.value=!ie.value,ie.value||(oe.value=[])},ke=e=>{const a=oe.value.indexOf(e.id);a>-1?oe.value.splice(a,1):oe.value.push(e.id)},ge=()=>{re.value?oe.value=[]:oe.value=ce.value.map(e=>e.id)},me=async()=>{if(0!==oe.value.length)try{for(const e of oe.value)"gallery"===te.value?await b.post(`/gallery-novel/gallery/${e}/collect`):"novel"===te.value?await b.post(`/gallery-novel/novel/${e}/collect`):"post"===te.value?await b.post(`/community/posts/${e}/collect`):await b.post(`/videos/${e}/favorite`);ce.value=ce.value.filter(e=>!oe.value.includes(e.id)),oe.value=[],f.success("åˆ é™¤æˆåŠŸ")}catch(e){f.error("åˆ é™¤å¤±è´¥")}else f.warning("è¯·é€‰æ‹©è¦åˆ é™¤çš„é¡¹ç›®")},ye=e=>{ie.value?ke(e):"gallery"===te.value?ae.push(`/gallery/${e.id}`):"novel"===te.value?ae.push(`/novel/${e.id}`):"post"===te.value?ae.push(`/user/community/post/${e.id}`):e.is_short?ae.push(`/shorts/${e.id}`):ae.push(`/user/video/${e.id}`)};return l(te,()=>{oe.value=[],ie.value=!1,pe(!0)}),l(()=>le.token,e=>{e&&pe(!0)}),s(()=>{le.token&&pe(!0)}),(e,a)=>(p(),t("div",C,[i("header",w,[i("div",{class:"back-btn",onClick:a[0]||(a[0]=a=>e.$router.back())},[...a[1]||(a[1]=[i("img",{src:g,alt:"è¿”å›ž",class:"back-icon"},null,-1)])]),a[2]||(a[2]=i("h1",{class:"page-title"},"æˆ‘çš„æ”¶è—",-1)),i("div",{class:"header-right",onClick:de},c(ie.value?"å®Œæˆ":"ç¼–è¾‘"),1)]),i("div",x,[i("div",$,[(p(),t(u,null,v(se,e=>i("div",{key:e.key,class:n(["tab-item",{active:te.value===e.key}]),onClick:a=>te.value=e.key},c(e.label),11,j)),64))])]),i("div",z,[ue.value&&0===ce.value.length?(p(),t("div",L,[...a[3]||(a[3]=[i("p",null,"åŠ è½½ä¸­...",-1)])])):ce.value.length>0?(p(),t("div",{key:1,class:n(["favorites-grid",{"post-list":"post"===te.value}])},["post"===te.value?(p(!0),t(u,{key:0},v(ce.value,e=>(p(),t("div",{key:e.id,class:"post-item",onClick:a=>ye(e)},[ie.value?(p(),t("div",{key:0,class:"checkbox",onClick:d(a=>ke(e),["stop"])},[i("div",{class:n(["check-box",{checked:oe.value.includes(e.id)}])},[oe.value.includes(e.id)?(p(),t("svg",I,[...a[4]||(a[4]=[i("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},null,-1)])])):o("",!0)],2)],8,B)):o("",!0),i("div",E,[i("img",{src:k(_)(e.user_avatar,e.user_id),class:"post-avatar"},null,8,F),i("span",H,c(e.user_nickname),1)]),i("p",O,c(e.content),1),e.images&&e.images.length>0?(p(),t("div",U,[(p(!0),t(u,null,v(e.images.slice(0,3),(e,a)=>(p(),t("img",{key:a,src:e,class:"post-img"},null,8,q))),128))])):o("",!0),i("div",A,[i("span",null,"â¤ï¸ "+c(e.like_count||0),1),i("span",null,"ðŸ’¬ "+c(e.comment_count||0),1),e.topics&&e.topics.length?(p(),t("span",D,"#"+c(e.topics[0].name),1)):o("",!0)])],8,M))),128)):(p(!0),t(u,{key:1},v(ce.value,e=>(p(),t("div",{key:e.id,class:"favorite-item",onClick:a=>ye(e)},[ie.value?(p(),t("div",{key:0,class:"checkbox",onClick:d(a=>ke(e),["stop"])},[i("div",{class:n(["check-box",{checked:oe.value.includes(e.id)}])},[oe.value.includes(e.id)?(p(),t("svg",K,[...a[5]||(a[5]=[i("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},null,-1)])])):o("",!0)],2)],8,J)):o("",!0),i("div",N,[i("img",{src:e.thumbnail||e.cover||"/images/backgrounds/no_data.webp",alt:""},null,8,P),"video"===te.value||"short"===te.value?(p(),t("span",Q,c(e.duration),1)):o("",!0),"gallery"===te.value?(p(),t("span",R,c(e.image_count)+"å¼ ",1)):o("",!0),"novel"===te.value?(p(),t("span",S,c(e.chapter_count)+"ç« ",1)):o("",!0),e.is_short?(p(),t("span",T,"çŸ­è§†é¢‘")):o("",!0),"gallery"===te.value||"novel"===te.value?(p(),t("span",V,c(e.status),1)):o("",!0)]),i("h3",W,c(e.title),1),"novel"===te.value&&e.author?(p(),t("p",X,c(e.author),1)):o("",!0)],8,G))),128))],2)):(p(),t("div",Y,[...a[6]||(a[6]=[i("img",{src:m,alt:""},null,-1),i("p",null,"å½“å‰é¡µé¢æš‚æ— å†…å®¹ï½ž",-1)])]))]),ie.value&&ce.value.length>0?(p(),t("div",Z,[i("div",{class:"select-all",onClick:ge},[i("div",{class:n(["check-box",{checked:re.value}])},[re.value?(p(),t("svg",ee,[...a[7]||(a[7]=[i("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},null,-1)])])):o("",!0)],2),a[8]||(a[8]=i("span",null,"å…¨é€‰",-1))]),i("button",{class:"delete-btn",onClick:me},"åˆ é™¤")])):o("",!0)]))}},[["__scopeId","data-v-facd33ea"]]);export{ae as default};
