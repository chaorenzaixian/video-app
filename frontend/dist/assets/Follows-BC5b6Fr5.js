import{r as a,c as s,j as l,y as e,C as i,H as o,K as t,L as c,M as n,aa as r,aC as u,z as v,I as d,U as p}from"./vue-vendor-Ba_vealp.js";import{_ as g}from"./ic_back-BPdSG6fy.js";import{_ as m}from"./no_data-CMy5glMK.js";import{_ as w,a as b}from"./index-C3P4JTuA.js";import{E as f}from"./element-plus-DlIn_qXi.js";import"./utils-DflAyOWx.js";const k={class:"follows-page"},_={class:"page-header"},y={class:"tabs"},h={class:"count"},C={class:"count"},j={class:"user-list"},$={key:0,class:"loading-state"},x=["onClick"],I=["src","alt"],M={class:"user-info"},P={class:"user-nickname-row"},z={class:"user-nickname gradient-gold"},E=["src","alt"],F={class:"user-bio"},H=["onClick"],K=["onClick"],L={key:2,class:"empty-state"},U={class:"empty-text"},V=w({__name:"Follows",setup(w){const V=u(),q=a("following"),A=a(!0),B=a([]),D=a([]),G=a(0),J=a(0),N={1:"/images/backgrounds/vip_gold.webp",2:"/images/backgrounds/vip_1.webp",3:"/images/backgrounds/vip_2.webp",4:"/images/backgrounds/vip_3.webp",5:"/images/backgrounds/super_vip_red.webp",6:"/images/backgrounds/super_vip_blue.webp"},O=s(()=>"following"===q.value?B.value:D.value),Q=async()=>{var a;try{const a=await b.get("/creator/following");a.data&&(B.value=a.data.items||[],G.value=a.data.total||0)}catch(s){null==(a=s.response)||a.status,B.value=[],G.value=0}},R=async()=>{var a;try{const a=await b.get("/creator/followers");a.data&&(D.value=a.data.items||[],J.value=a.data.total||0)}catch(s){null==(a=s.response)||a.status,D.value=[],J.value=0}};return l(async()=>{A.value=!0,await Promise.all([Q(),R()]),A.value=!1}),(a,s)=>(v(),e("div",k,[i("header",_,[i("div",{class:"back-btn",onClick:s[0]||(s[0]=s=>a.$router.back())},[...s[3]||(s[3]=[i("img",{src:g,alt:"返回",class:"back-icon"},null,-1)])]),s[4]||(s[4]=i("h1",{class:"page-title"},"关注/粉丝",-1)),s[5]||(s[5]=i("div",{class:"header-right"},null,-1))]),i("div",y,[i("div",{class:o(["tab-item",{active:"following"===q.value}]),onClick:s[1]||(s[1]=a=>q.value="following")},[s[6]||(s[6]=t(" 关注 ",-1)),i("span",h,c(G.value),1)],2),i("div",{class:o(["tab-item",{active:"followers"===q.value}]),onClick:s[2]||(s[2]=a=>q.value="followers")},[s[7]||(s[7]=t(" 粉丝 ",-1)),i("span",C,c(J.value),1)],2)]),i("div",j,[A.value?(v(),e("div",$,[...s[8]||(s[8]=[i("div",{class:"loading-spinner"},null,-1),i("p",null,"加载中...",-1)])])):O.value.length>0?(v(!0),e(n,{key:1},r(O.value,a=>{return v(),e("div",{class:"user-item",key:a.id,onClick:s=>(a=>{V.push(`/user/member/${a.id}`)})(a)},[i("img",{src:a.avatar||(l=a.id,`/images/avatars/${l%114+1}.jpg`),alt:a.nickname,class:"user-avatar"},null,8,I),i("div",M,[i("div",P,[i("span",z,c(a.nickname||"用户"+a.id),1),a.vip_level&&a.vip_level>0?(v(),e("img",{key:0,src:(s=a.vip_level,N[s]||N[1]),class:"vip-badge",alt:`VIP${a.vip_level}`},null,8,E)):d("",!0)]),i("div",F,c(a.bio||"这个人很懒，什么都没写~"),1)]),"following"===q.value?(v(),e("button",{key:0,class:"action-btn following",onClick:p(s=>(async a=>{var s,l;try{await b.delete(`/creator/follow/${a.id}`),B.value=B.value.filter(s=>s.id!==a.id),G.value=Math.max(0,G.value-1),f.success("已取消关注")}catch(e){f.error((null==(l=null==(s=e.response)?void 0:s.data)?void 0:l.detail)||"操作失败")}})(a),["stop"])}," 已关注 ",8,H)):(v(),e("button",{key:1,class:o(["action-btn",{following:a.is_following}]),onClick:p(s=>(async a=>{var s,l;try{a.is_following?(await b.delete(`/users/${a.id}/follow`),a.is_following=!1,f.success("已取消关注")):(await b.post(`/users/${a.id}/follow`),a.is_following=!0,f.success("关注成功"))}catch(e){f.error((null==(l=null==(s=e.response)?void 0:s.data)?void 0:l.detail)||"操作失败")}})(a),["stop"])},c(a.is_following?"已关注":"关注"),11,K))],8,x);var s,l}),128)):(v(),e("div",L,[s[9]||(s[9]=i("img",{src:m,alt:"暂无数据",class:"empty-image"},null,-1)),i("p",U,c("following"===q.value?"还没有关注任何人":"还没有粉丝"),1)]))])]))}},[["__scopeId","data-v-88b9df89"]]);export{V as default};
