import{_ as a}from"./ic_back-BPdSG6fy.js";import{_ as e}from"./no_data-CMy5glMK.js";import{r as s,w as l,j as i,y as t,C as v,O as o,M as c,aa as d,I as n,aC as r,z as u,H as p,L as m,aD as k}from"./vue-vendor-Ba_vealp.js";import{_ as y,a as f}from"./index-C3P4JTuA.js";import{B as b}from"./BottomNav-CoGs_HZ2.js";import"./element-plus-DlIn_qXi.js";import"./utils-DflAyOWx.js";const h={class:"purchase-page"},g={class:"page-header"},_={class:"category-tabs"},j=["onClick"],C={class:"content-area"},w={key:0,class:"video-list double-column"},$={key:1,class:"empty-state"},D={key:2,class:"video-list double-column"},x=["onClick"],z={class:"video-cover"},M=["src","alt"],B={class:"cover-views"},H={key:0,class:"video-duration"},I={class:"video-info"},S={class:"video-title"},L={class:"video-meta"},N={class:"purchase-time"},O={key:0},P={key:1},W=y({__name:"PurchaseHistory",setup(y){const W=r(),q=[{key:"video",label:"å½±è§†"},{key:"douyin",label:"æŠ–éŸ³"},{key:"post",label:"å¸–å­"},{key:"comic",label:"æ¼«ç”»"},{key:"anime",label:"åŠ¨æ¼«"},{key:"album",label:"å›¾é›†"},{key:"novel",label:"å°è¯´"}],A=s("video"),E=s([]),F=s(!1),G=s(!1),J=s(1),K=s(!1),Q=async(a=!1)=>{var e;a?G.value=!0:(F.value=!0,J.value=1);try{const s=await f.get("/coins/purchases",{params:{type:A.value,page:J.value,page_size:20}}),l=s.data||s;E.value=a?[...E.value,...l.items||[]]:l.items||[],K.value=((null==(e=l.items)?void 0:e.length)||0)>=20}catch(s){E.value=[]}finally{F.value=!1,G.value=!1}},R=()=>{!G.value&&K.value&&(J.value++,Q(!0))},T=a=>{if(!a)return"";return`${Math.floor(a/60)}:${(a%60).toString().padStart(2,"0")}`},U=a=>{if(!a)return"";const e=new Date(a),s=new Date-e;return s<864e5?"ä»Šå¤©":s<1728e5?"æ˜¨å¤©":`${e.getMonth()+1}/${e.getDate()}`};return l(A,()=>{Q()}),i(()=>{Q()}),(s,l)=>(u(),t("div",h,[v("header",g,[v("div",{class:"back-btn",onClick:l[0]||(l[0]=a=>s.$router.back())},[...l[1]||(l[1]=[v("img",{src:a,alt:"è¿”å›",class:"back-icon"},null,-1)])]),l[2]||(l[2]=v("h1",null,"æˆ‘çš„è´­ä¹°",-1)),l[3]||(l[3]=v("div",{class:"placeholder"},null,-1))]),v("div",_,[(u(),t(c,null,d(q,a=>v("div",{key:a.key,class:p(["tab-item",{active:A.value===a.key}]),onClick:e=>A.value=a.key},m(a.label),11,j)),64))]),v("div",C,[F.value?(u(),t("div",w,[(u(),t(c,null,d(6,a=>v("div",{key:"skeleton-"+a,class:"video-card skeleton"},[...l[4]||(l[4]=[k('<div class="video-cover" data-v-a04f58f4><div class="skeleton-shimmer" data-v-a04f58f4></div></div><div class="video-info" data-v-a04f58f4><div class="skeleton-title" data-v-a04f58f4></div><div class="skeleton-meta" data-v-a04f58f4></div></div>',2)])])),64))])):E.value.length?(u(),t("div",D,[(u(!0),t(c,null,d(E.value,a=>{return u(),t("div",{key:a.id,class:"video-card",onClick:e=>(a=>{"video"===A.value&&W.push(`/user/video/${a.video_id||a.id}`)})(a)},[v("div",z,[v("img",{src:(e=a.cover_url,e?(e.startsWith("http"),e):"/images/default-cover.webp"),alt:a.title,loading:"lazy"},null,8,M),v("div",B,[l[6]||(l[6]=v("span",{class:"coin-icon"},"ğŸª™",-1)),v("span",null,m(a.price),1)]),a.duration?(u(),t("div",H,m(T(a.duration)),1)):n("",!0)]),v("div",I,[v("p",S,m(a.title),1),v("div",L,[l[7]||(l[7]=v("span",{class:"video-tag"},"å·²è´­ä¹°",-1)),v("span",N,m(U(a.purchased_at)),1)])])],8,x);var e}),128))])):(u(),t("div",$,[...l[5]||(l[5]=[v("img",{src:e,alt:"æš‚æ— å†…å®¹",class:"empty-icon"},null,-1),v("p",{class:"empty-text"},"å½“å‰é¡µé¢æš‚æ— å†…å®¹ï½",-1)])])),E.value.length&&K.value?(u(),t("div",{key:3,class:"load-more",onClick:R},[G.value?(u(),t("span",O,"åŠ è½½ä¸­...")):(u(),t("span",P,"åŠ è½½æ›´å¤š"))])):n("",!0)]),o(b)]))}},[["__scopeId","data-v-a04f58f4"]]);export{W as default};
