import{r as a,w as e,j as l,az as s,y as t,C as i,I as v,O as n,M as o,aa as c,L as u,aC as r,z as d,H as p,aD as y}from"./vue-vendor-Ba_vealp.js";import{_ as g,a as m}from"./index-C3P4JTuA.js";import{S as k}from"./SearchHeader-hqKygmDY.js";import"./element-plus-DlIn_qXi.js";import"./utils-DflAyOWx.js";import"./ic_back-BPdSG6fy.js";const h={class:"search-result-page"},w={class:"sticky-top-area"},f={class:"category-tabs"},_=["onClick"],b={class:"result-title"},C={class:"keyword-highlight"},S={key:0,class:"video-section"},$={key:0,class:"video-list double-column"},j={key:1,class:"empty-videos"},z={key:2,class:"video-list double-column"},M=["onClick"],x={class:"video-cover"},D=["src","alt"],q={class:"cover-views"},I={class:"video-duration"},H={key:0,class:"vip-tag"},L={class:"video-info"},F={class:"video-title"},O={class:"video-meta"},P={class:"video-tag"},R={class:"video-comments"},U={key:1,class:"video-section"},V={key:0,class:"loading-state"},W={key:1,class:"empty-videos"},A={key:2,class:"video-list double-column"},B=["onClick"],E={class:"video-cover vertical"},G=["src","alt"],J={class:"cover-views"},K={class:"video-info"},N={class:"video-title"},Q={key:2,class:"post-section"},T={key:0,class:"loading-state"},X={key:1,class:"empty-videos"},Y={key:2,class:"post-list"},Z=["onClick"],aa={class:"post-header"},ea=["src"],la={class:"post-user-info"},sa={class:"post-username"},ta={class:"post-time"},ia={class:"post-content"},va={key:0,class:"post-images"},na=["src"],oa={class:"post-stats"},ca={key:0,class:"post-topic-tag"},ua={key:3,class:"novel-section"},ra={key:0,class:"loading-state"},da={key:1,class:"empty-videos"},pa={key:2,class:"novel-grid"},ya=["onClick"],ga={class:"novel-cover-wrap"},ma=["src","alt"],ka={key:0,class:"audio-badge"},ha={class:"novel-info"},wa={class:"novel-title"},fa={class:"novel-author"},_a={class:"novel-chapters"},ba={key:4,class:"gallery-section"},Ca={key:0,class:"loading-state"},Sa={key:1,class:"empty-videos"},$a={key:2,class:"gallery-grid"},ja=["onClick"],za={class:"gallery-cover"},Ma=["src","alt"],xa={class:"gallery-info"},Da={class:"views"},qa={class:"count"},Ia={class:"gallery-title"},Ha=g({__name:"SearchResult",setup(g){const Ha=r(),La=s();a("search");const Fa=a(""),Oa=a(0),Pa=a(!1),Ra=a([]),Ua=a(!0),Va=a(1),Wa=a([]),Aa=a(!0),Ba=a(1),Ea=a([]),Ga=a(!0),Ja=a(1),Ka=a([]),Na=a(!0),Qa=a(1),Ta=a([]),Xa=a(!0),Ya=a(1),Za=a([{key:"video",label:"è§†é¢‘"},{key:"douyin",label:"æŠ–éŸ³"},{key:"post",label:"å¸–å­"},{key:"novel",label:"å°è¯´"},{key:"gallery",label:"å›¾é›†"}]),ae=a=>a?(a.startsWith("http"),a):"/images/default-cover.webp",ee=a=>a?a>=1e4?(a/1e4).toFixed(1)+"w":a.toString():"0",le=a=>{if(!a)return"00:00";const e=Math.floor(a/3600),l=Math.floor(a%3600/60),s=Math.floor(a%60);return e>0?`${e}:${l.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${l.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`},se=a=>{if(!a)return"";const e=new Date(a),l=(new Date-e)/1e3;return l<60?"åˆšåˆš":l<3600?Math.floor(l/60)+"åˆ†é’Ÿå‰":l<86400?Math.floor(l/3600)+"å°æ—¶å‰":e.toLocaleDateString()},te=async()=>{Fa.value.trim()&&(Va.value=1,Ba.value=1,Ja.value=1,Qa.value=1,Ya.value=1,await ie())},ie=async()=>{const a=Za.value[Oa.value].key;Pa.value=!0;try{switch(a){case"video":await ve();break;case"douyin":await ne();break;case"post":await oe();break;case"novel":await ce();break;case"gallery":await ue()}}finally{Pa.value=!1}},ve=async()=>{var a;if(Fa.value.trim())try{const e=await m.get("/videos",{params:{search:Fa.value.trim(),page:Va.value,page_size:20}}),l=((null==(a=e.data)?void 0:a.items)||e.data||[]).map(a=>({...a,tag:a.category_name||"å›½äº§",comment_count:a.comment_count||0}));Ra.value=1===Va.value?l:[...Ra.value,...l],Ua.value=l.length>=20}catch(e){1===Va.value&&(Ra.value=[])}},ne=async()=>{var a;if(Fa.value.trim())try{const e=await m.get("/short-videos",{params:{search:Fa.value.trim(),page:Ba.value,page_size:20}}),l=(null==(a=e.data)?void 0:a.items)||e.data||[];Wa.value=1===Ba.value?l:[...Wa.value,...l],Aa.value=l.length>=20}catch(e){1===Ba.value&&(Wa.value=[])}},oe=async()=>{if(Fa.value.trim())try{const a=(await m.get("/community/posts",{params:{search:Fa.value.trim(),page:Ja.value,page_size:20}})).data||[];Ea.value=1===Ja.value?a:[...Ea.value,...a],Ga.value=a.length>=20}catch(a){1===Ja.value&&(Ea.value=[])}},ce=async()=>{if(Fa.value.trim())try{const a=(await m.get("/gallery-novel/novel/list",{params:{search:Fa.value.trim(),page:Qa.value,page_size:20}})).data||[];Ka.value=1===Qa.value?a:[...Ka.value,...a],Na.value=a.length>=20}catch(a){1===Qa.value&&(Ka.value=[])}},ue=async()=>{if(Fa.value.trim())try{const a=(await m.get("/gallery-novel/gallery/list",{params:{search:Fa.value.trim(),page:Ya.value,page_size:20}})).data||[];Ta.value=1===Ya.value?a:[...Ta.value,...a],Xa.value=a.length>=20}catch(a){1===Ya.value&&(Ta.value=[])}},re=async()=>{Va.value++,await ve()},de=async()=>{Ba.value++,await ne()},pe=async()=>{Ja.value++,await oe()},ye=async()=>{Qa.value++,await ce()},ge=async()=>{Ya.value++,await ue()};return e(Oa,()=>{ie()}),e(()=>La.query.keyword,a=>{a&&(Fa.value=a,te())},{immediate:!0}),l(()=>{La.query.keyword&&(Fa.value=La.query.keyword,te())}),(a,e)=>(d(),t("div",h,[i("div",w,[n(k,{"current-page":"result","show-search-box":!0,keyword:Fa.value,"onUpdate:keyword":e[0]||(e[0]=a=>Fa.value=a),placeholder:"",onSearch:te},null,8,["keyword"]),i("div",f,[(d(!0),t(o,null,c(Za.value,(a,e)=>(d(),t("span",{key:a.key,class:p(["category-tab",{active:Oa.value===e}]),onClick:a=>Oa.value=e},u(a.label),11,_))),128))])]),i("div",b,[i("span",C,u(Fa.value),1),e[1]||(e[1]=i("span",{class:"title-suffix"},"æ ‡ç­¾å†…å®¹",-1))]),0===Oa.value?(d(),t("div",S,[Pa.value&&0===Ra.value.length?(d(),t("div",$,[(d(),t(o,null,c(6,a=>i("div",{key:"skeleton-"+a,class:"video-card skeleton"},[...e[2]||(e[2]=[y('<div class="video-cover skeleton-cover" data-v-4473b53f><div class="skeleton-shimmer" data-v-4473b53f></div></div><div class="video-info" data-v-4473b53f><div class="skeleton-title" data-v-4473b53f></div><div class="skeleton-meta" data-v-4473b53f></div></div>',2)])])),64))])):Pa.value||0!==Ra.value.length?(d(),t("div",z,[(d(!0),t(o,null,c(Ra.value,a=>(d(),t("div",{key:a.id,class:"video-card",onClick:e=>{return l=a.id,Ha.push(`/user/video/${l}`);var l}},[i("div",x,[i("img",{src:ae(a.cover_url),alt:a.title},null,8,D),i("div",q,[e[4]||(e[4]=i("span",{class:"play-icon"},"â–¶",-1)),i("span",null,u(ee(a.view_count)),1)]),i("div",I,u(le(a.duration)),1),a.is_vip_only?(d(),t("div",H,"VIP")):v("",!0)]),i("div",L,[i("p",F,u(a.title),1),i("div",O,[i("span",P,u(a.tag||"ç²¾é€‰"),1),i("span",R,"è¯„è®º "+u(a.comment_count||0),1)])])],8,M))),128))])):(d(),t("div",j,[...e[3]||(e[3]=[i("span",null,"æš‚æ— æœç´¢ç»“æœ",-1)])])),Ra.value.length&&Ua.value?(d(),t("div",{key:3,class:"view-more-btn",onClick:re},[...e[5]||(e[5]=[i("span",null,"æŸ¥çœ‹æ›´å¤š",-1),i("span",{class:"arrow"},"â€º",-1)])])):v("",!0)])):v("",!0),1===Oa.value?(d(),t("div",U,[Pa.value&&0===Wa.value.length?(d(),t("div",V,"åŠ è½½ä¸­...")):Pa.value||0!==Wa.value.length?(d(),t("div",A,[(d(!0),t(o,null,c(Wa.value,a=>(d(),t("div",{key:a.id,class:"video-card",onClick:e=>{return l=a.id,Ha.push(`/user/short-video/${l}`);var l}},[i("div",E,[i("img",{src:ae(a.cover_url),alt:a.title},null,8,G),i("div",J,[e[7]||(e[7]=i("span",{class:"play-icon"},"â–¶",-1)),i("span",null,u(ee(a.view_count)),1)])]),i("div",K,[i("p",N,u(a.title),1)])],8,B))),128))])):(d(),t("div",W,[...e[6]||(e[6]=[i("span",null,"æš‚æ— æœç´¢ç»“æœ",-1)])])),Wa.value.length&&Aa.value?(d(),t("div",{key:3,class:"view-more-btn",onClick:de},[...e[8]||(e[8]=[i("span",null,"æŸ¥çœ‹æ›´å¤š",-1),i("span",{class:"arrow"},"â€º",-1)])])):v("",!0)])):v("",!0),2===Oa.value?(d(),t("div",Q,[Pa.value&&0===Ea.value.length?(d(),t("div",T,"åŠ è½½ä¸­...")):Pa.value||0!==Ea.value.length?(d(),t("div",Y,[(d(!0),t(o,null,c(Ea.value,a=>{var e,l;return d(),t("div",{key:a.id,class:"post-card",onClick:e=>{return l=a.id,Ha.push(`/user/community/post/${l}`);var l}},[i("div",aa,[i("img",{src:(null==(e=a.user)?void 0:e.avatar)||"/images/avatars/icon_avatar_1.webp",class:"post-avatar"},null,8,ea),i("div",la,[i("span",sa,u((null==(l=a.user)?void 0:l.nickname)||"ç”¨æˆ·"),1),i("span",ta,u(se(a.created_at)),1)])]),i("p",ia,u(a.content),1),a.images&&a.images.length?(d(),t("div",va,[(d(!0),t(o,null,c(a.images.slice(0,3),(a,e)=>(d(),t("img",{key:e,src:a,class:"post-img"},null,8,na))),128))])):v("",!0),i("div",oa,[i("span",null,"ğŸ‘ "+u(ee(a.view_count)),1),i("span",null,"ğŸ’¬ "+u(a.comment_count||0),1),i("span",null,"â¤ï¸ "+u(ee(a.like_count)),1),a.topics&&a.topics.length?(d(),t("span",ca,"#"+u(a.topics[0].name),1)):v("",!0)])],8,Z)}),128))])):(d(),t("div",X,[...e[9]||(e[9]=[i("span",null,"æš‚æ— æœç´¢ç»“æœ",-1)])])),Ea.value.length&&Ga.value?(d(),t("div",{key:3,class:"view-more-btn",onClick:pe},[...e[10]||(e[10]=[i("span",null,"æŸ¥çœ‹æ›´å¤š",-1),i("span",{class:"arrow"},"â€º",-1)])])):v("",!0)])):v("",!0),3===Oa.value?(d(),t("div",ua,[Pa.value&&0===Ka.value.length?(d(),t("div",ra,"åŠ è½½ä¸­...")):Pa.value||0!==Ka.value.length?(d(),t("div",pa,[(d(!0),t(o,null,c(Ka.value,a=>(d(),t("div",{key:a.id,class:"novel-item",onClick:e=>(a=>{"audio"===a.novel_type?Ha.push(`/user/audio-novel/${a.id}`):Ha.push(`/user/novel/${a.id}`)})(a)},[i("div",ga,[i("img",{src:a.cover,alt:a.title,class:"novel-cover"},null,8,ma),"audio"===a.novel_type?(d(),t("span",ka,"ğŸ§")):v("",!0)]),i("div",ha,[i("p",wa,u(a.title),1),i("p",fa,u(a.author||"ä½šå"),1),i("p",_a,"å…±"+u(a.chapter_count)+"ç« ",1)])],8,ya))),128))])):(d(),t("div",da,[...e[11]||(e[11]=[i("span",null,"æš‚æ— æœç´¢ç»“æœ",-1)])])),Ka.value.length&&Na.value?(d(),t("div",{key:3,class:"view-more-btn",onClick:ye},[...e[12]||(e[12]=[i("span",null,"æŸ¥çœ‹æ›´å¤š",-1),i("span",{class:"arrow"},"â€º",-1)])])):v("",!0)])):v("",!0),4===Oa.value?(d(),t("div",ba,[Pa.value&&0===Ta.value.length?(d(),t("div",Ca,"åŠ è½½ä¸­...")):Pa.value||0!==Ta.value.length?(d(),t("div",$a,[(d(!0),t(o,null,c(Ta.value,a=>(d(),t("div",{key:a.id,class:"gallery-item",onClick:e=>{return l=a.id,Ha.push(`/user/gallery/${l}`);var l}},[i("div",za,[i("img",{src:a.cover,alt:a.title},null,8,Ma),i("div",xa,[i("span",Da,"ğŸ‘ "+u(ee(a.view_count)),1),i("span",qa,"ğŸ“· "+u(a.image_count),1)])]),i("p",Ia,u(a.title),1)],8,ja))),128))])):(d(),t("div",Sa,[...e[13]||(e[13]=[i("span",null,"æš‚æ— æœç´¢ç»“æœ",-1)])])),Ta.value.length&&Xa.value?(d(),t("div",{key:3,class:"view-more-btn",onClick:ge},[...e[14]||(e[14]=[i("span",null,"æŸ¥çœ‹æ›´å¤š",-1),i("span",{class:"arrow"},"â€º",-1)])])):v("",!0)])):v("",!0)]))}},[["__scopeId","data-v-4473b53f"]]);export{Ha as default};
