/* empty css             *//* empty css                   *//* empty css                   *//* empty css                    *//* empty css                          *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                             */import{_ as e,a}from"./index-C3P4JTuA.js";import{bl as l,aT as t,bD as s,aM as i,bs as o,bt as d,bk as n,bh as r,bm as c,bi as p,bj as u,bB as v,aU as g,E as m}from"./element-plus-DlIn_qXi.js";import{r as b,l as y,j as w,y as f,C as _,O as h,L as k,F as j,G as V,E as x,z,K as C,I as S,M as U}from"./vue-vendor-Ba_vealp.js";import"./utils-DflAyOWx.js";const $={class:"admin-page"},M={class:"stats-row"},R={class:"stat-card pending"},A={class:"stat-info"},D={class:"stat-value"},I={class:"stat-card success"},E={class:"stat-info"},F={class:"stat-value"},G={class:"stat-card danger"},K={class:"stat-info"},T={class:"stat-value"},B={class:"stat-card info"},H={class:"stat-info"},J={class:"stat-value"},L={class:"filter-bar"},O={class:"table-container"},P={class:"video-cell"},q={class:"video-cover"},N=["src"],Q={class:"video-duration"},W={class:"video-detail"},X={class:"video-title"},Y={class:"video-meta"},Z={key:1},ee={key:1,class:"text-gray"},ae={key:0,class:"review-info"},le={key:0,class:"review-note"},te={key:1,class:"text-gray"},se={class:"reject-content"},ie={class:"preview-content"},oe=["src"],de={key:1,class:"preview-info"},ne=e({__name:"VideoReviewManage",setup(e){const ne=b(!1),re=b([]),ce=b({pending:0,todayApproved:0,todayRejected:0,total:0}),pe=y({status:"pending",keyword:"",dateRange:null}),ue=y({page:1,pageSize:15,total:0}),ve=y({visible:!1,review:null,reasons:[],note:""}),ge=y({visible:!1,video:null}),me=e=>({pending:"å¾…å®¡æ ¸",approved:"å·²é€šè¿‡",rejected:"å·²æ‹’ç»",revision:"éœ€ä¿®æ”¹"}[e]||e),be=e=>{if(!e)return"-";const a=new Date(e);return`${a.getMonth()+1}/${a.getDate()} ${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`},ye=e=>{if(!e)return"00:00";const a=Math.floor(e/60),l=Math.floor(e%60);return`${String(a).padStart(2,"0")}:${String(l).padStart(2,"0")}`},we=async()=>{var e,l;ne.value=!0;try{const t=await a.get("/admin/video-reviews",{params:{status:pe.status,keyword:pe.keyword,page:ue.page,page_size:ue.pageSize}});re.value=(null==(e=t.data)?void 0:e.items)||[],ue.total=(null==(l=t.data)?void 0:l.total)||0}catch(t){re.value=[]}finally{ne.value=!1}},fe=()=>{pe.status="pending",pe.keyword="",pe.dateRange=null,ue.page=1,we()},_e=async()=>{if(0!==ve.reasons.length)try{await a.post(`/admin/video-reviews/${ve.review.id}/reject`,{reasons:ve.reasons,note:ve.note}),m.success("å·²æ‹’ç»"),ve.visible=!1,await we()}catch(e){m.error("æ“ä½œå¤±è´¥")}else m.warning("è¯·é€‰æ‹©æ‹’ç»åŽŸå› ")};return w(()=>{we()}),(e,b)=>{const y=c,w=l,he=t,ke=s,je=i,Ve=p,xe=u,ze=r,Ce=d,Se=g,Ue=v,$e=n,Me=o;return z(),f("div",$,[b[26]||(b[26]=_("div",{class:"page-header"},[_("h1",null,"è§†é¢‘å®¡æ ¸"),_("p",{class:"page-desc"},"å®¡æ ¸åˆ›ä½œè€…ä¸Šä¼ çš„è§†é¢‘å†…å®¹ï¼Œé€šè¿‡åŽå‘å¸ƒ")],-1)),_("div",M,[_("div",R,[b[10]||(b[10]=_("div",{class:"stat-icon"},"â³",-1)),_("div",A,[_("span",D,k(ce.value.pending),1),b[9]||(b[9]=_("span",{class:"stat-label"},"å¾…å®¡æ ¸",-1))])]),_("div",I,[b[12]||(b[12]=_("div",{class:"stat-icon"},"âœ…",-1)),_("div",E,[_("span",F,k(ce.value.todayApproved),1),b[11]||(b[11]=_("span",{class:"stat-label"},"ä»Šæ—¥é€šè¿‡",-1))])]),_("div",G,[b[14]||(b[14]=_("div",{class:"stat-icon"},"âŒ",-1)),_("div",K,[_("span",T,k(ce.value.todayRejected),1),b[13]||(b[13]=_("span",{class:"stat-label"},"ä»Šæ—¥æ‹’ç»",-1))])]),_("div",B,[b[16]||(b[16]=_("div",{class:"stat-icon"},"ðŸ“Š",-1)),_("div",H,[_("span",J,k(ce.value.total),1),b[15]||(b[15]=_("span",{class:"stat-label"},"ç´¯è®¡å®¡æ ¸",-1))])])]),_("div",L,[h(w,{modelValue:pe.status,"onUpdate:modelValue":b[0]||(b[0]=e=>pe.status=e),placeholder:"å®¡æ ¸çŠ¶æ€",clearable:"",style:{width:"120px"}},{default:j(()=>[h(y,{label:"å¾…å®¡æ ¸",value:"pending"}),h(y,{label:"å·²é€šè¿‡",value:"approved"}),h(y,{label:"å·²æ‹’ç»",value:"rejected"})]),_:1},8,["modelValue"]),h(he,{modelValue:pe.keyword,"onUpdate:modelValue":b[1]||(b[1]=e=>pe.keyword=e),placeholder:"è§†é¢‘æ ‡é¢˜/ä¸Šä¼ è€…",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),h(ke,{modelValue:pe.dateRange,"onUpdate:modelValue":b[2]||(b[2]=e=>pe.dateRange=e),type:"daterange","start-placeholder":"å¼€å§‹","end-placeholder":"ç»“æŸ",style:{width:"220px"}},null,8,["modelValue"]),h(je,{type:"primary",onClick:we},{default:j(()=>[...b[17]||(b[17]=[C("æŸ¥è¯¢",-1)])]),_:1}),h(je,{onClick:fe},{default:j(()=>[...b[18]||(b[18]=[C("é‡ç½®",-1)])]),_:1})]),_("div",O,[V((z(),x(ze,{data:re.value,stripe:"",border:""},{default:j(()=>[h(Ve,{label:"è§†é¢‘ä¿¡æ¯","min-width":"320"},{default:j(({row:e})=>{var a,l,t,s,i;return[_("div",P,[_("div",q,[_("img",{src:(null==(a=e.video)?void 0:a.cover_url)||"/images/default-cover.webp",alt:""},null,8,N),_("span",Q,k(ye(null==(l=e.video)?void 0:l.duration)),1)]),_("div",W,[_("div",X,k(null==(t=e.video)?void 0:t.title),1),_("div",Y,[_("span",null,"ä¸Šä¼ è€…: "+k(null==(i=null==(s=e.video)?void 0:s.uploader)?void 0:i.nickname),1),_("span",null,"æäº¤: "+k(be(e.submitted_at)),1)])])])]}),_:1}),h(Ve,{label:"ä»˜è´¹è®¾ç½®",width:"120",align:"center"},{default:j(({row:e})=>{var a;return["free"===(null==(a=e.video)?void 0:a.pay_type)?(z(),x(xe,{key:0,type:"success",size:"small"},{default:j(()=>[...b[19]||(b[19]=[C("å…è´¹",-1)])]),_:1})):(z(),f("div",Z,[h(xe,{type:"warning",size:"small"},{default:j(()=>{var a;return[C(k(null==(a=e.video)?void 0:a.coin_price)+"é‡‘å¸",1)]}),_:2},1024)]))]}),_:1}),h(Ve,{label:"AIé¢„å®¡",width:"100",align:"center"},{default:j(({row:e})=>[e.ai_reviewed?(z(),x(xe,{key:0,type:e.ai_score>=80?"success":e.ai_score>=60?"warning":"danger",size:"small"},{default:j(()=>[C(k(e.ai_score)+"åˆ† ",1)]),_:2},1032,["type"])):(z(),f("span",ee,"æœªå®¡æ ¸"))]),_:1}),h(Ve,{label:"çŠ¶æ€",width:"100",align:"center"},{default:j(({row:e})=>{return[h(xe,{type:(a=e.status,{pending:"warning",approved:"success",rejected:"danger"}[a]||"info"),size:"small"},{default:j(()=>[C(k(me(e.status)),1)]),_:2},1032,["type"])];var a}),_:1}),h(Ve,{label:"å®¡æ ¸ä¿¡æ¯",width:"180"},{default:j(({row:e})=>["pending"!==e.status?(z(),f("div",ae,[_("span",null,k(be(e.reviewed_at)),1),e.review_note?(z(),f("span",le,k(e.review_note),1)):S("",!0)])):(z(),f("span",te,"-"))]),_:1}),h(Ve,{label:"æ“ä½œ",width:"200",fixed:"right",align:"center"},{default:j(({row:e})=>["pending"===e.status?(z(),f(U,{key:0},[h(je,{type:"success",size:"small",onClick:l=>(async e=>{try{await a.post(`/admin/video-reviews/${e.id}/approve`),m.success("å®¡æ ¸é€šè¿‡"),await we()}catch(l){m.error("æ“ä½œå¤±è´¥")}})(e)},{default:j(()=>[...b[20]||(b[20]=[C("é€šè¿‡",-1)])]),_:1},8,["onClick"]),h(je,{type:"danger",size:"small",onClick:a=>(e=>{ve.review=e,ve.reasons=[],ve.note="",ve.visible=!0})(e)},{default:j(()=>[...b[21]||(b[21]=[C("æ‹’ç»",-1)])]),_:1},8,["onClick"])],64)):S("",!0),h(je,{size:"small",onClick:a=>(e=>{ge.video=e.video,ge.visible=!0})(e)},{default:j(()=>[...b[22]||(b[22]=[C("é¢„è§ˆ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Me,ne.value]]),h(Ce,{"current-page":ue.page,"onUpdate:currentPage":b[3]||(b[3]=e=>ue.page=e),"page-size":ue.pageSize,total:ue.total,layout:"total, prev, pager, next, jumper",onCurrentChange:we,class:"pagination"},null,8,["current-page","page-size","total"])]),h($e,{modelValue:ve.visible,"onUpdate:modelValue":b[7]||(b[7]=e=>ve.visible=e),title:"æ‹’ç»è§†é¢‘",width:"450px"},{footer:j(()=>[h(je,{onClick:b[6]||(b[6]=e=>ve.visible=!1)},{default:j(()=>[...b[24]||(b[24]=[C("å–æ¶ˆ",-1)])]),_:1}),h(je,{type:"danger",onClick:_e},{default:j(()=>[...b[25]||(b[25]=[C("ç¡®è®¤æ‹’ç»",-1)])]),_:1})]),default:j(()=>[_("div",se,[b[23]||(b[23]=_("p",{class:"reject-title"},"è¯·é€‰æ‹©æ‹’ç»åŽŸå› ï¼š",-1)),h(Ue,{modelValue:ve.reasons,"onUpdate:modelValue":b[4]||(b[4]=e=>ve.reasons=e),class:"reason-group"},{default:j(()=>[h(Se,{label:"å†…å®¹è¿è§„"}),h(Se,{label:"ä½Žè´¨é‡å†…å®¹"}),h(Se,{label:"ç‰ˆæƒé—®é¢˜"}),h(Se,{label:"è™šå‡ä¿¡æ¯"}),h(Se,{label:"æ ‡é¢˜å…š/å°é¢å…š"}),h(Se,{label:"é‡å¤å†…å®¹"}),h(Se,{label:"å…¶ä»–åŽŸå› "})]),_:1},8,["modelValue"]),h(he,{modelValue:ve.note,"onUpdate:modelValue":b[5]||(b[5]=e=>ve.note=e),type:"textarea",rows:"3",placeholder:"è¡¥å……è¯´æ˜Žï¼ˆé€‰å¡«ï¼‰",style:{"margin-top":"16px"}},null,8,["modelValue"])])]),_:1},8,["modelValue"]),h($e,{modelValue:ge.visible,"onUpdate:modelValue":b[8]||(b[8]=e=>ge.visible=e),title:"è§†é¢‘é¢„è§ˆ",width:"800px","destroy-on-close":""},{default:j(()=>[_("div",ie,[ge.video?(z(),f("video",{key:0,src:ge.video.original_url||ge.video.hls_url,controls:"",style:{width:"100%","max-height":"450px"}},null,8,oe)):S("",!0),ge.video?(z(),f("div",de,[_("h3",null,k(ge.video.title),1),_("p",null,k(ge.video.description||"æš‚æ— ç®€ä»‹"),1)])):S("",!0)])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-6ea184b4"]]);export{ne as default};
