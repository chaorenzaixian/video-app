import{r as e,c as a,w as l,j as s,n as i,R as t,y as n,C as c,E as o,I as r,G as u,U as v,K as d,L as p,a0 as m,M as _,H as g,P as k,aa as f,u as y,ae as h,af as w,V as b,az as C,aC as x,z as $}from"./vue-vendor-Ba_vealp.js";import{_ as M}from"./ic_back-BPdSG6fy.js";import{_ as j}from"./ic_launcher-GoPvjxRC.js";import{_ as S}from"./super_vip_blue-CukdgMfT.js";import{_ as T}from"./god_comment-Dp4lzx7s.js";import{_ as z,a as L}from"./index-C3P4JTuA.js";import{a as B}from"./utils-DflAyOWx.js";import{e as I,H as E}from"./video-player-CxH5brnW.js";import{aL as P,E as V}from"./element-plus-DlIn_qXi.js";import{r as D}from"./zh-cn-StHTbzJD.js";import{u as H}from"./useAbortController-pf-gfr0d.js";import{u as R,a as U,b as W}from"./useCleanup-GCaf3062.js";import{f as Y,b as A,a as F}from"./format-s96t4k9e.js";import{V as q}from"./vip-C8N2TCfr.js";/* empty css             *//* empty css                 *//* empty css                   */const O={class:"video-player-page"},G={class:"player-container"},J={class:"share-modal-content"},K={class:"share-promo-image"},N=["src"],Q={class:"share-qr-section"},X={class:"share-qrcode"},Z=["src"],ee={class:"share-invite-info"},ae={class:"invite-code"},le={class:"official-url"},se={class:"share-actions"},ie={class:"vip-member-center"},te=["src"],ne={class:"vip-expire-text"},ce={class:"content-tabs"},oe={class:"intro-content"},re={class:"intro-section"},ue={class:"video-title"},ve={class:"video-tags"},de={class:"uploader-info"},pe=["src"],me={class:"uploader-detail"},_e={class:"name-row"},ge=["src"],ke={key:1,class:"badge"},fe={class:"stats"},ye={class:"video-stats"},he={class:"stat-item views"},we={class:"stat-value"},be={class:"stat-value"},Ce={class:"stat-value"},xe={key:0,class:"ad-icons-section"},$e={class:"ad-icons-scroll",ref:"adIconsScrollRef"},Me={class:"ad-icons-track"},je=["onClick"],Se={class:"icon-wrap"},Te=["src","alt"],ze={key:1,class:"icon-emoji"},Le={class:"icon-name"},Be=["onClick"],Ie={class:"icon-wrap"},Ee=["src","alt"],Pe={key:1,class:"icon-emoji"},Ve={class:"icon-name"},De={class:"recommend-tabs"},He=["onClick"],Re={class:"recommend-section"},Ue={class:"video-list double-column"},We=["onClick","onMouseenter","onMouseleave"],Ye={class:"video-cover"},Ae=["src","alt"],Fe=["data-src"],qe={class:"cover-views"},Oe={class:"video-duration"},Ge={class:"video-info"},Je={class:"video-title"},Ke={class:"video-meta"},Ne={key:0,class:"video-tag"},Qe={key:1,class:"video-tag"},Xe={key:2,class:"video-tag"},Ze={class:"video-comments"},ea={class:"comments-content"},aa={class:"comment-list-wrapper"},la={key:0,class:"comment-item official-announcement"},sa=["src"],ia={class:"comment-body"},ta={class:"comment-user"},na={class:"username official-name"},ca={class:"comment-text official-text"},oa={class:"comment-meta"},ra={class:"time"},ua={key:1,class:"comment-list"},va=["src","onClick"],da={class:"comment-body"},pa={class:"comment-user"},ma=["onClick"],_a=["src"],ga={key:1,src:T,class:"god-badge",title:"Á•ûËØÑ"},ka={key:2,class:"pin-badge"},fa={class:"comment-text"},ya=["onClick"],ha=["src"],wa={class:"comment-meta"},ba={class:"time"},Ca=["onClick"],xa=["onClick"],$a=["onClick"],Ma={key:1,class:"reply-list"},ja=["src","onClick"],Sa={class:"reply-body"},Ta=["onClick"],za={key:0,class:"official-badge small"},La=["src"],Ba={class:"reply-text"},Ia=["onClick"],Ea=["src"],Pa={class:"reply-meta"},Va={class:"time"},Da=["onClick"],Ha=["onClick"],Ra=["onClick"],Ua={key:2,class:"empty-comments"},Wa={key:3,class:"load-more"},Ya=["disabled"],Aa={key:0,class:"loading-spinner"},Fa={key:1},qa={key:4,class:"no-more-comments"},Oa={class:"comment-input-bar"},Ga={class:"input-area"},Ja={key:0,class:"image-preview"},Ka=["src"],Na={class:"input-row"},Qa=["placeholder"],Xa={class:"input-actions"},Za={class:"image-btn"},el={key:1,class:"emoji-picker"},al={class:"emoji-grid"},ll=["onClick"],sl={class:"lightbox-container"},il=["src"],tl={class:"lightbox-controls"},nl=z({__name:"DarkwebPlayer",setup(T){P.extend(D),P.locale("zh-cn");const z=C(),nl=x(),{signal:cl}=H(),ol=R(),rl=U();W();const ul=e(null),vl=e(null),dl=e(null);let pl=null;const ml=e({}),_l=e([]),gl=e([]),kl=e([]),fl=e(""),yl=e("intro"),hl=e(0),wl=e(!1),bl=e(!1),Cl=e(!1),xl=e(!1),$l=e(!1),Ml=e(0),jl=e("ÈùûVIP"),Sl=e(null),Tl=e(1),zl=e(!1),Ll=e(!1),Bl=e(!1),Il=e(!1);e(!1);const El=e(!1);e(!1);const Pl=e(0),Vl=e(0),Dl=e(!0),Hl=e(0),Rl=e("3AUUHR"),Ul=a(()=>window.location.origin.replace(/^https?:\/\//,"")),Wl=a(()=>`${window.location.origin}/user/darkweb/video/${ml.value.id}?ref=${Rl.value}`),Yl=a(()=>`https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=${encodeURIComponent(Wl.value)}`);e(null);const Al=e(null),Fl=e(!1),ql=e(5),Ol=e(!1),Gl=e(!1),Jl=async()=>{if(!$l.value)try{const e=await L.get("/ads",{params:{position:"VIDEO_PRE",limit:1}}),a=e.data||e||[];a.length>0&&(Al.value=a[0],setTimeout(()=>{Kl()},500))}catch(e){}},Kl=()=>!(!Al.value||Gl.value||$l.value)&&(Fl.value=!0,ql.value=Al.value.duration||5,Gl.value=!0,!0);a(()=>{if(!Bl.value||Ll.value||Il.value||Dl.value)return!1;const e=ml.value.free_preview_seconds||0;return!(e<=0)&&(Hl.value>=e-10&&Hl.value<e)}),a(()=>{const e=ml.value.free_preview_seconds||30;return Math.max(0,Math.ceil(e-Hl.value))}),a(()=>jl.value||"‰ºöÂëò");const Nl=a(()=>q[Ml.value]||""),Ql=a(()=>{if(!Sl.value)return"";const e=new Date(Sl.value);return`${e.getFullYear()}.${String(e.getMonth()+1).padStart(2,"0")}.${String(e.getDate()).padStart(2,"0")}`});a(()=>ml.value.coin_price?$l.value&&ml.value.vip_discount&&ml.value.vip_discount<1?Math.ceil(ml.value.coin_price*ml.value.vip_discount):ml.value.coin_price:0);const Xl=e(0),Zl=e(1),es=e(10),as=e(null),ls=e("newest"),ss=e(!1),is=e(!1),ts=e(!1),ns=e(null),cs=e(null),os=e(!1),rs=e(!1),us=e(null),vs=e(""),ds=["üòÄ","üòÇ","ü§£","üòä","üòç","ü•∞","üòò","üòú","ü§™","üòé","ü•≥","üòá","ü§©","üòã","üòõ","ü§§","üòè","üòí","üòî","üò¢","üò≠","üò§","üò†","ü§¨","üò±","üò∞","üò•","ü§ß","üò∑","ü§í","üëç","üëé","üëè","üôè","üí™","‚ù§Ô∏è","üíî","üíØ","üî•","‚ú®","üéâ","üéä","üíé","üèÜ","ü•á","‚≠ê","üåü","üí´","üåà","‚òÄÔ∏è","üåô","‚ö°","üí•","üí¢","üí§","üëª","üíÄ","üëΩ","ü§ñ","üê∂","üê±","üê∞","ü¶ä","üêª","üêº","üêØ","ü¶Å","üêÆ","üê∑","üê∏"],ps=["‰∏ªÊí≠","ÁÉ≠Èó®"],ms=["ËßÜÈ¢ëÊé®Ëçê","Âä®Êº´Êé®Ëçê","Êº´ÁîªÊé®Ëçê"],_s=e=>{const a=e%52;if(a<17)return`/images/avatars/icon_avatar_${a+1}.webp`;if(a<32){return`/images/avatars/DM_20251217202131_${String(a-17+1).padStart(3,"0")}.JPEG`}return`/images/avatars/DM_20251217202341_${String(a-32+1).padStart(3,"0")}.JPEG`};a(()=>{const e=cs.value||1;return _s(e)});const gs=e({}),ks=e(null);let fs=null;const ys=e(!1),hs=e=>ks.value===e,ws=e=>{if(ks.value&&ks.value!==e.id){const e=gs.value[ks.value];e&&(e.pause(),e.currentTime=0,e.src="")}ks.value=e.id;const a=gs.value[e.id];a&&(!a.src&&a.dataset.src&&(a.src=a.dataset.src),a.currentTime=0,a.play().catch(e=>{}))},bs=()=>{ys.value=!0},Cs=e=>{ys.value&&e.preview_url?ks.value===e.id?((()=>{if(ks.value){const e=gs.value[ks.value];e&&(e.pause(),e.currentTime=0),ks.value=null}})(),ui(e.id)):ws(e):ui(e.id)},xs=a(()=>{const e=ml.value.uploader_videos||0,a=ml.value.uploader_followers||0;return`${e} ‰ΩúÂìÅ  ${Y(a)} Á≤â‰∏ù`}),$s=e=>e?e.startsWith("http")||e.startsWith("/")?e:"/"+e:"/placeholder.webp",Ms=(e,a)=>{if(e)return e;const l=parseInt(a)||1;return _s(l)},js=e=>q[e]||"",Ss=async()=>{var e;const a=z.params.id;if(a)try{const s=await L.get(`/darkweb/videos/${a}`,{signal:cl});if(ml.value=s.data||s,ml.value.needs_vip&&($l.value=!1),await Ts(),ml.value.uploader_id)try{const a=await L.get(`/users/${ml.value.uploader_id}/follow/status`,{signal:cl});xl.value=(null==(e=a.data)?void 0:e.is_followed)||!1}catch(l){}await L.post(`/darkweb/videos/${a}/view`)}catch(s){if("CanceledError"===s.name||"AbortError"===s.name)return;ml.value={id:a,title:"ËßÜÈ¢ëÂä†ËΩΩÂ§±Ë¥•",description:"ËØ∑Á®çÂêéÈáçËØï",cover_url:"/uploads/thumbnails/3.webp",hls_url:"",duration:0,view_count:0,like_count:0,favorite_count:0,is_vip_only:!1,is_verified:!1,uploader_name:"Êú™Áü•",uploader_avatar:"",uploader_videos:0,uploader_followers:0,tags:[]}}else nl.replace("/")},Ts=async()=>{const e=ml.value;if(Dl.value=!1,Il.value=!1,Ll.value=!1,Bl.value=!1,Hl.value=0,Vl.value=0,!e.pay_type||"free"===e.pay_type)return Bl.value=!1,Ll.value=!0,void(Dl.value=!0);if("vip_free"===e.pay_type&&$l.value)return Bl.value=!1,Ll.value=!0,void(Dl.value=!0);if(Ml.value>=5)return Bl.value=!1,Ll.value=!0,void(Dl.value=!0);if(e.vip_free_level>0&&Ml.value>=e.vip_free_level)return Bl.value=!1,Ll.value=!0,void(Dl.value=!0);Bl.value=!0;try{const a=await L.get(`/coins/purchase/video/${e.id}/check`,{signal:cl}),l=a.data||a;Ll.value=!0===l.purchased||!0===l.can_watch,l.is_vip_free&&(Dl.value=!0,Ll.value=!0,Bl.value=!1)}catch(a){"CanceledError"!==a.name&&a.name,Ll.value=!1}},zs=async()=>{try{const e=await L.get("/coins/balance",{signal:cl}),a=e.data||e;Pl.value=a.balance||0}catch(e){"CanceledError"!==e.name&&e.name,Pl.value=0}},Ls=async()=>{try{const e=await L.get("/settings/comment-announcement",{signal:cl});as.value=e.data||e}catch(e){"CanceledError"!==e.name&&e.name}},Bs=e=>{if(!e)return"";const a=new Date(e);return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")} ${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`},Is=async(e=!0)=>{const a=z.params.id;if(a){e&&(Zl.value=1,is.value=!0);try{const l=await L.get(`/comments/video/${a}`,{params:{page:Zl.value,page_size:es.value,sort_by:ls.value},signal:cl}),s=l.data||l;_l.value=e?s.items||[]:[..._l.value,...s.items||[]],Xl.value=s.total||0,ss.value=Zl.value*es.value<Xl.value}catch(l){"CanceledError"!==l.name&&l.name,e&&(_l.value=[])}finally{is.value=!1}}},Es=async()=>{!is.value&&ss.value&&(is.value=!0,Zl.value++,await Is(!1))},Ps=(e,a=null)=>{ns.value={parent_id:e.id,user_name:a?a.user_name:e.user_name},setTimeout(()=>{var e;null==(e=dl.value)||e.focus()},100)},Vs=()=>{ns.value=null,fl.value="",us.value=null,vs.value="",rs.value=!1},Ds=e=>{const a=e.target.files[0];a&&(a.size>5242880?alert("ÂõæÁâáÂ§ßÂ∞è‰∏çËÉΩË∂ÖËøá5MB"):a.type.startsWith("image/")?(us.value=a,vs.value=URL.createObjectURL(a)):alert("ËØ∑ÈÄâÊã©ÂõæÁâáÊñá‰ª∂"))},Hs=()=>{us.value=null,vs.value=""},Rs=e(!1),Us=e(""),Ws=e(1),Ys=e=>{Us.value=e,Ws.value=1,Rs.value=!0},As=()=>{Rs.value=!1,Us.value="",Ws.value=1},Fs=()=>{Ws.value<3&&(Ws.value+=.5)},qs=()=>{Ws.value>.5&&(Ws.value-=.5)},Os=()=>{Ws.value=1},Gs=async()=>{try{const e=await L.get("/darkweb/videos",{params:{page:1,page_size:12,sort:"random"},signal:cl}),a=e.data||e;if(a.items&&a.items.length>0){const e=parseInt(z.params.id);gl.value=a.items.filter(a=>a.id!==e).slice(0,10)}else Ks()}catch(e){"CanceledError"!==e.name&&"AbortError"!==e.name&&Ks()}},Js=async()=>{try{const e=await B.get("/api/v1/ads/icons",{signal:cl});kl.value=(e.data||[]).filter(e=>!1!==e.is_active)}catch(e){"CanceledError"!==e.name&&e.name}},Ks=()=>{gl.value=[{id:101,title:"ÊûÅÂìÅÂ§ñÂõΩÂ•≥Á•û Ë∂ÖÁæéÂ´©Á©¥ Âàù‰∏ãÊµ∑Ë¢´ÊìçÂñ∑Ê∞¥ÔºÅ",cover_url:"/uploads/thumbnails/3.webp",duration:4099,view_count:1098e3},{id:102,title:"Ê≠£ÂÆóÂ§ßÂ≠¶ÁîüÂÆøËàçÁõ¥Êí≠ÈÅìÂÖ∑ÊèíÈÄºÈ™öËØùËøûÁØá",cover_url:"/uploads/thumbnails/3.webp",duration:1608,view_count:1752e3},{id:103,title:"Êé®ËçêËßÜÈ¢ë3",cover_url:"/uploads/thumbnails/3.webp",duration:3200,view_count:12300},{id:104,title:"Êé®ËçêËßÜÈ¢ë4",cover_url:"/uploads/thumbnails/3.webp",duration:1500,view_count:4500}]},Ns=()=>{if(!vl.value)return;const e=ml.value.hls_url?ml.value.hls_url:ml.value.original_url||"";e&&(pl&&(pl.destroy(),pl=null),pl=new I({container:vl.value,url:e,poster:$s(ml.value.cover_url),volume:.7,isLive:!1,muted:!1,autoplay:!1,pip:!0,autoSize:!1,autoMini:!0,screenshot:!1,setting:!0,loop:!1,flip:!0,playbackRate:!0,aspectRatio:!0,fullscreen:!0,fullscreenWeb:!0,subtitleOffset:!1,miniProgressBar:!0,mutex:!0,backdrop:!0,playsInline:!0,autoPlayback:!0,airplay:!0,theme:"#ff4444",lang:"zh-cn",moreVideoAttr:{crossOrigin:"anonymous"},customType:{m3u8:function(e,a,l){if(E.isSupported()){l.hls&&l.hls.destroy();const s=new E({maxBufferLength:30,maxMaxBufferLength:60,maxBufferSize:6e7,maxBufferHole:.5,lowLatencyMode:!1,startLevel:-1,abrEwmaDefaultEstimate:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,backBufferLength:30});s.loadSource(a),s.attachMedia(e),l.hls=s,l.on("destroy",()=>s.destroy())}else e.canPlayType("application/vnd.apple.mpegurl")?e.src=a:l.notice.show="‰∏çÊîØÊåÅÊí≠ÊîæÊ†ºÂºè: m3u8"}},controls:[{name:"fast-rewind",position:"right",html:'<svg viewBox="0 0 24 24" width="22" height="22" fill="white"><path d="M11 18V6l-8.5 6 8.5 6zm.5-6l8.5 6V6l-8.5 6z"/></svg>',tooltip:"Âø´ÈÄÄ10Áßí",click:function(){pl&&(pl.currentTime=Math.max(0,pl.currentTime-10))}},{name:"fast-forward",position:"right",html:'<svg viewBox="0 0 24 24" width="22" height="22" fill="white"><path d="M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z"/></svg>',tooltip:"Âø´Ëøõ10Áßí",click:function(){pl&&(pl.currentTime=Math.min(pl.duration,pl.currentTime+10))}}]}),ul.value=pl.video,pl.on("play",()=>{wl.value=!0}),pl.on("pause",()=>{wl.value=!1}),pl.on("video:ended",()=>{wl.value=!1,Xs()}),pl.on("video:timeupdate",()=>{Qs()}),pl.on("video:waiting",()=>{pl.loading.show=!0}),pl.on("video:canplay",()=>{pl.loading.show=!1}))},Qs=()=>{if(pl&&(wl.value=pl.playing,Hl.value=pl.currentTime,Bl.value&&!Ll.value&&!Dl.value)){const e=pl.currentTime,a=ml.value.free_preview_seconds||30;e>=a&&(pl.pause(),pl.currentTime=a,Il.value=!0,wl.value=!1)}},Xs=()=>{wl.value=!1},Zs=async()=>{var e;try{const e=await L.post(`/darkweb/videos/${ml.value.id}/like`),a=e.data||e;bl.value=a.liked,ml.value.like_count=a.like_count}catch(a){401===(null==(e=a.response)?void 0:e.status)&&V.warning("ËØ∑ÂÖàÁôªÂΩïÂêéÂÜçÁÇπËµû")}},ei=async()=>{var e;try{const e=await L.post(`/darkweb/videos/${ml.value.id}/favorite`),a=e.data||e;Cl.value=a.favorited,ml.value.favorite_count=a.favorite_count,V.success(a.favorited?"Êî∂ËóèÊàêÂäü":"Â∑≤ÂèñÊ∂àÊî∂Ëóè")}catch(a){401===(null==(e=a.response)?void 0:e.status)&&V.warning("ËØ∑ÂÖàÁôªÂΩïÂêéÂÜçÊî∂Ëóè")}},ai=async()=>{var e,a,l;const s=ml.value.uploader_id;if(s)try{xl.value?(await L.delete(`/users/${s}/follow`),xl.value=!1,V.success("Â∑≤ÂèñÊ∂àÂÖ≥Ê≥®")):(await L.post(`/users/${s}/follow`),xl.value=!0,V.success("ÂÖ≥Ê≥®ÊàêÂäü"))}catch(i){401===(null==(e=i.response)?void 0:e.status)?V.warning("ËØ∑ÂÖàÁôªÂΩï"):V.error((null==(l=null==(a=i.response)?void 0:a.data)?void 0:l.detail)||"Êìç‰ΩúÂ§±Ë¥•")}},li=e=>{e&&nl.push(`/user/member/${e}`)},si=()=>{El.value=!0},ii=async()=>{var e,a,l,s,i;if((fl.value.trim()||us.value)&&!ts.value)if($l.value){ts.value=!0;try{let s=null;if(us.value){const a=new FormData;a.append("file",us.value);const l=await L.post("/comments/upload-image",a,{headers:{"Content-Type":"multipart/form-data"}});s=(null==(e=l.data)?void 0:e.url)||l.url}const i={content:fl.value.trim(),video_id:parseInt(z.params.id),parent_id:(null==(a=ns.value)?void 0:a.parent_id)||(null==(l=ns.value)?void 0:l.id)||null,image_url:s},t=await L.post("/comments",i),n=t.data||t;if(ns.value){const e=ns.value.parent_id||ns.value.id,a=_l.value.find(a=>a.id===e);a&&(a.replies||(a.replies=[]),a.replies.push(n),a.reply_count=(a.reply_count||0)+1)}else{const e=_l.value.findIndex(e=>!e.is_pinned);-1===e?_l.value.push(n):_l.value.splice(e,0,n),Xl.value++}fl.value="",ns.value=null,us.value=null,vs.value="",rs.value=!1}catch(t){401===(null==(s=t.response)?void 0:s.status)?alert("ËØ∑ÂÖàÁôªÂΩïÂêéÂÜçÂèëË°®ËØÑËÆ∫"):403===(null==(i=t.response)?void 0:i.status)?alert("ËØ∑ÂÖàÂºÄÈÄöVIP‰ºöÂëòÊâçËÉΩÂèëË°®ËØÑËÆ∫"):alert("ÂèëË°®ËØÑËÆ∫Â§±Ë¥•ÔºåËØ∑ÈáçËØï")}finally{ts.value=!1}}else alert("ËØ∑ÂÖàÂºÄÈÄöVIP‰ºöÂëòÊâçËÉΩÂèëË°®ËØÑËÆ∫")},ti=async e=>{var a;try{const a=await L.post(`/comments/${e.id}/like`),l=a.data||a;e.is_liked=!e.is_liked,e.like_count=l.like_count}catch(l){401===(null==(a=l.response)?void 0:a.status)&&alert("ËØ∑ÂÖàÁôªÂΩïÂêéÂÜçÁÇπËµû")}};let ni=0;const ci=()=>{ni++,ni>=3?(ni=0,nl.push("/user")):nl.back()},oi=()=>{ni=0},ri=async()=>{V.info("ÈïøÊåâÂõæÁâá‰øùÂ≠òÂà∞Áõ∏ÂÜå")},ui=e=>{oi(),nl.push(`/user/darkweb/video/${e}`).then(()=>{window.scrollTo(0,0)})},vi=e=>{e.link&&window.open(e.link,"_blank")},di=e=>{const a=P(e),l=P().diff(a,"day");return 0===l?a.format("HH:mm"):l<7?a.fromNow():a.format("YYYY-MM-DD HH:mm")};return l(()=>z.params.id,async(e,a)=>{e&&e!==a&&(pl&&(pl.destroy(),pl=null),Gl.value=!1,Fl.value=!1,Al.value=null,Ol.value=!1,await Ss(),await Promise.all([Is(),Gs(),Js(),Jl()]),await i(),Ns())}),s(async()=>{oi();try{const e=await L.get("/users/me"),a=e.data||e;cs.value=a.id,$l.value=a.is_vip||!1,Ml.value=a.vip_level||0,jl.value=a.vip_level_name||"ÈùûVIP",Sl.value=a.vip_expire_date||null,os.value="admin"===a.role||"super_admin"===a.role}catch(e){}await Ss(),await Promise.all([Is(),Gs(),Js(),Ls(),zs(),Jl()]),await i(),Ns()}),t(()=>{pl&&(pl.destroy(),pl=null)}),(e,a)=>($(),n("div",O,[c("div",{class:"back-btn",onClick:ci},[...a[12]||(a[12]=[c("img",{src:M,alt:"ËøîÂõû",class:"back-icon"},null,-1)])]),c("div",G,[c("div",{ref_key:"artPlayerRef",ref:vl,class:"artplayer-container"},null,512)]),($(),o(m,{to:"body"},[El.value?($(),n("div",{key:0,class:"share-modal-overlay",onClick:a[2]||(a[2]=v(e=>El.value=!1,["self"]))},[c("div",J,[c("button",{class:"share-modal-close",onClick:a[0]||(a[0]=e=>El.value=!1)},"√ó"),a[14]||(a[14]=c("div",{class:"share-header"},[c("img",{src:j,alt:"Logo",class:"share-logo"}),c("div",{class:"share-title-info"},[c("h3",{class:"share-site-name"},"SoulÊàê‰∫∫Áâà"),c("p",{class:"share-site-desc"},"ÂÖ®ÁΩëÊúÄÂÖ®Êàê‰∫∫ËßÜÈ¢ëÂπ≥Âè∞")])],-1)),c("div",K,[c("img",{src:ml.value.cover_url||"/images/default-cover.webp",alt:"Êé®ÂπøÂõæ"},null,8,N)]),c("div",Q,[c("div",X,[c("img",{src:Yl.value,alt:"‰∫åÁª¥Á†Å"},null,8,Z)]),c("div",ee,[c("div",ae,[a[13]||(a[13]=d("ÈÇÄËØ∑Á†Å ",-1)),c("span",null,p(Rl.value),1)]),c("div",le,"ÂÆòÊñπÁΩëÂùÄ:"+p(Ul.value),1)])]),c("div",se,[c("button",{class:"copy-link-btn",onClick:a[1]||(a[1]=e=>{return a=Wl.value,void navigator.clipboard.writeText(a).then(()=>{V.success("ÂàÜ‰∫´ÈìæÊé•Â∑≤Â§çÂà∂ÔºåÂàÜ‰∫´ÁªôÂ•ΩÂèãÊ≥®ÂÜåÂêéÂèØËé∑Âæó3Êó•VIP")}).catch(()=>{V.info("ËØ∑Â§çÂà∂ÈìæÊé•ÂàÜ‰∫´Ôºö"+a)});var a})},"Â§çÂà∂ÈìæÊé•"),c("button",{class:"save-image-btn",onClick:ri},"‰øùÂ≠òÂõæÁâá")])])])):r("",!0)])),Dl.value?r("",!0):($(),n("div",{key:0,class:"vip-promo",onClick:a[3]||(a[3]=a=>e.$router.push("/user/vip"))},[$l.value?($(),n(_,{key:1},[c("div",ie,[Ml.value>0?($(),n("img",{key:0,src:Nl.value,class:"vip-icon-promo"},null,8,te)):r("",!0),c("span",ne,"Âà∞ÊúüÊó∂Èó¥Ôºö"+p(Ql.value||"Ê∞∏‰πÖ"),1)]),a[17]||(a[17]=c("div",{class:"promo-btn upgrade"},[d(" ÂçáÁ∫ß‰ºöÂëò "),c("span",{class:"arrow"},"‚Ä∫")],-1))],64)):($(),n(_,{key:0},[a[15]||(a[15]=c("span",{class:"promo-text"},"ÂºÄÈÄö‰ºöÂëò ‰∫´‰∏ìÂ±ûÁâπÊùÉ",-1)),a[16]||(a[16]=c("div",{class:"promo-btn"},[d(" ÂºÄÈÄö‰ºöÂëò "),c("span",{class:"arrow"},"‚Ä∫")],-1))],64))])),c("div",ce,[c("div",{class:g(["tab-item",{active:"intro"===yl.value}]),onClick:a[4]||(a[4]=e=>yl.value="intro")}," ÁÆÄ‰ªã ",2),c("div",{class:g(["tab-item",{active:"comments"===yl.value}]),onClick:a[5]||(a[5]=e=>yl.value="comments")}," ËØÑËÆ∫ ("+p(Xl.value)+") ",3),c("div",{class:"tab-right",onClick:a[6]||(a[6]=e=>zl.value=!0)},[a[18]||(a[18]=c("span",{class:"line-icon"},"‚ö°",-1)),d(" Á∫øË∑Ø"+p(Tl.value),1)])]),u(c("div",oe,[c("div",re,[c("h1",ue,p(ml.value.title),1),c("div",ve,[($(!0),n(_,null,f(ml.value.tags||ps,e=>($(),n("span",{key:e,class:"tag-item"},p(e),1))),128))]),c("div",de,[c("img",{src:Ms(ml.value.uploader_avatar,ml.value.uploader_id||ml.value.id),class:"avatar clickable",onClick:a[7]||(a[7]=e=>li(ml.value.uploader_id))},null,8,pe),c("div",me,[c("div",_e,[c("span",{class:"name clickable",onClick:a[8]||(a[8]=e=>li(ml.value.uploader_id))},p(ml.value.uploader_name||"ÂåøÂêçÁî®Êà∑"),1),ml.value.uploader_vip_level>0?($(),n("img",{key:0,src:js(ml.value.uploader_vip_level),class:"vip-badge"},null,8,ge)):r("",!0),ml.value.is_verified?($(),n("span",ke,"üî∑ Ëá≥Â∞ä")):r("",!0)]),c("div",fe,p(xs.value),1)]),c("button",{class:g(["follow-btn",{followed:xl.value}]),onClick:ai},p(xl.value?"Â∑≤ÂÖ≥Ê≥®":"+ ÂÖ≥Ê≥®"),3)]),c("div",ye,[c("div",he,[c("span",we,p(y(A)(ml.value.view_count))+"ËßÇÁúãÈáè",1)]),c("div",{class:"stat-item clickable",onClick:Zs},[c("span",{class:g(["stat-icon","heart",{active:bl.value}])},[...a[19]||(a[19]=[c("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})],-1)])],2),c("span",be,p(y(Y)(ml.value.like_count)),1)]),c("div",{class:"stat-item clickable",onClick:ei},[c("span",{class:g(["stat-icon","star",{active:Cl.value}])},[...a[20]||(a[20]=[c("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})],-1)])],2),c("span",Ce,p(ml.value.favorite_count||0),1)]),c("div",{class:"stat-item clickable",onClick:si},[...a[21]||(a[21]=[c("span",{class:"stat-icon share"},[c("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[c("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})])],-1),c("span",{class:"stat-label"},"ÂàÜ‰∫´",-1)])])])]),kl.value.length>0?($(),n("div",xe,[c("div",$e,[c("div",Me,[($(!0),n(_,null,f(kl.value,e=>($(),n("div",{key:"a-"+e.id,class:"ad-icon-item",onClick:a=>vi(e)},[c("div",Se,[e.image?($(),n("img",{key:0,src:e.image,alt:e.name},null,8,Te)):($(),n("span",ze,p(e.icon),1))]),c("span",Le,p(e.name),1)],8,je))),128)),($(!0),n(_,null,f(kl.value,e=>($(),n("div",{key:"b-"+e.id,class:"ad-icon-item",onClick:a=>vi(e)},[c("div",Ie,[e.image?($(),n("img",{key:0,src:e.image,alt:e.name},null,8,Ee)):($(),n("span",Pe,p(e.icon),1))]),c("span",Ve,p(e.name),1)],8,Be))),128))])],512)])):r("",!0),c("div",De,[($(),n(_,null,f(ms,(e,a)=>c("div",{key:a,class:g(["rec-tab",{active:hl.value===a}]),onClick:e=>hl.value=a},p(e),11,He)),64))]),c("div",Re,[c("div",Ue,[($(!0),n(_,null,f(gl.value,e=>{return $(),n("div",{key:e.id,class:"video-card",onClick:a=>Cs(e),onMouseenter:a=>{var l;(l=e).preview_url&&!ys.value&&(ks.value=l.id,fs&&ol.clearTimeout(fs),fs=ol.setTimeout(()=>{ks.value===l.id&&ws(l)},300))},onMouseleave:a=>(e=>{if(!ys.value&&(fs&&(ol.clearTimeout(fs),fs=null),ks.value===e.id)){ks.value=null;const a=gs.value[e.id];a&&(a.pause(),a.currentTime=0,a.src="")}})(e),onTouchstartPassive:bs},[c("div",Ye,[c("img",{src:$s(e.cover_url),alt:e.title,class:g({hidden:hs(e.id)})},null,10,Ae),e.preview_url?($(),n("video",{key:0,ref_for:!0,ref:a=>((e,a)=>{a&&(gs.value[e]=a,rl.registerVideo(`preview_${e}`,a))})(e.id,a),"data-src":(l=e.preview_url,l?(l.startsWith("http"),l):""),class:g(["preview-video",{visible:hs(e.id)}]),muted:"",loop:"",playsinline:"",preload:"none"},null,10,Fe)):r("",!0),c("div",qe,[a[22]||(a[22]=c("span",{class:"play-icon"},"‚ñ∂",-1)),c("span",null,p(y(A)(e.view_count)),1)]),c("div",Oe,p(y(F)(e.duration)),1)]),c("div",Ge,[c("p",Je,p(e.title),1),c("div",Ke,[e.tags&&e.tags.length>0?($(),n("span",Ne,p(e.tags[0]),1)):e.category_name?($(),n("span",Qe,p(e.category_name),1)):($(),n("span",Xe,"Á≤æÈÄâ")),c("span",Ze,"ËØÑËÆ∫ "+p(e.comment_count||0),1)])])],40,We);var l}),128))])])],512),[[k,"intro"===yl.value]]),u(c("div",ea,[c("div",aa,[as.value&&as.value.enabled?($(),n("div",la,[c("img",{src:as.value.avatar||"/images/avatars/icon_avatar_1.webp",class:"avatar"},null,8,sa),c("div",ia,[c("div",ta,[c("span",na,p(as.value.name),1),a[23]||(a[23]=c("img",{src:S,class:"supreme-vip-icon"},null,-1))]),c("p",ca,p(as.value.content),1),c("div",oa,[c("span",ra,p(Bs(as.value.updated_at)),1)])])])):r("",!0),_l.value.length>0?($(),n("div",ua,[($(!0),n(_,null,f(_l.value,e=>($(),n("div",{key:e.id,class:g(["comment-item",{"is-pinned":e.is_pinned,"is-official":e.is_official}])},[c("img",{src:Ms(e.user_avatar,e.user_id||e.id),class:"avatar clickable",onClick:a=>li(e.user_id)},null,8,va),c("div",da,[c("div",pa,[c("span",{class:"username clickable",onClick:a=>li(e.user_id)},p(e.user_name),9,ma),e.user_vip_level>0?($(),n("img",{key:0,src:js(e.user_vip_level),class:"vip-badge-sm"},null,8,_a)):r("",!0),e.is_god?($(),n("img",ga)):r("",!0),e.is_pinned?($(),n("span",ka,"üìå ÁΩÆÈ°∂")):r("",!0)]),c("p",fa,p(e.content),1),e.image_url?($(),n("div",{key:0,class:"comment-image",onClick:a=>Ys(e.image_url)},[c("img",{src:e.image_url,alt:"comment image"},null,8,ha)],8,ya)):r("",!0),c("div",wa,[c("span",ba,p(di(e.created_at)),1),c("span",{class:g(["like-btn",{liked:e.is_liked}]),onClick:a=>ti(e)},p(e.is_liked?"‚ù§Ô∏è":"ü§ç")+" "+p(e.like_count||0),11,Ca),c("span",{class:"reply-btn",onClick:a=>Ps(e)},"ÂõûÂ§ç",8,xa),os.value?($(),n("span",{key:0,class:"delete-btn",onClick:a=>(async(e,a=null)=>{if(confirm("Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÊù°ËØÑËÆ∫ÂêóÔºü"))try{if(await L.delete(`/comments/${e.id}`),a){const l=a.replies.findIndex(a=>a.id===e.id);l>-1&&(a.replies.splice(l,1),a.reply_count=Math.max(0,(a.reply_count||1)-1))}else{const a=_l.value.findIndex(a=>a.id===e.id);a>-1&&(_l.value.splice(a,1),Xl.value=Math.max(0,Xl.value-1))}}catch(l){alert("Âà†Èô§Â§±Ë¥•ÔºåËØ∑ÈáçËØï")}})(e)},"Âà†Èô§",8,$a)):r("",!0)]),e.replies&&e.replies.length>0?($(),n("div",Ma,[($(!0),n(_,null,f(e.replies,a=>($(),n("div",{key:a.id,class:"reply-item"},[c("img",{src:Ms(a.user_avatar,a.user_id||a.id),class:"reply-avatar clickable",onClick:e=>li(a.user_id)},null,8,ja),c("div",Sa,[c("span",{class:"username clickable",onClick:e=>li(a.user_id)},p(a.user_name),9,Ta),a.is_official?($(),n("span",za,"ÂÆòÊñπ")):r("",!0),a.user_vip_level>0?($(),n("img",{key:1,src:js(a.user_vip_level),class:"vip-badge-tiny"},null,8,La)):r("",!0),c("p",Ba,p(a.content),1),a.image_url?($(),n("div",{key:2,class:"comment-image small",onClick:e=>Ys(a.image_url)},[c("img",{src:a.image_url,alt:"reply image"},null,8,Ea)],8,Ia)):r("",!0),c("div",Pa,[c("span",Va,p(di(a.created_at)),1),c("span",{class:g(["like-btn",{liked:a.is_liked}]),onClick:e=>ti(a)},p(a.is_liked?"‚ù§Ô∏è":"ü§ç")+" "+p(a.like_count||0),11,Da),c("span",{class:"reply-btn",onClick:l=>Ps(e,a)},"ÂõûÂ§ç",8,Ha)])])]))),128)),e.reply_count>e.replies.length?($(),n("div",{key:0,class:"more-replies",onClick:e=>(async()=>{})()}," Â±ïÂºÄÊõ¥Â§ö "+p(e.reply_count-e.replies.length)+" Êù°ÂõûÂ§ç ‚Ä∫ ",9,Ra)):r("",!0)])):r("",!0)])],2))),128))])):($(),n("div",Ua,[...a[24]||(a[24]=[c("p",null,"ËøòÊ≤°ÊúâËØÑËÆ∫ÔºåÂø´Êù•Êä¢Ê≤ôÂèëÂêß~",-1)])])),ss.value||is.value?($(),n("div",Wa,[c("button",{onClick:Es,disabled:is.value,class:"load-more-btn"},[is.value?($(),n("span",Aa,[...a[25]||(a[25]=[c("svg",{viewBox:"0 0 24 24",class:"spin-icon"},[c("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"3",fill:"none","stroke-dasharray":"31.4 31.4"})],-1),d(" Âä†ËΩΩ‰∏≠... ",-1)])])):($(),n("span",Fa," üìú Âä†ËΩΩÊõ¥Â§öËØÑËÆ∫ "))],8,Ya)])):r("",!0),!ss.value&&_l.value.length>0&&!is.value?($(),n("div",qa,[...a[26]||(a[26]=[c("span",null,"‚Äî‚Äî Â∑≤Âä†ËΩΩÂÖ®ÈÉ®ËØÑËÆ∫ ‚Äî‚Äî",-1)])])):r("",!0)]),c("div",Oa,[c("div",Ga,[us.value?($(),n("div",Ja,[c("img",{src:vs.value,alt:"preview"},null,8,Ka),c("span",{class:"remove-image",onClick:Hs},"√ó")])):r("",!0),c("div",Na,[u(c("input",{"onUpdate:modelValue":a[9]||(a[9]=e=>fl.value=e),type:"text",placeholder:ns.value?`ÂõûÂ§ç @${ns.value.user_name}`:"ËØ¥ÁÇπ‰ªÄ‰πàÂêß...",onKeyup:h(ii,["enter"]),ref_key:"commentInputRef",ref:dl},null,40,Qa),[[w,fl.value]]),c("div",Xa,[ns.value?($(),n("span",{key:0,class:"cancel-btn",onClick:Vs},"ÂèñÊ∂à")):r("",!0),c("span",{class:"emoji-btn",onClick:a[10]||(a[10]=e=>rs.value=!rs.value)},"üòä"),c("label",Za,[c("input",{type:"file",accept:"image/*",onChange:Ds,hidden:""},null,32),a[27]||(a[27]=d(" üñºÔ∏è ",-1))]),c("span",{class:g(["send-btn",{disabled:ts.value}]),onClick:ii},[...a[28]||(a[28]=[c("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20"},[c("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})],-1)])],2)])]),rs.value?($(),n("div",el,[c("div",al,[($(),n(_,null,f(ds,e=>c("span",{key:e,class:"emoji-item",onClick:a=>(e=>{var a;fl.value+=e,rs.value=!1,null==(a=dl.value)||a.focus()})(e)},p(e),9,ll)),64))])])):r("",!0)])])],512),[[k,"comments"===yl.value]]),($(),o(m,{to:"body"},[Rs.value?($(),n("div",{key:0,class:"lightbox-overlay",onClick:v(As,["self"])},[c("div",sl,[c("button",{class:"lightbox-close",onClick:As},"‚úï"),c("img",{src:Us.value,class:"lightbox-image",style:b({transform:`scale(${Ws.value})`}),onClick:a[11]||(a[11]=v(()=>{},["stop"]))},null,12,il),c("div",tl,[c("button",{class:"control-btn",onClick:qs,title:"Áº©Â∞è"},[...a[29]||(a[29]=[c("svg",{viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor"},[c("path",{d:"M19 13H5v-2h14v2z"})],-1)])]),c("button",{class:"control-btn",onClick:Os,title:"ÈáçÁΩÆ"},p(Math.round(100*Ws.value))+"% ",1),c("button",{class:"control-btn",onClick:Fs,title:"ÊîæÂ§ß"},[...a[30]||(a[30]=[c("svg",{viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor"},[c("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})],-1)])])])])])):r("",!0)]))]))}},[["__scopeId","data-v-ba4b5e15"]]);export{nl as default};
