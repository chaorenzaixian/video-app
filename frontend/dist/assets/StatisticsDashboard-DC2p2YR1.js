/* empty css             *//* empty css                             *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                       *//* empty css                        */import{_ as a,a as s}from"./index-C3P4JTuA.js";import{bf as l,bl as e,bD as t,bg as i,bm as n,b6 as c}from"./element-plus-DlIn_qXi.js";import{r,j as d,y as u,C as o,L as v,O as m,F as p,I as h,M as y,aa as k,n as g,z as w,K as b,H as f}from"./vue-vendor-Ba_vealp.js";import"./utils-DflAyOWx.js";const _={class:"admin-page"},j={class:"kpi-row"},V={class:"kpi-card"},x={class:"kpi-content"},C={class:"kpi-value"},T={class:"kpi-change up"},z={class:"kpi-card"},M={class:"kpi-content"},H={class:"kpi-value"},L={class:"kpi-card"},O={class:"kpi-content"},S={class:"kpi-value"},U={class:"kpi-card highlight"},I={class:"kpi-content"},$={class:"kpi-value"},D={class:"kpi-change"},F={class:"charts-row"},E={class:"chart-card"},K={class:"chart-header"},P={class:"chart-body"},R={class:"chart-card"},B={class:"chart-header"},q={class:"chart-body"},A={class:"rankings-row"},G={class:"ranking-card"},J={class:"ranking-header"},N={class:"ranking-body"},Q={class:"item-cover"},W=["src"],X={class:"item-info"},Y={class:"item-title"},Z={class:"item-meta"},aa={class:"item-value"},sa={key:0,class:"empty-state"},la={class:"ranking-card"},ea={class:"ranking-header"},ta={class:"ranking-body"},ia={class:"item-info"},na={class:"item-title"},ca={class:"item-meta"},ra={class:"item-value"},da={key:0,class:"empty-state"},ua={class:"summary-card"},oa={class:"summary-header"},va={class:"summary-body"},ma={class:"summary-item"},pa={class:"summary-info"},ha={class:"summary-value"},ya={class:"summary-meta"},ka={class:"summary-item"},ga={class:"summary-info"},wa={class:"summary-value"},ba={class:"summary-meta"},fa={class:"summary-item"},_a={class:"summary-info"},ja={class:"summary-value"},Va={class:"summary-meta"},xa=a({__name:"StatisticsDashboard",setup(a){const xa=r({}),Ca=r(7),Ta=r(7),za=r(7),Ma=r("income"),Ha=r(null),La=r(null),Oa=r(null),Sa=r([]),Ua=r([]),Ia=r([]),$a=r([]),Da=r({}),Fa=a=>a>=1e4?(a/1e4).toFixed(1)+"w":a>=1e3?(a/1e3).toFixed(1)+"k":a,Ea=async()=>{try{const a=await s.get("/admin/statistics/revenue/chart",{params:{days:Ca.value}});Sa.value=a.data||[],await g(),qa()}catch(a){Sa.value=[]}},Ka=async()=>{try{const a=await s.get("/admin/statistics/users/chart",{params:{days:Ta.value}});Ua.value=a.data||[],await g(),Aa()}catch(a){Ua.value=[]}},Pa=async()=>{try{const a=await s.get("/admin/statistics/videos/top",{params:{days:za.value,limit:10}});Ia.value=a.data||[]}catch(a){Ia.value=[]}},Ra=async()=>{try{const a=await s.get("/admin/statistics/creators/top",{params:{metric:Ma.value,limit:10}});$a.value=a.data||[]}catch(a){$a.value=[]}},Ba=async()=>{var a,l,e,t;try{const i={};Ha.value&&(i.start_date=null==(l=null==(a=Ha.value[0])?void 0:a.toISOString())?void 0:l.split("T")[0],i.end_date=null==(t=null==(e=Ha.value[1])?void 0:e.toISOString())?void 0:t.split("T")[0]);const n=await s.get("/admin/statistics/transactions/summary",{params:i});Da.value=n.data}catch(i){Da.value={}}},qa=()=>{if(!La.value)return;const a=La.value,s=Sa.value;if(0===s.length)return void(a.innerHTML='<div class="chart-empty">æš‚æ— æ•°æ®</div>');const l=Math.max(...s.map(a=>a.amount))||1;let e='<div class="simple-chart">';s.forEach(a=>{const s=a.amount/l*100;e+=`\n      <div class="chart-bar-wrapper">\n        <div class="chart-bar" style="height: ${s}%"></div>\n        <span class="chart-label">${a.date.slice(5)}</span>\n      </div>\n    `}),e+="</div>",a.innerHTML=e},Aa=()=>{if(!Oa.value)return;const a=Oa.value,s=Ua.value;if(0===s.length)return void(a.innerHTML='<div class="chart-empty">æš‚æ— æ•°æ®</div>');const l=Math.max(...s.map(a=>a.new_users))||1;let e='<div class="simple-chart">';s.forEach(a=>{const s=a.new_users/l*100;e+=`\n      <div class="chart-bar-wrapper">\n        <div class="chart-bar users" style="height: ${s}%"></div>\n        <span class="chart-label">${a.date.slice(5)}</span>\n      </div>\n    `}),e+="</div>",a.innerHTML=e};return d(async()=>{await(async()=>{try{const a=await s.get("/admin/statistics/overview");xa.value=a.data}catch(a){}})(),await Ea(),await Ka(),await Pa(),await Ra(),await Ba()}),(a,s)=>{var r,d,g,Sa,Ua,qa,Aa,Ga,Ja,Na,Qa,Wa,Xa;const Ya=i,Za=l,as=n,ss=e,ls=c,es=t;return w(),u("div",_,[s[28]||(s[28]=o("div",{class:"page-header"},[o("h1",null,"æ•°æ®ç»Ÿè®¡"),o("p",{class:"page-desc"},"å¹³å°æ ¸å¿ƒæ•°æ®æŒ‡æ ‡æ¦‚è§ˆä¸åˆ†æ")],-1)),o("div",j,[o("div",V,[s[6]||(s[6]=o("div",{class:"kpi-icon users"},"ğŸ‘¥",-1)),o("div",x,[o("span",C,v((null==(r=xa.value.users)?void 0:r.total)||0),1),s[5]||(s[5]=o("span",{class:"kpi-label"},"æ€»ç”¨æˆ·æ•°",-1)),o("span",T,"ä»Šæ—¥ +"+v((null==(d=xa.value.users)?void 0:d.today)||0),1)])]),o("div",z,[s[8]||(s[8]=o("div",{class:"kpi-icon videos"},"ğŸ¬",-1)),o("div",M,[o("span",H,v((null==(g=xa.value.videos)?void 0:g.total)||0),1),s[7]||(s[7]=o("span",{class:"kpi-label"},"è§†é¢‘æ€»æ•°",-1))])]),o("div",L,[s[10]||(s[10]=o("div",{class:"kpi-icon creators"},"âœ¨",-1)),o("div",O,[o("span",S,v((null==(Sa=xa.value.creators)?void 0:Sa.total)||0),1),s[9]||(s[9]=o("span",{class:"kpi-label"},"åˆ›ä½œè€…æ•°",-1))])]),o("div",U,[s[12]||(s[12]=o("div",{class:"kpi-icon revenue"},"ğŸ’°",-1)),o("div",I,[o("span",$,"Â¥"+v((null==(Ua=xa.value.revenue)?void 0:Ua.today_recharge)||0),1),s[11]||(s[11]=o("span",{class:"kpi-label"},"ä»Šæ—¥å……å€¼",-1)),o("span",D,"æœ¬æœˆ Â¥"+v((null==(qa=xa.value.revenue)?void 0:qa.month_recharge)||0),1)])])]),o("div",F,[o("div",E,[o("div",K,[s[15]||(s[15]=o("h3",null,"æ”¶å…¥è¶‹åŠ¿",-1)),m(Za,{modelValue:Ca.value,"onUpdate:modelValue":s[0]||(s[0]=a=>Ca.value=a),size:"small",onChange:Ea},{default:p(()=>[m(Ya,{label:7},{default:p(()=>[...s[13]||(s[13]=[b("è¿‘7å¤©",-1)])]),_:1}),m(Ya,{label:30},{default:p(()=>[...s[14]||(s[14]=[b("è¿‘30å¤©",-1)])]),_:1})]),_:1},8,["modelValue"])]),o("div",P,[o("div",{ref_key:"revenueChartRef",ref:La,class:"chart-container"},null,512)])]),o("div",R,[o("div",B,[s[18]||(s[18]=o("h3",null,"ç”¨æˆ·å¢é•¿",-1)),m(Za,{modelValue:Ta.value,"onUpdate:modelValue":s[1]||(s[1]=a=>Ta.value=a),size:"small",onChange:Ka},{default:p(()=>[m(Ya,{label:7},{default:p(()=>[...s[16]||(s[16]=[b("è¿‘7å¤©",-1)])]),_:1}),m(Ya,{label:30},{default:p(()=>[...s[17]||(s[17]=[b("è¿‘30å¤©",-1)])]),_:1})]),_:1},8,["modelValue"])]),o("div",q,[o("div",{ref_key:"usersChartRef",ref:Oa,class:"chart-container"},null,512)])])]),o("div",A,[o("div",G,[o("div",J,[s[19]||(s[19]=o("h3",null,"ğŸ”¥ çƒ­é—¨è§†é¢‘ TOP10",-1)),m(ss,{modelValue:za.value,"onUpdate:modelValue":s[2]||(s[2]=a=>za.value=a),size:"small",onChange:Pa,style:{width:"100px"}},{default:p(()=>[m(as,{label:"è¿‘7å¤©",value:7}),m(as,{label:"è¿‘30å¤©",value:30})]),_:1},8,["modelValue"])]),o("div",N,[(w(!0),u(y,null,k(Ia.value,(a,s)=>(w(),u("div",{key:a.id,class:"ranking-item"},[o("span",{class:f(["rank",{top3:s<3}])},v(s+1),3),o("div",Q,[o("img",{src:a.cover_url||"/images/default-cover.webp",alt:""},null,8,W)]),o("div",X,[o("span",Y,v(a.title),1),o("span",Z,"æ’­æ”¾ "+v(Fa(a.view_count)),1)]),o("span",aa,v(Fa(a.view_count)),1)]))),128)),0===Ia.value.length?(w(),u("div",sa,"æš‚æ— æ•°æ®")):h("",!0)])]),o("div",la,[o("div",ea,[s[20]||(s[20]=o("h3",null,"ğŸ‘‘ åˆ›ä½œè€…æ”¶ç›Šæ¦œ TOP10",-1)),m(ss,{modelValue:Ma.value,"onUpdate:modelValue":s[3]||(s[3]=a=>Ma.value=a),size:"small",onChange:Ra,style:{width:"100px"}},{default:p(()=>[m(as,{label:"æ”¶ç›Š",value:"income"}),m(as,{label:"ç²‰ä¸",value:"followers"}),m(as,{label:"è§†é¢‘",value:"videos"})]),_:1},8,["modelValue"])]),o("div",ta,[(w(!0),u(y,null,k($a.value,(a,s)=>(w(),u("div",{key:a.id,class:"ranking-item"},[o("span",{class:f(["rank",{top3:s<3}])},v(s+1),3),m(ls,{size:36,src:a.avatar},null,8,["src"]),o("div",ia,[o("span",na,v(a.display_name||a.nickname),1),o("span",ca,["income"===Ma.value?(w(),u(y,{key:0},[b("ç²‰ä¸ "+v(a.total_followers),1)],64)):"followers"===Ma.value?(w(),u(y,{key:1},[b("è§†é¢‘ "+v(a.total_videos),1)],64)):(w(),u(y,{key:2},[b("ç²‰ä¸ "+v(a.total_followers),1)],64))])]),o("span",ra,["income"===Ma.value?(w(),u(y,{key:0},[b(v(a.total_income)+" é‡‘å¸",1)],64)):"followers"===Ma.value?(w(),u(y,{key:1},[b(v(a.total_followers),1)],64)):(w(),u(y,{key:2},[b(v(a.total_videos)+" ä¸ª",1)],64))])]))),128)),0===$a.value.length?(w(),u("div",da,"æš‚æ— æ•°æ®")):h("",!0)])])]),o("div",ua,[o("div",oa,[s[21]||(s[21]=o("h3",null,"ğŸ“Š äº¤æ˜“æ±‡æ€»",-1)),m(es,{modelValue:Ha.value,"onUpdate:modelValue":s[4]||(s[4]=a=>Ha.value=a),type:"daterange","start-placeholder":"å¼€å§‹æ—¥æœŸ","end-placeholder":"ç»“æŸæ—¥æœŸ",size:"small",onChange:Ba,style:{width:"240px"}},null,8,["modelValue"])]),o("div",va,[o("div",ma,[s[23]||(s[23]=o("div",{class:"summary-icon recharge"},"ğŸ’³",-1)),o("div",pa,[s[22]||(s[22]=o("span",{class:"summary-label"},"å……å€¼æ”¶å…¥",-1)),o("span",ha,"Â¥"+v((null==(Aa=Da.value.recharge)?void 0:Aa.total)||0),1),o("span",ya,v((null==(Ga=Da.value.recharge)?void 0:Ga.orders)||0)+" ç¬”è®¢å• Â· "+v((null==(Ja=Da.value.recharge)?void 0:Ja.users)||0)+" äºº",1)])]),o("div",ka,[s[25]||(s[25]=o("div",{class:"summary-icon tips"},"ğŸ",-1)),o("div",ga,[s[24]||(s[24]=o("span",{class:"summary-label"},"æ‰“èµæµæ°´",-1)),o("span",wa,v((null==(Na=Da.value.tips)?void 0:Na.total_coins)||0)+" é‡‘å¸",1),o("span",ba,v((null==(Qa=Da.value.tips)?void 0:Qa.count)||0)+" æ¬¡æ‰“èµ",1)])]),o("div",fa,[s[27]||(s[27]=o("div",{class:"summary-icon withdrawal"},"ğŸ’¸",-1)),o("div",_a,[s[26]||(s[26]=o("span",{class:"summary-label"},"åˆ›ä½œè€…æç°",-1)),o("span",ja,"Â¥"+v((null==(Wa=Da.value.withdrawals)?void 0:Wa.total)||0),1),o("span",Va,v((null==(Xa=Da.value.withdrawals)?void 0:Xa.count)||0)+" ç¬”",1)])])])])])}}},[["__scopeId","data-v-de015b34"]]);export{xa as default};
