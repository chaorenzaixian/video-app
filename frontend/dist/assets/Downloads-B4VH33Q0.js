import{_ as e}from"./ic_back-BPdSG6fy.js";import{_ as a}from"./no_data-CMy5glMK.js";import{r as l,c as s,j as t,y as i,C as o,I as n,L as c,M as u,aa as d,H as v,aC as r,z as p}from"./vue-vendor-Ba_vealp.js";import{_ as k}from"./index-C3P4JTuA.js";import{E as h}from"./element-plus-DlIn_qXi.js";import"./utils-DflAyOWx.js";const m={class:"downloads-page"},g={class:"page-header"},y={class:"tabs"},f=["onClick"],b={class:"content"},w={key:0,class:"download-list"},C=["onClick"],_={key:0,viewBox:"0 0 24 24",fill:"currentColor"},M=["onClick"],x=["src"],j={key:0,class:"play-overlay"},S={key:1,class:"duration"},z={key:2,class:"views"},$={class:"info"},I={class:"title"},L={class:"meta"},B={class:"type-tag"},D={key:0,class:"size"},O={class:"progress-section"},J={class:"time"},N={key:1,class:"empty-state"},E={key:0,class:"bottom-bar"},F={key:0,viewBox:"0 0 24 24",fill:"currentColor"},H=k({__name:"Downloads",setup(k){const H=r(),T=[{key:"all",label:"全部"},{key:"video",label:"影视"},{key:"short",label:"短视频"}],q=l("all"),A=l(!1),G=l([]),K=l([]),P=s(()=>"all"===q.value?K.value:K.value.filter(e=>e.type===q.value)),Q=s(()=>P.value.length>0&&G.value.length===P.value.length),R=()=>{A.value=!A.value,A.value||(G.value=[])},U=()=>{Q.value?G.value=[]:G.value=P.value.map(e=>e.id)},V=()=>{0!==G.value.length?(K.value=K.value.filter(e=>!G.value.includes(e.id)),(()=>{try{localStorage.setItem("video_downloads",JSON.stringify(K.value))}catch(e){}})(),G.value=[],h.success("删除成功")):h.warning("请选择要删除的项目")},W=e=>{if(!e)return"";return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`},X=e=>{if(!e)return"";const a=new Date(e),l=new Date-a;return l<6e4?"刚刚":l<36e5?Math.floor(l/6e4)+"分钟前":l<864e5?Math.floor(l/36e5)+"小时前":l<6048e5?Math.floor(l/864e5)+"天前":`${a.getMonth()+1}/${a.getDate()}`};return t(()=>{(()=>{try{const e=localStorage.getItem("video_downloads");e&&(K.value=JSON.parse(e))}catch(e){K.value=[]}})()}),(l,s)=>(p(),i("div",m,[o("header",g,[o("div",{class:"back-btn",onClick:s[0]||(s[0]=e=>l.$router.back())},[...s[1]||(s[1]=[o("img",{src:e,alt:"返回",class:"back-icon"},null,-1)])]),s[2]||(s[2]=o("h1",{class:"page-title"},"下载缓存",-1)),o("div",{class:"header-right",onClick:R},c(A.value?"完成":"编辑"),1)]),o("div",y,[(p(),i(u,null,d(T,e=>o("div",{key:e.key,class:v(["tab-item",{active:q.value===e.key}]),onClick:a=>q.value=e.key},c(e.label),11,f)),64))]),o("div",b,[P.value.length>0?(p(),i("div",w,[(p(!0),i(u,null,d(P.value,e=>{return p(),i("div",{key:e.id,class:"download-item"},[A.value?(p(),i("div",{key:0,class:"checkbox",onClick:a=>(e=>{const a=G.value.indexOf(e.id);a>-1?G.value.splice(a,1):G.value.push(e.id)})(e)},[o("div",{class:v(["check-box",{checked:G.value.includes(e.id)}])},[G.value.includes(e.id)?(p(),i("svg",_,[...s[3]||(s[3]=[o("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},null,-1)])])):n("",!0)],2)],8,C)):n("",!0),o("div",{class:"thumbnail",onClick:a=>(e=>{A.value||("short"===e.type?H.push(`/shorts/${e.videoId}`):H.push(`/user/video/${e.videoId}`))})(e)},[o("img",{src:e.thumbnail||"/images/backgrounds/no_data.webp",alt:""},null,8,x),"completed"!==e.status?(p(),i("div",j,[s[4]||(s[4]=o("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[o("path",{d:"M8 5v14l11-7z"})],-1)),o("span",null,c("downloading"===e.status?"下载中":"已暂停"),1)])):n("",!0),e.duration?(p(),i("span",S,c(W(e.duration)),1)):n("",!0),e.views?(p(),i("span",z,c((l=e.views,l?l>=1e4?(l/1e4).toFixed(1)+"w":l:"")),1)):n("",!0)],8,M),o("div",$,[o("h3",I,c(e.title),1),o("div",L,[o("span",B,c("short"===e.type?"短视频":"影视"),1),e.fileSize?(p(),i("span",D,c(e.fileSize)+"MB",1)):n("",!0)]),o("div",O,[o("span",{class:v(["status",e.status])},c((a=e.status,{downloading:"下载中",paused:"已暂停",completed:"已完成",failed:"下载失败"}[a]||a)),3),o("span",J,c(X(e.downloadTime)),1)])])]);var a,l}),128))])):(p(),i("div",N,[...s[5]||(s[5]=[o("img",{src:a,alt:""},null,-1),o("p",null,"当前页面暂无内容～",-1)])]))]),A.value&&P.value.length>0?(p(),i("div",E,[o("div",{class:"select-all",onClick:U},[o("div",{class:v(["check-box",{checked:Q.value}])},[Q.value?(p(),i("svg",F,[...s[6]||(s[6]=[o("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},null,-1)])])):n("",!0)],2),s[7]||(s[7]=o("span",null,"全选",-1))]),o("button",{class:"delete-btn",onClick:V},"删除")])):n("",!0)]))}},[["__scopeId","data-v-2ed2d107"]]);export{H as default};
