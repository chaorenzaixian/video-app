import{_ as e,a,u as i}from"./index-C3P4JTuA.js";import{u as s}from"./useAbortController-pf-gfr0d.js";import{u as n}from"./useDebounce-CYVAMXBc.js";import{B as l}from"./BottomNav-CoGs_HZ2.js";import{I as t}from"./IconAdsGrid-DwXH5auI.js";import{y as c,C as r,I as o,L as p,z as v,H as d,aD as u,M as m,U as g,aa as h,aC as _,r as y,c as b,j as f,X as k,O as x,E as w,u as L,n as C}from"./vue-vendor-Ba_vealp.js";import{a as M}from"./utils-DflAyOWx.js";import{g as I}from"./avatar-DXHBWedi.js";import{c as U}from"./format-s96t4k9e.js";import{g as $,b as j}from"./vip-C8N2TCfr.js";import{E as B}from"./element-plus-DlIn_qXi.js";const V={class:"page-header"},z={class:"header-left"},H={key:0,class:"notification-badge"},S={class:"header-right"},q=e({__name:"UserHeader",props:{unreadCount:{type:Number,default:0}},setup:e=>(a,i)=>(v(),c("header",V,[r("div",z,[r("div",{class:"notification-wrapper",onClick:i[0]||(i[0]=e=>a.$router.push("/user/messages"))},[i[3]||(i[3]=r("img",{src:"/images/backgrounds/mine_notification.webp",class:"header-icon-img",alt:"通知"},null,-1)),e.unreadCount>0?(v(),c("span",H,p(e.unreadCount>99?"99+":e.unreadCount),1)):o("",!0)])]),r("div",S,[r("img",{src:"/images/backgrounds/ic_service.webp",class:"header-icon-img",alt:"客服",onClick:i[1]||(i[1]=e=>a.$router.push("/user/customer-service"))}),r("img",{src:"/images/backgrounds/ic_setting.webp",class:"header-icon-img",alt:"设置",onClick:i[2]||(i[2]=e=>a.$router.push("/user/settings"))})])]))},[["__scopeId","data-v-b14125f3"]]),A={class:"user-section"},N={class:"user-row"},D={class:"avatar-wrapper"},P={class:"avatar-frame"},E=["src"],O={key:0,class:"vip-crown"},T={class:"user-info"},G={class:"nickname-row"},Q={class:"nickname"},X=["src","alt"],Z={class:"user-id-row"},F={class:"user-id"},J=e({__name:"UserInfo",props:{user:{type:Object,default:()=>({})},avatarUrl:{type:String,default:""},vipLevelIcon:{type:String,default:""},vipLevelName:{type:String,default:""},loading:{type:Boolean,default:!1},signingIn:{type:Boolean,default:!1}},emits:["copy","sign"],setup:e=>(a,i)=>(v(),c("div",A,[r("div",N,[r("div",D,[r("div",{class:d(["avatar-container",{"is-vip":e.user.is_vip}])},[r("div",P,[r("img",{src:e.avatarUrl,class:"user-avatar"},null,8,E)]),e.user.is_vip?(v(),c("div",O,[...i[2]||(i[2]=[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5zm14 3c0 .6-.4 1-1 1H6c-.6 0-1-.4-1-1v-1h14v1z"})],-1)])])):o("",!0),i[3]||(i[3]=r("div",{class:"gender-icon"},"♂",-1))],2)]),r("div",T,[r("div",G,[r("h2",Q,p(e.loading?"加载中...":e.user.nickname||e.user.username||"未登录"),1),e.user.vip_level>0?(v(),c("img",{key:0,src:e.vipLevelIcon,class:"vip-level-badge-inline",alt:e.vipLevelName},null,8,X)):o("",!0)]),r("div",Z,[r("span",F,p(e.loading?"--------":e.user.username),1),!e.loading&&e.user.username?(v(),c("svg",{key:0,class:"copy-btn",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",onClick:i[0]||(i[0]=e=>a.$emit("copy"))},[...i[4]||(i[4]=[r("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),r("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])):o("",!0)])]),r("div",{class:d(["sign-btn",{disabled:e.signingIn}]),onClick:i[1]||(i[1]=e=>a.$emit("sign"))},[i[5]||(i[5]=r("img",{src:"/images/backgrounds/ic_sign.webp",class:"sign-icon-img",alt:"签到"},null,-1)),r("span",null,p(e.signingIn?"签到中...":"签到"),1)],2)]),i[6]||(i[6]=r("div",{class:"stats-row",style:{height:"50px"}},null,-1))]))},[["__scopeId","data-v-9bd4fba1"]]),K={class:"vip-left"},R={class:"vip-member-content"},W=["src","alt"],Y={class:"vip-expire-inline"},ee=e({__name:"VipBanner",props:{isVip:{type:Boolean,default:!1},vipLevel:{type:Number,default:0},vipLevelIcon:{type:String,default:""},vipLevelName:{type:String,default:""},expireDate:{type:String,default:""}},setup:e=>(a,i)=>(v(),c("div",{class:"vip-banner",onClick:i[1]||(i[1]=e=>a.$router.push("/user/vip"))},[i[4]||(i[4]=u('<div class="vip-stars" data-v-eda2e349><span class="star s1" data-v-eda2e349>✦</span><span class="star s2" data-v-eda2e349>✦</span><span class="star s3" data-v-eda2e349>✦</span><span class="star s4" data-v-eda2e349>✦</span></div>',1)),e.isVip?(v(),c(m,{key:1},[r("div",K,[r("div",R,[e.vipLevel>0?(v(),c("img",{key:0,src:e.vipLevelIcon,class:"vip-icon-inline",alt:e.vipLevelName},null,8,W)):o("",!0),r("span",Y,"到期时间："+p(e.expireDate||"永久"),1)])]),r("div",{class:"vip-btn",onClick:i[0]||(i[0]=g(e=>a.$router.push("/user/vip"),["stop"]))},[...i[3]||(i[3]=[r("span",null,"升级会员",-1),r("div",{class:"arrow-circle"},[r("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})])],-1)])])],64)):(v(),c(m,{key:0},[i[2]||(i[2]=u('<div class="vip-left" data-v-eda2e349><span class="vip-text" data-v-eda2e349><span class="text-gradient" data-v-eda2e349>开通会员</span><span class="text-gradient-light" data-v-eda2e349>享专属特权</span></span></div><div class="vip-btn" data-v-eda2e349><span data-v-eda2e349>开通会员</span><div class="arrow-circle" data-v-eda2e349><svg viewBox="0 0 24 24" fill="currentColor" data-v-eda2e349><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" data-v-eda2e349></path></svg></div></div>',2))],64))]))},[["__scopeId","data-v-eda2e349"]]),ae={class:"quick-menu"},ie=e({__name:"QuickMenu",emits:["coming-soon"],setup:e=>(e,a)=>(v(),c("div",ae,[r("div",{class:"quick-item",onClick:a[0]||(a[0]=a=>e.$router.push("/user/history"))},[...a[4]||(a[4]=[r("div",{class:"quick-icon-img"},[r("img",{src:"/images/backgrounds/ic_history.webp",alt:"观看记录"})],-1),r("span",null,"观看记录",-1)])]),r("div",{class:"quick-item",onClick:a[1]||(a[1]=a=>e.$router.push("/user/favorites"))},[...a[5]||(a[5]=[r("div",{class:"quick-icon-img"},[r("img",{src:"/images/backgrounds/ic_collect.webp",alt:"我的收藏"})],-1),r("span",null,"我的收藏",-1)])]),r("div",{class:"quick-item",onClick:a[2]||(a[2]=a=>e.$router.push("/user/purchases"))},[...a[6]||(a[6]=[r("div",{class:"quick-icon-img"},[r("img",{src:"/images/backgrounds/ic_buy.webp",alt:"我的购买"})],-1),r("span",null,"我的购买",-1)])]),r("div",{class:"quick-item",onClick:a[3]||(a[3]=a=>e.$emit("coming-soon"))},[...a[7]||(a[7]=[r("div",{class:"quick-icon-img"},[r("img",{src:"/images/backgrounds/ic_ai.webp",alt:"AI女友"})],-1),r("span",null,"AI女友",-1)])])]))},[["__scopeId","data-v-79f2ba37"]]),se={class:"menu-section"},ne=["onClick"],le=["innerHTML"],te={class:"menu-text"},ce=e({__name:"MenuList",emits:["check-update"],setup(e,{emit:a}){const i=_(),s=a,n=[{path:"/user/creator-center",label:"创作中心",icon:'<rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/>'},{path:"/user/follows",label:"关注/粉丝",icon:'<path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>'},{path:"/user/account-credential",label:"账号凭证",icon:'<rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M9 16l2 2 4-4"/>'},{path:"/user/lock",label:"锁屏密码",icon:'<rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/>'},{path:"/user/invite-share",label:"邀请分享",icon:'<circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>'},{path:"/user/promotion",label:"推广中心",icon:'<path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>',badge:{text:"赚VIP",type:"hot"}},{path:"/user/downloads",label:"我的下载",icon:'<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/>'},{path:"/user/likes",label:"我的喜欢",icon:'<path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>'},{path:"/user/redeem",label:"领取兑换",icon:'<path d="M21 5H3a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z"/><path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0-6 0"/><path d="M3 9h2M19 9h2M3 15h2M19 15h2"/>'},{path:"/user/app-recommend",label:"应用推荐",icon:'<circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/>'},{path:"/user/customer-service",label:"联系客服",icon:'<path d="M3 18v-6a9 9 0 0 1 18 0v6"/><path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"/>'},{path:"/user/groups",label:"官方群组",icon:'<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>'},{path:"check-update",label:"检查更新",icon:'<polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>'}];return(e,a)=>(v(),c("div",se,[(v(),c(m,null,h(n,e=>r("div",{key:e.path,class:"menu-row",onClick:a=>(e=>{"check-update"===e.path?s("check-update"):i.push(e.path)})(e)},[(v(),c("svg",{class:"menu-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",innerHTML:e.icon},null,8,le)),r("span",te,p(e.label),1),e.badge?(v(),c("span",{key:0,class:d(["menu-badge",e.badge.type])},p(e.badge.text),3)):o("",!0),a[0]||(a[0]=r("svg",{class:"menu-arrow",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})],-1))],8,ne)),64))]))}},[["__scopeId","data-v-2442ec84"]]);const re={class:"card-grid"},oe={class:"desktop-icon-section"},pe={class:"icon-options"},ve=["onClick"],de=["src","alt"],ue=e(Object.assign({name:"UserProfile"},{__name:"index",setup(e){const u=i(),{signal:g}=s(),_=y(null),V=y(!1),{execute:z,loading:H}=n(async()=>{var e;return(null==(e=(await a.post("/points/tasks/checkin",null,{signal:g})).data)?void 0:e.points)||0}),{user:S,iconAds:A,isLoading:N,unreadMessageCount:D,avatarUrl:P,vipLevelIcon:E,vipLevelName:O,formattedExpireDate:T,initUserData:G,fetchUserVipInfo:Q,fetchIconAds:X,fetchUnreadCount:Z}=function(e){const i=y({id:"",username:"",nickname:"",avatar:"",is_vip:!1,vip_level:0,vip_level_name:"非VIP",vip_expire_date:null}),s=y([]),n=y(!0),l=y(0),t=b(()=>I(i.value.avatar,i.value.id)),c=b(()=>$(i.value.vip_level)),r=b(()=>i.value.vip_level_name||j(i.value.vip_level)),o=b(()=>i.value.vip_expire_date?U(i.value.vip_expire_date):"");return{user:i,iconAds:s,isLoading:n,unreadMessageCount:l,avatarUrl:t,vipLevelIcon:c,vipLevelName:r,formattedExpireDate:o,initUserData:e=>{e&&(i.value={id:e.id||"",username:e.username||"",nickname:e.nickname||e.username||"",avatar:e.avatar||"",is_vip:e.is_vip||!1,vip_level:e.vip_level||0,vip_level_name:e.vip_level_name||"非VIP",vip_expire_date:e.vip_expire_date||null}),n.value=!1},fetchUserVipInfo:async()=>{if(i.value.id)try{const s=await a.get("/users/me",{signal:e}),n=s.data||s;n&&(i.value.is_vip=n.is_vip||!1,i.value.vip_level=n.vip_level||0,i.value.vip_level_name=n.vip_level_name||"非VIP",i.value.vip_expire_date=n.vip_expire_date||null)}catch(s){"CanceledError"!==s.name&&s.name}},fetchIconAds:async()=>{try{const e=await M.get("/api/v1/ads/icons");s.value=(e.data||[]).filter(e=>!1!==e.is_active)}catch(e){}},fetchUnreadCount:async()=>{var i;try{const s=await a.get("/notifications/unread-count",{signal:e});l.value=(null==(i=s.data)?void 0:i.total)||0}catch(s){}}}}(g),F=y("icon_0"),K=y([{id:"icon_0",name:"SOUL",image:"/images/app_icon/icon_0.webp"},{id:"icon_1",name:"爱音乐",image:"/images/app_icon/icon_1.webp"},{id:"icon_2",name:"爱阅读",image:"/images/app_icon/icon_2.webp"},{id:"icon_3",name:"支付宝",image:"/images/app_icon/icon_3.webp"},{id:"icon_4",name:"哔哩哔哩",image:"/images/app_icon/icon_4.webp"},{id:"icon_5",name:"饼干大作战",image:"/images/app_icon/icon_5.webp"},{id:"icon_6",name:"美食借鉴",image:"/images/app_icon/icon_6.webp"},{id:"icon_7",name:"我的世界",image:"/images/app_icon/icon_7.webp"}]),R=()=>{navigator.clipboard&&S.value.username&&(navigator.clipboard.writeText(String(S.value.username)),B.success("账号已复制"))},W=async()=>{var e,a;try{const e=await z();null!==e&&(B.success(`签到成功！获得 ${e} 积分`),Q())}catch(i){const s=(null==(a=null==(e=i.response)?void 0:e.data)?void 0:a.detail)||"";s.includes("已签到")||s.includes("已完成")?B.warning("今日已签到，请明天再来~"):s&&B.error(s)}},Y=()=>{B.success("当前已是最新版本 v1.0.0")},ae=()=>{B.info("正在开发中，敬请期待")},se=()=>{F.value="icon_0",B.success("已恢复默认图标")};return f(()=>{(async()=>{if(V.value)return;V.value=!0;const e=[X(),Z()];u.isLoggedIn&&u.user?(G(u.user),e.push(Q())):N.value=!1,await Promise.allSettled(e)})()}),k(async()=>{await C(),_.value&&(_.value.scrollTop=0),V.value&&Z()}),(e,a)=>(v(),c("div",{class:"profile-page",ref_key:"scrollContainer",ref:_},[a[4]||(a[4]=r("div",{class:"profile-bg"},[r("img",{src:"/images/backgrounds/profile_bg.webp",alt:""}),r("div",{class:"bg-overlay"})],-1)),x(q,{"unread-count":L(D)},null,8,["unread-count"]),x(J,{user:L(S),"avatar-url":L(P),"vip-level-icon":L(E),"vip-level-name":L(O),loading:L(N),"signing-in":L(H),onCopy:R,onSign:W},null,8,["user","avatar-url","vip-level-icon","vip-level-name","loading","signing-in"]),x(ee,{"is-vip":L(S).is_vip,"vip-level":L(S).vip_level,"vip-level-icon":L(E),"vip-level-name":L(O),"expire-date":L(T)},null,8,["is-vip","vip-level","vip-level-icon","vip-level-name","expire-date"]),r("div",re,[r("div",{class:"feature-card card-vip",onClick:a[0]||(a[0]=a=>e.$router.push("/user/vip"))}),r("div",{class:"feature-card card-wallet",onClick:a[1]||(a[1]=a=>e.$router.push("/user/coins"))}),r("div",{class:"feature-card card-agent",onClick:a[2]||(a[2]=a=>e.$router.push("/user/agent"))})]),x(ie,{onComingSoon:ae}),L(A).length>0?(v(),w(t,{key:0,ads:L(A)},null,8,["ads"])):o("",!0),x(ce,{onCheckUpdate:Y}),r("div",oe,[r("div",{class:"section-header"},[a[3]||(a[3]=r("span",{class:"section-title"},"设置桌面图标",-1)),r("span",{class:"reset-btn",onClick:se},"恢复默认")]),r("div",pe,[(v(!0),c(m,null,h(K.value,e=>(v(),c("div",{key:e.id,class:d(["icon-option",{active:F.value===e.id}]),onClick:a=>{return i=e.id,F.value=i,void B.success("桌面图标已更换");var i}},[r("img",{src:e.image,alt:e.name,class:"icon-img"},null,8,de),r("span",null,p(e.name),1)],10,ve))),128))])]),x(l)],512))}}),[["__scopeId","data-v-0f71b729"]]);export{ue as default};
