/* empty css             *//* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                   *//* empty css                  *//* empty css                  *//* empty css                             *//* empty css                    *//* empty css                 */import{r as e,l as a,j as l,y as t,C as s,O as n,F as i,ae as o,G as d,E as r,z as c,K as u,u as p,L as m,I as _}from"./vue-vendor-Ba_vealp.js";import{_ as g}from"./god_comment-Dp4lzx7s.js";import{bz as y,aT as v,bl as f,bD as b,aM as h,bs as w,bt as k,E as j,bh as z,bA as C,bJ as $,aQ as x,aJ as V,bm as S,bi as D,bj as R,b6 as Y,br as M,aL as U,a as J}from"./element-plus-DlIn_qXi.js";import{_ as E,a as I}from"./index-C3P4JTuA.js";import"./utils-DflAyOWx.js";const G={class:"unified-comments-page"},K={class:"filter-bar"},L={class:"table-container"},P={class:"user-cell"},T={class:"user-info"},F={class:"username"},H={class:"user-id"},O={class:"content-cell"},A={class:"content"},Q={class:"meta"},q=["onClick"],B={class:"stats-cell"},N={class:"tags-cell"},W={key:0,src:g,class:"god-badge",title:"ç¥žè¯„"},X={key:3,class:"text-muted"},Z={class:"action-btns"},ee={class:"pagination-bar"},ae=E({__name:"UnifiedComments",setup(g){const E=e(!1),ae=e([]),le=e([]),te=e("all"),se=a({all:0,video:0,short:0,post:0,gallery:0,novel:0}),ne=a({keyword:"",status:"",dateRange:null}),ie=a({page:1,pageSize:20,total:0}),oe=e=>{const a=(e||1)%52;if(a<17)return`/images/avatars/icon_avatar_${a+1}.webp`;if(a<32){return`/images/avatars/DM_20251217202131_${String(a-17+1).padStart(3,"0")}.JPEG`}return`/images/avatars/DM_20251217202341_${String(a-32+1).padStart(3,"0")}.JPEG`},de=e=>({video:"é•¿è§†é¢‘",short:"çŸ­è§†é¢‘",post:"ç¤¾åŒº",gallery:"å›¾é›†",novel:"å°è¯´"}[e]||e),re=e=>`${{video:"è§†é¢‘",short:"çŸ­è§†é¢‘",post:"å¸–å­",gallery:"å›¾é›†",novel:"å°è¯´"}[e.content_type]||"å†…å®¹"} #${e.content_id}`,ce=async()=>{try{const e=await I.get("/admin/unified-comments/stats");Object.assign(se,e.data||{})}catch(e){}},ue=async()=>{var e;E.value=!0;try{const a={page:ie.page,page_size:ie.pageSize,content_type:"all"===te.value?"":te.value};ne.keyword&&(a.keyword=ne.keyword),ne.status&&(a.status=ne.status),2===(null==(e=ne.dateRange)?void 0:e.length)&&(a.start_date=ne.dateRange[0],a.end_date=ne.dateRange[1]);const l=await I.get("/admin/unified-comments",{params:a}),t=l.data||l;ae.value=t.items||[],ie.total=t.total||0}catch(a){j.error("èŽ·å–è¯„è®ºå¤±è´¥")}finally{E.value=!1}},pe=()=>{ie.page=1,ue()},me=()=>{ne.keyword="",ne.status="",ne.dateRange=null,ie.page=1,ue()},_e=e=>{le.value=e.map(e=>({id:e.id,type:e.content_type}))},ge=async()=>{if(le.value.length)try{await J.confirm(`ç¡®å®šåˆ é™¤é€‰ä¸­çš„ ${le.value.length} æ¡è¯„è®ºå—ï¼Ÿ`,"æ‰¹é‡åˆ é™¤",{type:"warning"}),await I.post("/admin/unified-comments/batch-delete",{items:le.value}),j.success("æ‰¹é‡åˆ é™¤æˆåŠŸ"),le.value=[],ue(),ce()}catch(e){"cancel"!==e&&j.error("æ‰¹é‡åˆ é™¤å¤±è´¥")}},ye=async()=>{if(le.value.length)try{await J.confirm(`ç¡®å®šéšè—é€‰ä¸­çš„ ${le.value.length} æ¡è¯„è®ºå—ï¼Ÿ`,"æ‰¹é‡éšè—",{type:"warning"}),await I.post("/admin/unified-comments/batch-hide",{items:le.value}),j.success("æ‰¹é‡éšè—æˆåŠŸ"),le.value=[],ue(),ce()}catch(e){"cancel"!==e&&j.error("æ‰¹é‡éšè—å¤±è´¥")}};return l(()=>{ce(),ue()}),(e,a)=>{const l=$,g=C,J=y,ve=x,fe=v,be=S,he=f,we=b,ke=h,je=D,ze=R,Ce=Y,$e=M,xe=z,Ve=k,Se=w;return c(),t("div",G,[a[19]||(a[19]=s("div",{class:"page-header"},[s("h1",null,"è¯„è®ºç®¡ç†ä¸­å¿ƒ"),s("p",{class:"page-desc"},"ç»Ÿä¸€ç®¡ç†æ‰€æœ‰å†…å®¹çš„è¯„è®ºï¼Œæ”¯æŒå®¡æ ¸ã€åˆ é™¤ã€ç½®é¡¶ç­‰æ“ä½œ")],-1)),n(J,{modelValue:te.value,"onUpdate:modelValue":a[0]||(a[0]=e=>te.value=e),onTabChange:pe,class:"comment-tabs"},{default:i(()=>[n(g,{label:"å…¨éƒ¨è¯„è®º",name:"all"},{label:i(()=>[s("span",null,[a[6]||(a[6]=u("å…¨éƒ¨è¯„è®º ",-1)),n(l,{value:se.all,max:9999,type:"info"},null,8,["value"])])]),_:1}),n(g,{label:"é•¿è§†é¢‘",name:"video"},{label:i(()=>[s("span",null,[a[7]||(a[7]=u("é•¿è§†é¢‘ ",-1)),n(l,{value:se.video,max:9999,type:"primary"},null,8,["value"])])]),_:1}),n(g,{label:"çŸ­è§†é¢‘",name:"short"},{label:i(()=>[s("span",null,[a[8]||(a[8]=u("çŸ­è§†é¢‘ ",-1)),n(l,{value:se.short,max:9999,type:"success"},null,8,["value"])])]),_:1}),n(g,{label:"ç¤¾åŒºå¸–å­",name:"post"},{label:i(()=>[s("span",null,[a[9]||(a[9]=u("ç¤¾åŒºå¸–å­ ",-1)),n(l,{value:se.post,max:9999,type:"warning"},null,8,["value"])])]),_:1}),n(g,{label:"å›¾é›†",name:"gallery"},{label:i(()=>[s("span",null,[a[10]||(a[10]=u("å›¾é›† ",-1)),n(l,{value:se.gallery,max:9999,type:"danger"},null,8,["value"])])]),_:1}),n(g,{label:"å°è¯´",name:"novel"},{label:i(()=>[s("span",null,[a[11]||(a[11]=u("å°è¯´ ",-1)),n(l,{value:se.novel,max:9999},null,8,["value"])])]),_:1})]),_:1},8,["modelValue"]),s("div",K,[n(fe,{modelValue:ne.keyword,"onUpdate:modelValue":a[1]||(a[1]=e=>ne.keyword=e),placeholder:"æœç´¢è¯„è®ºå†…å®¹/ç”¨æˆ·å",clearable:"",style:{width:"220px"},onKeyup:o(ue,["enter"])},{prefix:i(()=>[n(ve,null,{default:i(()=>[n(p(V))]),_:1})]),_:1},8,["modelValue"]),n(he,{modelValue:ne.status,"onUpdate:modelValue":a[2]||(a[2]=e=>ne.status=e),placeholder:"çŠ¶æ€",clearable:"",style:{width:"120px"}},{default:i(()=>[n(be,{label:"æ­£å¸¸æ˜¾ç¤º",value:"visible"}),n(be,{label:"å·²éšè—",value:"hidden"})]),_:1},8,["modelValue"]),n(we,{modelValue:ne.dateRange,"onUpdate:modelValue":a[3]||(a[3]=e=>ne.dateRange=e),type:"daterange","range-separator":"è‡³","start-placeholder":"å¼€å§‹æ—¥æœŸ","end-placeholder":"ç»“æŸæ—¥æœŸ",style:{width:"240px"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"]),n(ke,{type:"primary",onClick:ue},{default:i(()=>[n(ve,null,{default:i(()=>[n(p(V))]),_:1}),a[12]||(a[12]=u("æœç´¢",-1))]),_:1}),n(ke,{onClick:me},{default:i(()=>[...a[13]||(a[13]=[u("é‡ç½®",-1)])]),_:1}),n(ke,{type:"danger",disabled:!le.value.length,onClick:ge},{default:i(()=>[u(" æ‰¹é‡åˆ é™¤ ("+m(le.value.length)+") ",1)]),_:1},8,["disabled"]),n(ke,{type:"warning",disabled:!le.value.length,onClick:ye},{default:i(()=>[...a[14]||(a[14]=[u(" æ‰¹é‡éšè— ",-1)])]),_:1},8,["disabled"])]),s("div",L,[d((c(),r(xe,{data:ae.value,stripe:"",border:"",onSelectionChange:_e},{default:i(()=>[n(je,{type:"selection",width:"45"}),n(je,{prop:"id",label:"ID",width:"70",align:"center"}),n(je,{label:"ç±»åž‹",width:"90",align:"center"},{default:i(({row:e})=>{return[n(ze,{type:(a=e.content_type,{video:"primary",short:"success",post:"warning",gallery:"danger",novel:""}[a]||"info"),size:"small"},{default:i(()=>[u(m(de(e.content_type)),1)]),_:2},1032,["type"])];var a}),_:1}),n(je,{label:"ç”¨æˆ·",width:"150"},{default:i(({row:e})=>[s("div",P,[n(Ce,{size:32,src:e.user_avatar||oe(e.user_id)},null,8,["src"]),s("div",T,[s("div",F,m(e.user_name||"æœªçŸ¥ç”¨æˆ·"),1),s("div",H,"ID: "+m(e.user_id),1)])])]),_:1}),n(je,{label:"è¯„è®ºå†…å®¹","min-width":"280"},{default:i(({row:e})=>[s("div",O,[s("p",A,m(e.content),1),s("div",Q,[e.parent_id?(c(),r(ze,{key:0,size:"small",type:"info"},{default:i(()=>[...a[15]||(a[15]=[u("å›žå¤",-1)])]),_:1})):_("",!0),s("span",{class:"content-link",onClick:a=>(e=>{const a={video:`/user/video/${e.content_id}`,short:`/shorts/${e.content_id}`,post:`/user/community/post/${e.content_id}`,gallery:`/user/gallery/${e.content_id}`,novel:`/user/novel/${e.content_id}`}[e.content_type];a&&window.open(a,"_blank")})(e)},m(re(e)),9,q)])])]),_:1}),n(je,{label:"äº’åŠ¨",width:"90",align:"center"},{default:i(({row:e})=>[s("div",B,[s("span",null,"â¤ï¸ "+m(e.like_count||0),1),s("span",null,"ðŸ’¬ "+m(e.reply_count||0),1)])]),_:1}),n(je,{label:"çŠ¶æ€",width:"80",align:"center"},{default:i(({row:e})=>[n(ze,{type:e.is_hidden?"danger":"success",size:"small"},{default:i(()=>[u(m(e.is_hidden?"å·²éšè—":"æ­£å¸¸"),1)]),_:2},1032,["type"])]),_:1}),n(je,{label:"ç‰¹æ®Šæ ‡è®°",width:"120",align:"center"},{default:i(({row:e})=>[s("div",N,[e.is_god?(c(),t("img",W)):_("",!0),e.is_pinned?(c(),r(ze,{key:1,type:"warning",size:"small"},{default:i(()=>[...a[16]||(a[16]=[u("ç½®é¡¶",-1)])]),_:1})):_("",!0),e.is_official?(c(),r(ze,{key:2,type:"success",size:"small"},{default:i(()=>[...a[17]||(a[17]=[u("å®˜æ–¹",-1)])]),_:1})):_("",!0),e.is_pinned||e.is_official||e.is_god?_("",!0):(c(),t("span",X,"-"))])]),_:1}),n(je,{label:"å‘å¸ƒæ—¶é—´",width:"160",align:"center"},{default:i(({row:e})=>{return[u(m((a=e.created_at,a?U(a).format("YYYY-MM-DD HH:mm"):"-")),1)];var a}),_:1}),n(je,{label:"æ“ä½œ",width:"260",fixed:"right",align:"center"},{default:i(({row:e})=>[s("div",Z,[n(ke,{link:"",type:e.is_god?"danger":"primary",size:"small",onClick:a=>(async e=>{try{await I.put(`/admin/unified-comments/${e.content_type}/${e.id}`,{is_god:!e.is_god}),e.is_god=!e.is_god,j.success(e.is_god?"å·²è®¾ä¸ºç¥žè¯„":"å·²å–æ¶ˆç¥žè¯„")}catch(a){j.error("æ“ä½œå¤±è´¥")}})(e)},{default:i(()=>[u(m(e.is_god?"å–æ¶ˆç¥žè¯„":"ç¥žè¯„"),1)]),_:2},1032,["type","onClick"]),n(ke,{link:"",type:e.is_pinned?"info":"warning",size:"small",onClick:a=>(async e=>{try{await I.put(`/admin/unified-comments/${e.content_type}/${e.id}`,{is_pinned:!e.is_pinned}),e.is_pinned=!e.is_pinned,j.success(e.is_pinned?"å·²ç½®é¡¶":"å·²å–æ¶ˆç½®é¡¶")}catch(a){j.error("æ“ä½œå¤±è´¥")}})(e)},{default:i(()=>[u(m(e.is_pinned?"å–æ¶ˆç½®é¡¶":"ç½®é¡¶"),1)]),_:2},1032,["type","onClick"]),n(ke,{link:"",type:e.is_hidden?"success":"warning",size:"small",onClick:a=>(async e=>{try{await I.put(`/admin/unified-comments/${e.content_type}/${e.id}`,{is_hidden:!e.is_hidden}),e.is_hidden=!e.is_hidden,j.success(e.is_hidden?"å·²éšè—":"å·²æ˜¾ç¤º"),ce()}catch(a){j.error("æ“ä½œå¤±è´¥")}})(e)},{default:i(()=>[u(m(e.is_hidden?"æ˜¾ç¤º":"éšè—"),1)]),_:2},1032,["type","onClick"]),n($e,{title:"ç¡®å®šåˆ é™¤è¯¥è¯„è®ºå—ï¼Ÿ",onConfirm:a=>(async e=>{try{await I.delete(`/admin/unified-comments/${e.content_type}/${e.id}`),j.success("åˆ é™¤æˆåŠŸ"),ue(),ce()}catch(a){j.error("åˆ é™¤å¤±è´¥")}})(e)},{reference:i(()=>[n(ke,{link:"",type:"danger",size:"small"},{default:i(()=>[...a[18]||(a[18]=[u("åˆ é™¤",-1)])]),_:1})]),_:1},8,["onConfirm"])])]),_:1})]),_:1},8,["data"])),[[Se,E.value]]),s("div",ee,[n(Ve,{"current-page":ie.page,"onUpdate:currentPage":a[4]||(a[4]=e=>ie.page=e),"page-size":ie.pageSize,"onUpdate:pageSize":a[5]||(a[5]=e=>ie.pageSize=e),total:ie.total,"page-sizes":[20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ue,onCurrentChange:ue},null,8,["current-page","page-size","total"])])])])}}},[["__scopeId","data-v-964220b6"]]);export{ae as default};
