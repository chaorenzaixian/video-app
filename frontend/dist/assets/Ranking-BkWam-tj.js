import{r as e,j as a,y as l,C as s,M as t,aa as i,I as n,aC as r,z as o,H as v,L as c}from"./vue-vendor-Ba_vealp.js";import{_ as u,a as k}from"./index-C3P4JTuA.js";import"./element-plus-DlIn_qXi.js";import"./utils-DflAyOWx.js";const d={class:"ranking-page"},g={class:"page-header"},p={class:"category-tabs"},y=["onClick"],m={class:"time-tabs"},b=["onClick"],h={key:0,class:"loading-state"},_={key:1,class:"empty-state"},f=["onClick"],w={class:"item-cover"},$=["src","alt"],S={class:"cover-stats"},C={class:"views"},j={key:0,class:"duration"},x={class:"item-info"},M={class:"rank-badge"},H=["src"],z={class:"rank-num"},F={class:"item-title"},I={class:"item-meta"},R={key:0,class:"tag"},K={class:"likes"},L={key:3,class:"loading-more"},N={key:4,class:"no-more"},O=u({__name:"Ranking",setup(u){const O=r(),T=e(null),W=[{key:"video",label:"è§†é¢‘"},{key:"douyin",label:"æŠ–éŸ³"},{key:"post",label:"å¸–å­"},{key:"novel",label:"å°è¯´"},{key:"gallery",label:"å›¾é›†"}],q=[{key:"week",label:"å‘¨æ¦œ"},{key:"month",label:"æœˆæ¦œ"},{key:"season",label:"å­£æ¦œ"},{key:"total",label:"æ€»æ¦œ"}],A=e("video"),B=e("week"),D=e([]),E=e(!1),G=e(!1),J=e(!0),P=e(1),Q=e=>e?e>=1e4?(e/1e4).toFixed(1)+"W":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString():"0",U=e=>{if(!e)return"";const a=Math.floor(e/3600),l=Math.floor(e%3600/60),s=Math.floor(e%60);return a>0?`${a}:${l.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${l.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`},V=async()=>{var e;1===P.value?E.value=!0:G.value=!0;try{let a="";const l={page:P.value,page_size:20,time_range:B.value};switch(A.value){case"video":a="/ranking/videos";break;case"douyin":a="/ranking/shorts";break;case"post":a="/ranking/posts";break;case"novel":a="/ranking/novels";break;case"gallery":a="/ranking/galleries"}const s=await k.get(a,{params:l}),t=(null==(e=s.data)?void 0:e.items)||s.data||[];1===P.value?D.value=t:D.value=[...D.value,...t],J.value=t.length>=20&&D.value.length<1e3}catch(a){}finally{E.value=!1,G.value=!1}},X=()=>{if(!T.value||G.value||!J.value)return;const{scrollTop:e,scrollHeight:a,clientHeight:l}=T.value;e+l>=a-100&&(P.value++,V())};return a(()=>{V()}),(e,a)=>(o(),l("div",d,[s("div",g,[s("span",{class:"back-btn",onClick:a[0]||(a[0]=a=>e.$router.back())},"â€¹")]),a[2]||(a[2]=s("div",{class:"ranking-banner"},[s("img",{src:"/images/ranking/ranking_header.webp",alt:"çƒ­é—¨æŽ’è¡Œ",class:"banner-img"}),s("p",{class:"banner-subtitle"},"æ ¹æ®å®žæ—¶çƒ­åº¦æŽ’è¡Œ")],-1)),s("div",p,[(o(),l(t,null,i(W,e=>s("span",{key:e.key,class:v(["tab-item",{active:A.value===e.key}]),onClick:a=>{return l=e.key,A.value=l,P.value=1,D.value=[],J.value=!0,void V();var l}},c(e.label),11,y)),64))]),s("div",m,[(o(),l(t,null,i(q,e=>s("span",{key:e.key,class:v(["time-item",{active:B.value===e.key}]),onClick:a=>{return l=e.key,B.value=l,P.value=1,D.value=[],J.value=!0,void V();var l}},c(e.label),11,b)),64))]),s("div",{class:"ranking-list",ref_key:"listRef",ref:T,onScroll:X},[E.value&&0===D.value.length?(o(),l("div",h,[(o(),l(t,null,i(5,e=>s("div",{key:e,class:"skeleton-item"},[...a[1]||(a[1]=[s("div",{class:"skeleton-cover"},null,-1),s("div",{class:"skeleton-info"},[s("div",{class:"skeleton-title"}),s("div",{class:"skeleton-meta"})],-1)])])),64))])):E.value||0!==D.value.length?(o(!0),l(t,{key:2},i(D.value,(e,a)=>{return o(),l("div",{key:e.id,class:"ranking-item",onClick:a=>(e=>{switch(A.value){case"video":O.push(`/user/video/${e.id}`);break;case"douyin":O.push(`/user/short-video/${e.id}`);break;case"post":O.push(`/user/community/post/${e.id}`);break;case"novel":"audio"===e.novel_type?O.push(`/user/audio-novel/${e.id}`):O.push(`/user/novel/${e.id}`);break;case"gallery":O.push(`/user/gallery/${e.id}`)}})(e)},[s("div",w,[s("img",{src:e.cover_url||e.cover,alt:e.title},null,8,$),s("div",S,[s("span",C,"ðŸ‘ "+c(Q(e.view_count)),1),e.duration?(o(),l("span",j,c(U(e.duration)),1)):n("",!0)])]),s("div",x,[s("div",M,[s("img",{src:(t=a+1,1===t?"/images/ranking/rank_1.webp":2===t?"/images/ranking/rank_2.webp":3===t?"/images/ranking/rank_3.webp":"/images/ranking/rank_default.webp"),class:"rank-icon"},null,8,H),s("span",z,"NO."+c(a+1),1)]),s("p",F,c(e.title),1),s("div",I,[e.category_name||e.tag?(o(),l("span",R,c(e.category_name||e.tag),1)):n("",!0),s("span",K,"â˜† "+c(Q(e.like_count||e.favorite_count||0)),1)])])],8,f);var t}),128)):(o(),l("div",_," æš‚æ— æŽ’è¡Œæ•°æ® ")),G.value?(o(),l("div",L,"åŠ è½½ä¸­...")):n("",!0),!J.value&&D.value.length>0?(o(),l("div",N,"å·²åŠ è½½å…¨éƒ¨")):n("",!0)],544)]))}},[["__scopeId","data-v-c84ae1df"]]);export{O as default};
