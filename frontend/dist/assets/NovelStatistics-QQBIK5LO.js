/* empty css             *//* empty css               *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                *//* empty css                 *//* empty css                 *//* empty css                       *//* empty css                        */import{_ as a,a as e}from"./index-C3P4JTuA.js";import{bc as l,be as t,bd as s,bj as i,bI as n,bf as o,bg as r,bh as d,bi as u,bt as c,bl as v,bm as p,E as m}from"./element-plus-DlIn_qXi.js";import{l as _,r as h,j as g,y,C as f,O as b,L as w,F as j,z as k,E as x,I as z,M as V,aa as C,H as M,K as S,V as U}from"./vue-vendor-Ba_vealp.js";import"./utils-DflAyOWx.js";const E={class:"novel-statistics"},F={class:"stats-grid"},I={class:"stat-card purple"},$={class:"stat-info"},D={class:"stat-value"},K={class:"stat-detail"},L={class:"stat-card blue"},N={class:"stat-info"},O={class:"stat-value"},A={class:"stat-card green"},B={class:"stat-info"},H={class:"stat-value"},J={class:"stat-card orange"},P={class:"stat-info"},Y={class:"stat-value"},q={class:"stat-detail"},G={class:"card-header"},Q={class:"ranking-list"},R=["src"],T={class:"novel-info"},W={class:"novel-title"},X={class:"novel-meta"},Z={class:"novel-stats"},aa={class:"card-header"},ea={class:"card-header"},la={key:0,class:"chapter-analysis"},ta={class:"analysis-header"},sa={class:"chapter-bars"},ia={class:"chapter-label"},na={class:"chapter-num"},oa={class:"chapter-title"},ra={class:"bar-container"},da={class:"bar-value"},ua=a({__name:"NovelStatistics",setup(a){const ua=_({total_novels:0,total_chapters:0,total_views:0,total_likes:0,reading_users:0,today_readers:0,text_novels:0,audio_novels:0}),ca=h("views"),va=h([]),pa=h([]),ma=h(null),_a=h([]),ha=h(1),ga=h(0),ya=h(null),fa=h(""),ba=h([]),wa=h(1);async function ja(){try{const{data:a}=await e.get("/admin/gallery-novel/novel/ranking",{params:{rank_type:ca.value,limit:10}});va.value=a}catch(a){}}async function ka(){try{const a={page:ha.value,page_size:20};ma.value&&(a.novel_id=ma.value);const{data:l}=await e.get("/admin/gallery-novel/novel/reading-progress",{params:a});_a.value=l.items||[],ga.value=l.total||0}catch(a){}}async function xa(){if(ya.value)try{const{data:a}=await e.get(`/admin/gallery-novel/novel/chapter-stats/${ya.value}`);ba.value=a.chapters||[],fa.value=a.novel_title,wa.value=Math.max(...ba.value.map(a=>a.reader_count),1)}catch(a){m.error("åŠ è½½ç« èŠ‚ç»Ÿè®¡å¤±è´¥")}else ba.value=[]}function za(a){return a?a>=1e4?(a/1e4).toFixed(1)+"w":a>=1e3?(a/1e3).toFixed(1)+"k":a.toString():"0"}function Va(a){if(!a)return"-";return`${Math.floor(a/60)}:${Math.floor(a%60).toString().padStart(2,"0")}`}return g(()=>{!async function(){try{const{data:a}=await e.get("/admin/gallery-novel/novel/statistics");Object.assign(ua,a)}catch(a){}}(),ja(),async function(){try{const{data:a}=await e.get("/admin/gallery-novel/novels",{params:{page_size:100}});pa.value=a.items||[]}catch(a){}}(),ka()}),(a,e)=>{const m=r,_=o,h=i,g=n,Ca=t,Ma=s,Sa=p,Ua=v,Ea=u,Fa=d,Ia=c,$a=l;return k(),y("div",E,[f("div",F,[f("div",I,[e[5]||(e[5]=f("div",{class:"stat-icon"},"ğŸ“š",-1)),f("div",$,[f("div",D,w(ua.total_novels),1),e[4]||(e[4]=f("div",{class:"stat-label"},"å°è¯´æ€»æ•°",-1))]),f("div",K,[f("span",null,"æ–‡å­—: "+w(ua.text_novels),1),f("span",null,"æœ‰å£°: "+w(ua.audio_novels),1)])]),f("div",L,[e[7]||(e[7]=f("div",{class:"stat-icon"},"ğŸ“–",-1)),f("div",N,[f("div",O,w(ua.total_chapters),1),e[6]||(e[6]=f("div",{class:"stat-label"},"ç« èŠ‚æ€»æ•°",-1))])]),f("div",A,[e[9]||(e[9]=f("div",{class:"stat-icon"},"ğŸ‘",-1)),f("div",B,[f("div",H,w(za(ua.total_views)),1),e[8]||(e[8]=f("div",{class:"stat-label"},"æ€»æµè§ˆé‡",-1))])]),f("div",J,[e[11]||(e[11]=f("div",{class:"stat-icon"},"ğŸ‘¥",-1)),f("div",P,[f("div",Y,w(ua.reading_users),1),e[10]||(e[10]=f("div",{class:"stat-label"},"é˜…è¯»ç”¨æˆ·",-1))]),f("div",q,[f("span",null,"ä»Šæ—¥æ–°å¢: "+w(ua.today_readers),1)])])]),b($a,{gutter:20},{default:j(()=>[b(Ma,{span:12},{default:j(()=>[b(Ca,{shadow:"never"},{header:j(()=>[f("div",G,[e[14]||(e[14]=f("span",null,"ğŸ”¥ çƒ­é—¨æ’è¡Œ",-1)),b(_,{modelValue:ca.value,"onUpdate:modelValue":e[0]||(e[0]=a=>ca.value=a),size:"small",onChange:ja},{default:j(()=>[b(m,{label:"views"},{default:j(()=>[...e[12]||(e[12]=[S("æµè§ˆé‡",-1)])]),_:1}),b(m,{label:"likes"},{default:j(()=>[...e[13]||(e[13]=[S("ç‚¹èµæ•°",-1)])]),_:1})]),_:1},8,["modelValue"])])]),default:j(()=>[f("div",Q,[(k(!0),y(V,null,C(va.value,a=>(k(),y("div",{key:a.id,class:"ranking-item"},[f("span",{class:M(["rank","rank-"+a.rank])},w(a.rank),3),f("img",{src:a.cover,class:"novel-cover"},null,8,R),f("div",T,[f("div",W,w(a.title),1),f("div",X,[b(h,{size:"small",type:"text"===a.novel_type?"primary":"success"},{default:j(()=>[S(w("text"===a.novel_type?"æ–‡å­—":"æœ‰å£°"),1)]),_:2},1032,["type"]),f("span",null,w(a.chapter_count)+"ç« ",1)])]),f("div",Z,[f("div",null,"ğŸ‘ "+w(za(a.view_count)),1),f("div",null,"â¤ï¸ "+w(a.like_count),1)])]))),128)),0===va.value.length?(k(),x(g,{key:0,description:"æš‚æ— æ•°æ®"})):z("",!0)])]),_:1})]),_:1}),b(Ma,{span:12},{default:j(()=>[b(Ca,{shadow:"never"},{header:j(()=>[f("div",aa,[e[15]||(e[15]=f("span",null,"ğŸ“Š é˜…è¯»è¿›åº¦",-1)),b(Ua,{modelValue:ma.value,"onUpdate:modelValue":e[1]||(e[1]=a=>ma.value=a),placeholder:"é€‰æ‹©å°è¯´",clearable:"",size:"small",style:{width:"200px"},onChange:ka},{default:j(()=>[(k(!0),y(V,null,C(pa.value,a=>(k(),x(Sa,{key:a.id,label:a.title,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),default:j(()=>[b(Fa,{data:_a.value,size:"small","max-height":"400"},{default:j(()=>[b(Ea,{prop:"user_nickname",label:"ç”¨æˆ·",width:"100"}),b(Ea,{prop:"novel_title",label:"å°è¯´","min-width":"120","show-overflow-tooltip":""}),b(Ea,{label:"è¿›åº¦",width:"100"},{default:j(({row:a})=>[S(" ç¬¬"+w(a.chapter_num)+"ç«  ",1)]),_:1}),b(Ea,{label:"ä½ç½®",width:"80"},{default:j(({row:a})=>[S(w(a.scroll_position>0?a.scroll_position+"%":a.audio_position>0?Va(a.audio_position):"-"),1)]),_:1}),b(Ea,{prop:"updated_at",label:"æ›´æ–°æ—¶é—´",width:"160"},{default:j(({row:a})=>{return[S(w((e=a.updated_at,e?new Date(e).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-")),1)];var e}),_:1})]),_:1},8,["data"]),b(Ia,{"current-page":ha.value,"onUpdate:currentPage":e[2]||(e[2]=a=>ha.value=a),total:ga.value,"page-size":20,layout:"total, prev, pager, next",onCurrentChange:ka,style:{"margin-top":"12px","justify-content":"flex-end"},small:""},null,8,["current-page","total"])]),_:1})]),_:1})]),_:1}),b(Ca,{shadow:"never",style:{"margin-top":"20px"}},{header:j(()=>[f("div",ea,[e[16]||(e[16]=f("span",null,"ğŸ“ˆ ç« èŠ‚é˜…è¯»åˆ†æ",-1)),b(Ua,{modelValue:ya.value,"onUpdate:modelValue":e[3]||(e[3]=a=>ya.value=a),placeholder:"é€‰æ‹©å°è¯´æŸ¥çœ‹ç« èŠ‚æ•°æ®",size:"small",style:{width:"250px"},onChange:xa},{default:j(()=>[(k(!0),y(V,null,C(pa.value,a=>(k(),x(Sa,{key:a.id,label:a.title,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),default:j(()=>[ba.value.length>0?(k(),y("div",la,[f("div",ta,[f("span",null,w(fa.value)+" - å…±"+w(ba.value.length)+"ç« ",1)]),f("div",sa,[(k(!0),y(V,null,C(ba.value,a=>{return k(),y("div",{key:a.chapter_id,class:"chapter-bar-item"},[f("div",ia,[f("span",na,w(a.chapter_num),1),f("span",oa,w(a.title),1),a.is_free?z("",!0):(k(),x(h,{key:0,size:"small",type:"warning"},{default:j(()=>[...e[17]||(e[17]=[S("ä»˜è´¹",-1)])]),_:1}))]),f("div",ra,[f("div",{class:"bar",style:U({width:(l=a.reader_count,Math.min(100,l/wa.value*100)+"%")})},null,4),f("span",da,w(a.reader_count)+"äºº",1)])]);var l}),128))])])):(k(),x(g,{key:1,description:"é€‰æ‹©å°è¯´æŸ¥çœ‹ç« èŠ‚é˜…è¯»æ•°æ®"}))]),_:1})])}}},[["__scopeId","data-v-f9b839f0"]]);export{ua as default};
